(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2001],{13719:(e,r,s)=>{"use strict";s.d(r,{n:()=>n});var t=s(71620),i=s(50848),a=s(56489);let n=(0,t.v)()((0,i.Zr)((e,r)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,login:async(r,s)=>{e({isLoading:!0,error:null});try{let t=await a.Ay.loginUser(r,s);if(!t.success||!t.user)throw Error("Błąd logowania");let i=t.user,n={id:i.id,email:i.email,firstName:i.first_name||i.name?.split(" ")[0]||"",lastName:i.last_name||i.name?.split(" ").slice(1).join(" ")||"",role:"customer",billing:{address:i.billing?.address_1||"",city:i.billing?.city||"",postcode:i.billing?.postcode||"",country:i.billing?.country||"PL",phone:i.billing?.phone||"",company:i.billing?.company||"",nip:i.billing?.nip||""},shipping:{address:i.shipping?.address_1||"",city:i.shipping?.city||"",postcode:i.shipping?.postcode||"",country:i.shipping?.country||"PL"}},l=i.token;return e({user:n,token:l,isAuthenticated:!0,isLoading:!1,error:null}),!0}catch(r){return console.error("Login error:",r),e({error:"Błąd logowania. Sprawdź email i hasło.",isLoading:!1}),!1}},register:async r=>{e({isLoading:!0,error:null});try{let s=await a.Ay.registerUser({username:r.email,email:r.email,password:r.password,first_name:"",last_name:""});if(r.marketingConsent)try{await fetch("/api/newsletter/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r.email,firstName:r.firstName,lastName:r.lastName,consent:!0,source:"registration"})})}catch(e){console.error("❌ Newsletter subscription error:",e)}if(!s.success||!s.user)throw Error("Błąd rejestracji");let t=s.user,i={id:t.id,email:t.email,firstName:r.firstName||"",lastName:r.lastName||"",role:"customer",billing:{address:"",city:"",postcode:"",country:"PL",phone:r.phone||""},shipping:{address:"",city:"",postcode:"",country:"PL"}},n="woo-user-token-"+t.id;return e({user:i,token:n,isAuthenticated:!0,isLoading:!1,error:null}),!0}catch(s){console.error("Registration error:",s);let r="Błąd rejestracji. Spr\xf3buj ponownie.";return s instanceof Error&&(r=s.message.includes("registration-error-email-exists")||s.message.includes("Email już istnieje")?"Ten adres email jest już zarejestrowany. Zaloguj się lub użyj innego adresu.":s.message.includes("400")?"Błąd rejestracji. Sprawdź wprowadzone dane i spr\xf3buj ponownie.":s.message),e({error:r,isLoading:!1}),!1}},logout:()=>{e({user:null,token:null,isAuthenticated:!1,error:null})},refreshToken:async()=>{let{token:e}=r();if(!e)return!1;try{return await new Promise(e=>setTimeout(e,500)),!0}catch(e){return console.error("Token refresh error:",e),r().logout(),!1}},updateUser:s=>{let{user:t}=r();t&&e({user:{...t,...s}})},updateProfile:async s=>{let{user:t}=r();if(!t?.id)return{success:!1,message:"Użytkownik nie jest zalogowany"};e({isLoading:!0,error:null});try{let i=await fetch("/api/woocommerce?endpoint=customer/update-profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:t.id,profile_data:s})}),a=await i.json();if(a.success){let{updateUser:s}=r();return s(a.customer),e({isLoading:!1,error:null}),{success:!0,message:a.message,customer:a.customer}}throw Error(a.error||"Nie udało się zaktualizować profilu")}catch(r){return e({isLoading:!1,error:r.message||"Wystąpił błąd podczas aktualizacji profilu"}),{success:!1,message:r.message||"Wystąpił błąd podczas aktualizacji profilu"}}},changePassword:async(s,t)=>{let{user:i}=r();if(!i?.id)return{success:!1,message:"Użytkownik nie jest zalogowany"};e({isLoading:!0,error:null});try{let r=await fetch("/api/woocommerce?endpoint=customer/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:i.id,current_password:s,new_password:t})}),a=await r.json();if(a.success)return e({isLoading:!1,error:null}),{success:!0,message:a.message};throw Error(a.error||"Nie udało się zmienić hasła")}catch(r){return e({isLoading:!1,error:r.message||"Wystąpił błąd podczas zmiany hasła"}),{success:!1,message:r.message||"Wystąpił błąd podczas zmiany hasła"}}},clearError:()=>{e({error:null})},setToken:r=>{e({token:r,isAuthenticated:!0})},clearToken:()=>{e({token:null,isAuthenticated:!1})},fetchUserProfile:async()=>{let{token:s,user:t}=r();if(s&&t)try{let r=await fetch("/api/woocommerce?endpoint=customers/"+t.id,{method:"GET",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"}});if(!r.ok)throw Error("Failed to fetch user profile");let i=await r.json(),a=i.meta_data?.find(e=>"billing_nip"===e.key),n=a?.value||"",l={id:i.id,email:i.email,firstName:i.first_name||"",lastName:i.last_name||"",role:"customer",billing:{address:i.billing?.address_1||"",city:i.billing?.city||"",postcode:i.billing?.postcode||"",country:i.billing?.country||"PL",phone:i.billing?.phone||"",company:i.billing?.company||"",nip:n},shipping:{address:i.shipping?.address_1||"",city:i.shipping?.city||"",postcode:i.shipping?.postcode||"",country:i.shipping?.country||"PL"}};e({user:l})}catch(e){console.error("❌ Error fetching user profile:",e)}}}),{name:"filler-auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},19769:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},25438:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},27541:(e,r,s)=>{"use strict";var t=s(43041);s.o(t,"useRouter")&&s.d(r,{useRouter:function(){return t.useRouter}}),s.o(t,"useSearchParams")&&s.d(r,{useSearchParams:function(){return t.useSearchParams}})},45801:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},51166:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},51535:(e,r,s)=>{Promise.resolve().then(s.bind(s,85904))},52744:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},63072:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},64751:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},74624:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},85904:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>b});var t=s(54568),i=s(7620),a=s(27541),n=s(19664),l=s.n(n),c=s(32536),o=s(74624),d=s(25438),m=s(52744),u=s(45801),h=s(64751),p=s(63072),g=s(97152),y=s(19769),x=s(51166),f=s(13719),w=s(90011);function b({params:e}){let r=(0,a.useRouter)(),{user:s,isAuthenticated:n}=(0,f.n)(),[b,j]=(0,i.useState)(!0),[N,k]=(0,i.useState)(null),[v,A]=(0,i.useState)(null),[_,z]=(0,i.useState)(null);if((0,i.useEffect)(()=>{e.then(e=>{z(e.id)})},[e]),(0,i.useEffect)(()=>{if(!n)return void r.push("/");_&&(async()=>{try{j(!0),k(null);let e=await fetch(`/api/woocommerce?endpoint=orders/${_}`),r=await e.json();if(!e.ok)throw Error(r?.error||"Nie udało się pobrać zam\xf3wienia");let t={id:r.id,number:r.number,status:r.status,date_created:r.date_created,currency:r.currency,total:Math.round(100*parseFloat(r.total)),customer_id:r.customer_id,payment_method_title:r.payment_method_title,billing:r.billing,shipping:r.shipping,line_items:(r.line_items||[]).map(e=>({id:e.id,name:e.name,quantity:e.quantity,price:Math.round(100*parseFloat(e.price)),image:e.image?.src,meta:e.meta_data})),meta_data:r.meta_data};if(s?.id&&t.customer_id&&Number(s.id)!==Number(t.customer_id))throw Error("Brak dostępu do tego zam\xf3wienia");A(t)}catch(e){k(e?.message||"Wystąpił błąd")}finally{j(!1)}})()},[n,_,r,s?.id]),!n)return(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsx)("p",{className:"text-gray-600",children:"Przekierowywanie..."})});if(b)return(0,t.jsx)("div",{className:"min-h-screen bg-white",children:(0,t.jsx)("div",{className:"max-w-[95vw] mx-auto px-6 py-8 pb-16",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-black mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Ładowanie zam\xf3wienia..."})]})})});if(N||!v)return(0,t.jsx)("div",{className:"min-h-screen bg-white",children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-10",children:[(0,t.jsxs)(l(),{href:"/moje-zamowienia",className:"inline-flex items-center text-sm text-gray-700 hover:text-black",children:[(0,t.jsx)(h.A,{className:"w-4 h-4 mr-2"})," Wr\xf3ć do zam\xf3wień"]}),(0,t.jsxs)("div",{className:"mt-6 bg-white border border-gray-200 rounded-lg p-8 text-center",children:[(0,t.jsx)(d.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,t.jsx)("p",{className:"text-gray-700",children:N||"Nie znaleziono zam\xf3wienia"})]})]})});let L=function(e){switch(e){case"pending":return{label:"Oczekujące",color:"text-yellow-600",bg:"bg-yellow-100",Icon:o.A};case"processing":return{label:"W realizacji",color:"text-blue-600",bg:"bg-blue-100",Icon:d.A};case"on-hold":return{label:"Wstrzymane",color:"text-amber-700",bg:"bg-amber-100",Icon:o.A};case"completed":return{label:"Zrealizowane",color:"text-green-600",bg:"bg-green-100",Icon:m.A};case"shipped":return{label:"Wysłane",color:"text-purple-600",bg:"bg-purple-100",Icon:u.A};case"cancelled":return{label:"Anulowane",color:"text-red-600",bg:"bg-red-100",Icon:o.A};default:return{label:"Nieznany",color:"text-gray-600",bg:"bg-gray-100",Icon:o.A}}}(v.status);return(0,t.jsx)("div",{className:"min-h-screen bg-white",children:(0,t.jsxs)("div",{className:"max-w-5xl mx-auto px-4 py-8 pb-16",children:[(0,t.jsx)("div",{className:"mb-6 flex items-center justify-between",children:(0,t.jsxs)(l(),{href:"/moje-zamowienia",className:"inline-flex items-center text-sm text-gray-700 hover:text-black",children:[(0,t.jsx)(h.A,{className:"w-4 h-4 mr-2"})," Wr\xf3ć do zam\xf3wień"]})}),(0,t.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[(0,t.jsxs)("div",{className:"p-6 border-b border-gray-200 flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h1",{className:"text-2xl font-bold text-gray-900",children:["Zam\xf3wienie ",v.number]}),(0,t.jsxs)("div",{className:"mt-2 flex flex-wrap items-center gap-3 text-sm text-gray-600",children:[(0,t.jsx)("span",{className:`px-2 py-1 rounded-full ${L.bg} ${L.color} font-medium`,children:L.label}),(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(p.A,{className:"w-4 h-4 mr-1"})," ",new Date(v.date_created).toLocaleDateString("pl-PL")]}),(0,t.jsx)("span",{className:"flex items-center font-semibold text-gray-900",children:(0,w.$g)(v.total)})]})]}),(0,t.jsx)("div",{className:"text-sm text-gray-700",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)(g.A,{className:"w-4 h-4 mr-2"})," ",v.payment_method_title||"Płatność"]})})]}),(0,t.jsxs)("div",{className:"p-6 grid grid-cols-1 lg:grid-cols-3 gap-8",children:[(0,t.jsxs)("div",{className:"lg:col-span-2",children:[(0,t.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Produkty"}),(0,t.jsx)("div",{className:"space-y-4",children:v.line_items.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:e.image?(0,t.jsx)(c.default,{src:e.image,alt:e.name,width:64,height:64,className:"w-full h-full object-cover"}):(0,t.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,t.jsx)(d.A,{className:"w-6 h-6 text-gray-400"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,t.jsxs)("div",{className:"text-sm text-gray-600",children:["Ilość: ",e.quantity]})]}),(0,t.jsx)("div",{className:"text-sm font-semibold text-gray-900",children:(0,w.$g)(e.price)})]},e.id))})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide mb-3 flex items-center",children:[(0,t.jsx)(y.A,{className:"w-4 h-4 mr-2"})," Dane klienta"]}),(0,t.jsxs)("div",{className:"text-sm text-gray-700 space-y-1",children:[(0,t.jsxs)("div",{children:[v.billing.first_name," ",v.billing.last_name]}),(0,t.jsx)("div",{children:v.billing.email}),(0,t.jsx)("div",{children:v.billing.phone})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 uppercase tracking-wide mb-3 flex items-center",children:[(0,t.jsx)(x.A,{className:"w-4 h-4 mr-2"})," Adres dostawy"]}),(0,t.jsxs)("div",{className:"text-sm text-gray-700 space-y-1",children:[(0,t.jsx)("div",{children:v.shipping.address_1}),(0,t.jsxs)("div",{children:[v.shipping.postcode," ",v.shipping.city]}),(0,t.jsx)("div",{children:v.shipping.country})]})]}),(0,t.jsx)("div",{className:"border-t border-gray-200 pt-4",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Suma"}),(0,t.jsx)("span",{className:"font-semibold text-gray-900",children:(0,w.$g)(v.total)})]})})]})]})]})]})})}},90011:(e,r,s)=>{"use strict";function t(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function i(e){return 1.23*e}function a(e){return t(i(e))+" (z VAT)"}s.d(r,{$g:()=>t,FP:()=>i,mF:()=>a})},92068:(e,r,s)=>{"use strict";s.d(r,{A:()=>c});var t=s(7620);let i=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,s)=>s?s.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},a=(...e)=>e.filter((e,r,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===r).join(" ").trim();var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,t.forwardRef)(({color:e="currentColor",size:r=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:l="",children:c,iconNode:o,...d},m)=>(0,t.createElement)("svg",{ref:m,...n,width:r,height:r,stroke:e,strokeWidth:i?24*Number(s)/Number(r):s,className:a("lucide",l),...!c&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(d)&&{"aria-hidden":"true"},...d},[...o.map(([e,r])=>(0,t.createElement)(e,r)),...Array.isArray(c)?c:[c]])),c=(e,r)=>{let s=(0,t.forwardRef)(({className:s,...n},c)=>(0,t.createElement)(l,{ref:c,iconNode:r,className:a(`lucide-${i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,s),...n}));return s.displayName=i(e),s}},97152:(e,r,s)=>{"use strict";s.d(r,{A:()=>t});let t=(0,s(92068).A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])}},e=>{e.O(0,[9775,6489,587,18,7358],()=>e(e.s=51535)),_N_E=e.O()}]);