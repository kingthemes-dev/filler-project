(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8861],{894:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>j});var t=r(54568),a=r(7620),i=r(86660),n=r(74624),l=r(25438),o=r(45801),c=r(52744),d=r(63072),m=r(38391),p=r(82078),u=r(13719),h=r(27541),g=r(19664),y=r.n(g),x=r(90011),b=r(32536);function j(){let e=(0,h.useRouter)(),{user:s,isAuthenticated:r}=(0,u.n)(),[g,j]=(0,a.useState)([]),[f,w]=(0,a.useState)(!0),[N,k]=(0,a.useState)(null);(0,a.useEffect)(()=>{let s=setTimeout(()=>{r||e.push("/")},100);return()=>clearTimeout(s)},[r,e]),(0,a.useEffect)(()=>{r&&s?.id&&v()},[r,s?.id]);let v=async()=>{try{w(!0);let e=await fetch(`/api/woocommerce?endpoint=orders&customer=${s?.id}`),r=await e.json();if(Array.isArray(r)){let e=r.map(e=>({id:e.id.toString(),number:e.number,date:e.date_created.split("T")[0],status:z(e.status),total:parseFloat(e.total),items:e.line_items.map(e=>({id:e.id,name:e.name,quantity:e.quantity,price:parseFloat(e.price),image:e.image?.src||"https://via.placeholder.com/100x100/1f2937/ffffff?text=Product"})),billing:{address:e.billing.address_1,city:e.billing.city,postcode:e.billing.postcode,country:e.billing.country},shipping:{address:e.shipping.address_1,city:e.shipping.city,postcode:e.shipping.postcode,country:e.shipping.country},paymentMethod:A(e.payment_method_title||e.payment_method||"unknown"),trackingNumber:e.meta_data?.find(e=>"_tracking_number"===e.key)?.value||null}));j(e)}else console.error("Error fetching orders:",r),j([])}catch(e){console.error("Error fetching orders:",e),j([])}finally{w(!1)}},z=e=>({pending:"pending",processing:"processing","on-hold":"processing",completed:"delivered",cancelled:"cancelled",refunded:"cancelled",failed:"cancelled",shipped:"shipped"})[e]||"pending",A=e=>({cod:"Za pobraniem",google_pay:"Google Pay",apple_pay:"Apple Pay",card:"Karta płatnicza",transfer:"Przelew bankowy",cash:"Płatność przy odbiorze",bacs:"Przelew bankowy",cheque:"Czek",paypal:"PayPal",stripe:"Karta płatnicza (Stripe)",unknown:"Nieznana metoda"})[e]||e;return r&&s?f?(0,t.jsx)("div",{className:"min-h-screen bg-white",children:(0,t.jsx)("div",{className:"max-w-[95vw] mx-auto px-6 py-8 pb-16",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-black mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Ładowanie zam\xf3wień..."})]})})}):(0,t.jsx)("div",{className:"min-h-screen bg-white",children:(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 pb-16",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsx)("h1",{className:"text-3xl lg:text-4xl font-bold text-gray-900 mb-4",children:"Moje zam\xf3wienia"}),(0,t.jsx)("p",{className:"text-lg text-gray-600",children:"Historia Twoich zam\xf3wień i status realizacji"})]}),0===g.length?(0,t.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center py-16",children:[(0,t.jsx)(l.A,{className:"w-24 h-24 text-gray-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Brak zam\xf3wień"}),(0,t.jsx)("p",{className:"text-gray-600 mb-6",children:"Nie masz jeszcze żadnych zam\xf3wień. Rozpocznij zakupy!"}),(0,t.jsx)(y(),{href:"/sklep",className:"bg-black text-white px-8 py-3 rounded-lg font-medium hover:bg-gray-800 transition-colors",children:"Przejdź do sklepu"})]}):(0,t.jsx)("div",{className:"space-y-6",children:g.map((e,s)=>{let r=(e=>{switch(e){case"pending":return{label:"Oczekujące",color:"text-yellow-600",bgColor:"bg-yellow-100",icon:n.A};case"processing":return{label:"W realizacji",color:"text-blue-600",bgColor:"bg-blue-100",icon:l.A};case"shipped":return{label:"Wysłane",color:"text-purple-600",bgColor:"bg-purple-100",icon:o.A};case"delivered":return{label:"Dostarczone",color:"text-green-600",bgColor:"bg-green-100",icon:c.A};case"cancelled":return{label:"Anulowane",color:"text-red-600",bgColor:"bg-red-100",icon:n.A};default:return{label:"Nieznany",color:"text-gray-600",bgColor:"bg-gray-100",icon:n.A}}})(e.status),a=r.icon;return(0,t.jsxs)(i.P.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1*s},className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,t.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:`p-2 rounded-full ${r.bgColor}`,children:(0,t.jsx)(a,{className:`w-5 h-5 ${r.color}`})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.number}),(0,t.jsxs)("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[(0,t.jsxs)("span",{className:"flex items-center",children:[(0,t.jsx)(d.A,{className:"w-4 h-4 mr-1"}),new Date(e.date).toLocaleDateString("pl-PL",{year:"numeric",month:"long",day:"numeric"})]}),(0,t.jsx)("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${r.bgColor} ${r.color}`,children:r.label})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("span",{className:"text-xl font-bold text-gray-900",children:(0,x.$g)(e.total)}),(0,t.jsxs)("button",{onClick:()=>k(N?.id===e.id?null:e),className:"flex items-center space-x-2 text-gray-600 hover:text-black transition-colors",children:[(0,t.jsx)(m.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{className:"text-sm",children:N?.id===e.id?"Ukryj":"Szczeg\xf3ły"})]})]})]})}),N?.id===e.id&&(0,t.jsx)(i.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"border-t border-gray-200",children:(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Produkty"}),(0,t.jsx)("div",{className:"space-y-4",children:e.items.map(e=>(0,t.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,t.jsx)("div",{className:"w-16 h-16 bg-gray-200 rounded-lg flex-shrink-0",children:e.image?(0,t.jsx)(b.default,{src:e.image,alt:e.name,width:64,height:64,className:"w-full h-full object-cover rounded-lg"}):(0,t.jsx)("div",{className:"w-full h-full bg-gray-300 rounded-lg flex items-center justify-center",children:(0,t.jsx)(l.A,{className:"w-8 h-8 text-gray-500"})})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h5",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,t.jsxs)("p",{className:"text-sm text-gray-600",children:["Ilość: ",e.quantity]}),(0,t.jsx)("p",{className:"text-sm font-medium text-gray-900",children:(0,x.$g)(e.price)})]})]},e.id))})]}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Adres rozliczeniowy"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,t.jsx)("p",{children:e.billing.address}),(0,t.jsxs)("p",{children:[e.billing.city,", ",e.billing.postcode]}),(0,t.jsx)("p",{children:e.billing.country})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Adres dostawy"}),(0,t.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,t.jsx)("p",{children:e.shipping.address}),(0,t.jsxs)("p",{children:[e.shipping.city,", ",e.shipping.postcode]}),(0,t.jsx)("p",{children:e.shipping.country})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Płatność"}),(0,t.jsx)("p",{className:"text-sm text-gray-600",children:e.paymentMethod})]}),e.trackingNumber&&(0,t.jsxs)("div",{children:[(0,t.jsx)("h4",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Numer śledzenia"}),(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("span",{className:"text-sm font-mono text-gray-800 bg-gray-100 px-3 py-2 rounded",children:e.trackingNumber}),(0,t.jsx)("button",{className:"text-sm text-blue-600 hover:text-blue-800 transition-colors",children:"Śledź przesyłkę"})]})]})]})]})]}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 mt-8 pt-6 border-t border-gray-200",children:[(0,t.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(p.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Pobierz fakturę"})]}),"delivered"===e.status&&(0,t.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(m.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Zobacz szczeg\xf3ły"})]}),"shipped"===e.status&&(0,t.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[(0,t.jsx)(o.A,{className:"w-4 h-4"}),(0,t.jsx)("span",{children:"Śledź przesyłkę"})]})]})]})})]},e.id)})})]})}):(0,t.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-black mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Przekierowywanie..."})]})})}},13719:(e,s,r)=>{"use strict";r.d(s,{n:()=>n});var t=r(71620),a=r(50848),i=r(56489);let n=(0,t.v)()((0,a.Zr)((e,s)=>({user:null,token:null,isAuthenticated:!1,isLoading:!1,error:null,login:async(s,r)=>{e({isLoading:!0,error:null});try{let t=await i.Ay.loginUser(s,r);if(!t.success||!t.user)throw Error("Błąd logowania");let a=t.user,n={id:a.id,email:a.email,firstName:a.first_name||a.name?.split(" ")[0]||"",lastName:a.last_name||a.name?.split(" ").slice(1).join(" ")||"",role:"customer",billing:{address:a.billing?.address_1||"",city:a.billing?.city||"",postcode:a.billing?.postcode||"",country:a.billing?.country||"PL",phone:a.billing?.phone||"",company:a.billing?.company||"",nip:a.billing?.nip||""},shipping:{address:a.shipping?.address_1||"",city:a.shipping?.city||"",postcode:a.shipping?.postcode||"",country:a.shipping?.country||"PL"}},l=a.token;return e({user:n,token:l,isAuthenticated:!0,isLoading:!1,error:null}),!0}catch(s){return console.error("Login error:",s),e({error:"Błąd logowania. Sprawdź email i hasło.",isLoading:!1}),!1}},register:async s=>{e({isLoading:!0,error:null});try{let r=await i.Ay.registerUser({username:s.email,email:s.email,password:s.password,first_name:"",last_name:""});if(s.marketingConsent)try{await fetch("/api/newsletter/subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.email,firstName:s.firstName,lastName:s.lastName,consent:!0,source:"registration"})})}catch(e){console.error("❌ Newsletter subscription error:",e)}if(!r.success||!r.user)throw Error("Błąd rejestracji");let t=r.user,a={id:t.id,email:t.email,firstName:s.firstName||"",lastName:s.lastName||"",role:"customer",billing:{address:"",city:"",postcode:"",country:"PL",phone:s.phone||""},shipping:{address:"",city:"",postcode:"",country:"PL"}},n="woo-user-token-"+t.id;return e({user:a,token:n,isAuthenticated:!0,isLoading:!1,error:null}),!0}catch(r){console.error("Registration error:",r);let s="Błąd rejestracji. Spr\xf3buj ponownie.";return r instanceof Error&&(s=r.message.includes("registration-error-email-exists")||r.message.includes("Email już istnieje")?"Ten adres email jest już zarejestrowany. Zaloguj się lub użyj innego adresu.":r.message.includes("400")?"Błąd rejestracji. Sprawdź wprowadzone dane i spr\xf3buj ponownie.":r.message),e({error:s,isLoading:!1}),!1}},logout:()=>{e({user:null,token:null,isAuthenticated:!1,error:null})},refreshToken:async()=>{let{token:e}=s();if(!e)return!1;try{return await new Promise(e=>setTimeout(e,500)),!0}catch(e){return console.error("Token refresh error:",e),s().logout(),!1}},updateUser:r=>{let{user:t}=s();t&&e({user:{...t,...r}})},updateProfile:async r=>{let{user:t}=s();if(!t?.id)return{success:!1,message:"Użytkownik nie jest zalogowany"};e({isLoading:!0,error:null});try{let a=await fetch("/api/woocommerce?endpoint=customer/update-profile",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:t.id,profile_data:r})}),i=await a.json();if(i.success){let{updateUser:r}=s();return r(i.customer),e({isLoading:!1,error:null}),{success:!0,message:i.message,customer:i.customer}}throw Error(i.error||"Nie udało się zaktualizować profilu")}catch(s){return e({isLoading:!1,error:s.message||"Wystąpił błąd podczas aktualizacji profilu"}),{success:!1,message:s.message||"Wystąpił błąd podczas aktualizacji profilu"}}},changePassword:async(r,t)=>{let{user:a}=s();if(!a?.id)return{success:!1,message:"Użytkownik nie jest zalogowany"};e({isLoading:!0,error:null});try{let s=await fetch("/api/woocommerce?endpoint=customer/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_id:a.id,current_password:r,new_password:t})}),i=await s.json();if(i.success)return e({isLoading:!1,error:null}),{success:!0,message:i.message};throw Error(i.error||"Nie udało się zmienić hasła")}catch(s){return e({isLoading:!1,error:s.message||"Wystąpił błąd podczas zmiany hasła"}),{success:!1,message:s.message||"Wystąpił błąd podczas zmiany hasła"}}},clearError:()=>{e({error:null})},setToken:s=>{e({token:s,isAuthenticated:!0})},clearToken:()=>{e({token:null,isAuthenticated:!1})},fetchUserProfile:async()=>{let{token:r,user:t}=s();if(r&&t)try{let s=await fetch("/api/woocommerce?endpoint=customers/"+t.id,{method:"GET",headers:{Authorization:`Bearer ${r}`,"Content-Type":"application/json"}});if(!s.ok)throw Error("Failed to fetch user profile");let a=await s.json(),i=a.meta_data?.find(e=>"billing_nip"===e.key),n=i?.value||"",l={id:a.id,email:a.email,firstName:a.first_name||"",lastName:a.last_name||"",role:"customer",billing:{address:a.billing?.address_1||"",city:a.billing?.city||"",postcode:a.billing?.postcode||"",country:a.billing?.country||"PL",phone:a.billing?.phone||"",company:a.billing?.company||"",nip:n},shipping:{address:a.shipping?.address_1||"",city:a.shipping?.city||"",postcode:a.shipping?.postcode||"",country:a.shipping?.country||"PL"}};e({user:l})}catch(e){console.error("❌ Error fetching user profile:",e)}}}),{name:"filler-auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}))},25438:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},27541:(e,s,r)=>{"use strict";var t=r(43041);r.o(t,"useRouter")&&r.d(s,{useRouter:function(){return t.useRouter}}),r.o(t,"useSearchParams")&&r.d(s,{useSearchParams:function(){return t.useSearchParams}})},38391:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},45801:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},52744:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},63072:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},72463:(e,s,r)=>{Promise.resolve().then(r.bind(r,894))},74624:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},82078:(e,s,r)=>{"use strict";r.d(s,{A:()=>t});let t=(0,r(92068).A)("download",[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]])},90011:(e,s,r)=>{"use strict";function t(e){return new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN",minimumFractionDigits:2,maximumFractionDigits:2}).format(e)}function a(e){return 1.23*e}function i(e){return t(a(e))+" (z VAT)"}r.d(s,{$g:()=>t,FP:()=>a,mF:()=>i})}},e=>{e.O(0,[9391,9775,6489,587,18,7358],()=>e(e.s=72463)),_N_E=e.O()}]);