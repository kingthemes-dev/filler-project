"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4294],{16085:(e,a,t)=>{t.d(a,{A:()=>b});var r=t(54568),s=t(7620),i=t(39109),n=t(86660),o=t(26862),l=t(12598),d=t(10614),c=t(12494),u=t(70415),m=t(91762),x=t(43199),p=t(67550),g=t(95400),h=t(29977),f=t(56489),y=t(32536),v=t(90011);function b({isOpen:e,onClose:a,product:t}){let b,[w,j]=(0,s.useState)(0),[N,k]=(0,s.useState)(1),[F,_]=(0,s.useState)({}),[z,$]=(0,s.useState)(!1),[S,A]=(0,s.useState)([]),[L,P]=(0,s.useState)(""),{addItem:C,openCart:T}=(0,x.x)(),{toggleFavorite:E,isFavorite:I}=(0,p.I)();if((0,s.useEffect)(()=>{e&&t&&(async()=>{try{if("variable"===t.type){let e=await f.Ay.getProductVariations(t.id),a=Array.isArray(e)?e:e.variations||[];A(a)}else A([])}catch(e){console.error("Błąd pobierania wariant\xf3w w Quick View:",e),A([])}})()},[e,t]),(0,s.useEffect)(()=>{e&&t&&(j(0),k(1),_({}),P(""))},[e,t]),(0,s.useEffect)(()=>{let t=e=>{"Escape"===e.key&&a()};return e&&(document.addEventListener("keydown",t),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",t),document.body.style.overflow="unset"}},[e,a]),!t)return null;let M=async()=>{$(!0);try{let e=parseFloat(t.sale_price||t.price),r=t.name,s=t.id;if(S.length>0&&L){let a=S.find(e=>e.attributes&&e.attributes.some(e=>e.name?.toLowerCase().includes("pojemność")&&e.option===L));a&&(s=a.id,r=a.name,e=parseFloat(a.price))}await C({id:s,name:r,price:e,image:f.Ay.getProductImageUrl(t,"medium"),quantity:N,attributes:F,variant:S.length>0&&L?{id:s,name:"Pojemność",value:L}:void 0}),setTimeout(()=>{$(!1),a(),T()},500)}catch(e){$(!1),console.error("Błąd dodawania do koszyka:",e)}},O=t.sale_price&&t.sale_price!==t.regular_price,D=O&&t.regular_price?Math.round((parseFloat(t.regular_price)-parseFloat(t.sale_price))/parseFloat(t.regular_price)*100):0,W=e=>{let a="https://qvwltjhdjw.cfolks.pl/wp-content/uploads/woocommerce-placeholder.webp";if(!e||"string"!=typeof e)return a;let t=e.trim();if(!t||"/"===t||"#"===t)return a;t=/-(?:\d{2,4})x(?:\d{2,4})(?=\.[a-zA-Z]{3,4}$)/.test(t)?t.replace(/-(?:\d{2,4})x(?:\d{2,4})(?=\.[a-zA-Z]{3,4}$)/,"-600x600"):t.replace(/(\.[a-zA-Z]{3,4})$/,"-600x600$1");try{let e=new URL(t,"https://dummy-base/");e.searchParams.delete("resize"),e.searchParams.delete("fit"),e.searchParams.delete("quality"),e.search=e.search.toString(),t=e.href.replace("https://dummy-base/","")}catch(e){}return(t=t.replace(/-scaled(?=\.[a-zA-Z]{3,4}$)/,""),/^https?:\/\//i.test(t))?t:a},Z=(b=[],(Array.isArray(t.images)&&(b="string"==typeof t.images[0]?t.images.map(e=>({src:e,name:t.name,alt:t.name})):t.images.filter(e=>{var a;return e&&e.src&&!(!(a=e.src)||/woocommerce-placeholder/i.test(a))})),b.length>0)?b:[{src:"https://qvwltjhdjw.cfolks.pl/wp-content/uploads/woocommerce-placeholder.webp",name:t.name,alt:t.name}]);return(0,r.jsx)(i.N,{children:e&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:a}),(0,r.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,r.jsxs)(n.P.div,{initial:{opacity:0,scale:.9,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.9,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"bg-white rounded-2xl shadow-2xl max-w-6xl w-full max-h-[90vh] overflow-hidden",onClick:e=>e.stopPropagation(),children:[(0,r.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Szybki podgląd"}),(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:a,className:"rounded-full p-2 hover:bg-gray-100",children:(0,r.jsx)(l.A,{className:"w-5 h-5"})})]}),(0,r.jsxs)("div",{className:"flex flex-col lg:flex-row max-h-[calc(90vh-80px)] overflow-hidden",children:[(0,r.jsx)("div",{className:"lg:w-1/2 p-6",children:(0,r.jsxs)("div",{className:"grid grid-cols-5 gap-4",children:[(0,r.jsx)("div",{className:"col-span-1 space-y-2",children:Z.map((e,a)=>(0,r.jsx)("button",{onClick:()=>j(a),className:`w-full aspect-square rounded-lg overflow-hidden border-2 transition-colors shadow-sm ${w===a?"border-black":"border-gray-200 hover:border-gray-300"}`,children:(0,r.jsx)(y.default,{src:W(e.src),alt:e.alt||e.name||t.name||"Zdjęcie produktu",width:100,height:100,className:"w-full h-full object-cover"})},a))}),(0,r.jsxs)("div",{className:"col-span-4 relative aspect-square rounded-xl overflow-hidden bg-gray-50 shadow-lg",children:[(0,r.jsx)(n.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.3},className:"absolute inset-0",children:(0,r.jsx)(y.default,{src:W(Z[w]?.src),alt:Z[w]?.alt||Z[w]?.name||t.name||"Zdjęcie produktu",fill:!0,sizes:"(min-width: 1024px) 50vw, 100vw",quality:90,className:"object-cover",priority:!0})},w),O&&(0,r.jsxs)(h.E,{className:"absolute top-4 left-4 bg-red-500 text-white",children:["-",D,"%"]})]})]})}),(0,r.jsx)("div",{className:"lg:w-1/2 p-6 overflow-y-auto max-h-[calc(90vh-80px)]",children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900",children:t.name}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:5},(e,a)=>(0,r.jsx)(o.A,{className:`w-5 h-5 ${t.average_rating&&parseFloat(t.average_rating)>0&&a<Math.floor(parseFloat(t.average_rating))?"text-yellow-400 fill-current":"text-gray-300"}`},a))}),(0,r.jsx)("div",{className:"flex items-center space-x-2",children:t.average_rating&&parseFloat(t.average_rating)>0?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-lg font-semibold text-gray-900",children:parseFloat(t.average_rating).toFixed(1)}),(0,r.jsxs)("span",{className:"text-sm text-gray-600",children:["(",t.rating_count," ",1===t.rating_count?"opinia":"opinii",")"]})]}):(0,r.jsx)("span",{className:"text-sm text-gray-500",children:"Brak opinii"})})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-2 flex-wrap",children:[O&&(0,r.jsxs)("span",{className:"bg-red-100 text-red-800 text-sm font-medium px-3 py-1 rounded-full",children:["-",D,"%"]}),t.featured&&(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:"Polecany"}),"instock"===t.stock_status?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"bg-green-100 text-green-800 text-sm font-medium px-3 py-1 rounded-full",children:"W magazynie"}),(0,r.jsx)("span",{className:"bg-blue-100 text-blue-800 text-sm font-medium px-3 py-1 rounded-full",children:"Wysyłka w 24h"})]}):"onbackorder"===t.stock_status?(0,r.jsx)("span",{className:"bg-yellow-100 text-yellow-800 text-sm font-medium px-3 py-1 rounded-full",children:"Na zam\xf3wienie"}):(0,r.jsx)("span",{className:"bg-gray-100 text-gray-800 text-sm font-medium px-3 py-1 rounded-full",children:"Brak w magazynie"})]}),t.attributes&&t.attributes.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-2",children:t.attributes.map((e,a)=>e.options&&Array.isArray(e.options)?e.options.map((e,t)=>{let s="string"==typeof e?e:e?.name||e?.slug||String(e?.id||"");return s?(0,r.jsx)("span",{className:"bg-gray-100 text-gray-700 text-xs font-medium px-2 py-1 rounded-full",children:s},`${a}-${t}`):null}):null)})]}),(0,r.jsxs)("div",{className:"space-y-4",children:[t?.type==="variable"&&S.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Wybierz wariant"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-3",children:S.map((e,a)=>{let t=e.attributes?.find(e=>"pa_pojemnosc"===e.slug||e.name?.toLowerCase().includes("pojemność")),s=t?.option||`Wariant ${e.id}`,i=L===s;return(0,r.jsx)("button",{onClick:()=>{P(s)},className:`px-4 py-3 rounded-lg text-sm font-medium transition-all duration-200 ${i?"bg-black text-white border-2 border-black":"bg-gray-100 text-gray-700 border-2 border-gray-200 hover:border-gray-300 hover:bg-gray-50"}`,children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"font-semibold",children:s}),(0,r.jsx)("div",{className:`text-xs mt-1 ${i?"text-gray-200":"text-gray-500"}`,children:(0,v.$g)(parseFloat(e.price))})]})},a)})})]}),t?.attributes&&t.attributes.length>0&&0===S.length&&(0,r.jsx)("div",{className:"space-y-4",children:t.attributes.map((e,a)=>{e.name.toLowerCase().includes("pojemność");let t=e.name.toLowerCase().includes("marka");return(0,r.jsx)("div",{children:!t&&(0,r.jsx)("div",{className:"flex flex-wrap gap-3",children:e.options.map((e,a)=>(0,r.jsx)("span",{className:"px-3 py-1 bg-gray-100 text-gray-700 text-sm font-medium rounded-full",children:"string"==typeof e?e:e&&"object"==typeof e?e.name||e.slug||String(e.id??""):String(e??"")},a))})},a)})})]}),0===S.length&&(0,r.jsx)("div",{className:"flex items-center space-x-3",children:O?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-3xl font-bold text-red-600",children:(0,v.$g)(parseFloat(t.sale_price))}),(0,r.jsx)("span",{className:"text-xl text-gray-500 line-through",children:(0,v.$g)(parseFloat(t.regular_price))})]}):(0,r.jsx)("span",{className:"text-3xl font-bold text-gray-900",children:(0,v.$g)(parseFloat(t.price))})}),(0,r.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,r.jsxs)("div",{className:"flex items-center border border-gray-200 rounded-lg h-[56px]",children:[(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>k(Math.max(1,N-1)),className:"rounded-l-lg rounded-r-none h-full px-4",children:(0,r.jsx)(d.A,{className:"w-4 h-4"})}),(0,r.jsx)("span",{className:"px-4 py-2 min-w-[60px] text-center h-full flex items-center justify-center",children:N}),(0,r.jsx)(g.$,{variant:"ghost",size:"sm",onClick:()=>k(N+1),className:"rounded-r-lg rounded-l-none h-full px-4",children:(0,r.jsx)(c.A,{className:"w-4 h-4"})})]}),(0,r.jsx)(g.$,{onClick:M,disabled:"instock"!==t.stock_status||z||S.length>0&&!L,className:"flex-1 bg-black hover:bg-gray-800 text-white h-[56px] rounded-lg font-medium",children:z?(0,r.jsx)("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(u.A,{className:"w-5 h-5 mr-2"}),S.length>0&&!L?"Wybierz wariant":"Dodaj do koszyka"]})}),(0,r.jsx)(g.$,{variant:"outline",onClick:()=>{E(t)},className:`h-[56px] px-4 rounded-lg border-2 ${I(t.id)?"text-red-500 border-red-500 hover:bg-red-50":"text-gray-600 border-gray-300 hover:bg-gray-50"}`,children:(0,r.jsx)(m.A,{className:`w-5 h-5 ${I(t.id)?"fill-current":""}`})})]})]})})]})]})})]})})}},25703:(e,a,t)=>{t.d(a,{cn:()=>i});var r=t(72902),s=t(13714);function i(...e){return(0,s.QP)((0,r.$)(e))}},29977:(e,a,t)=>{t.d(a,{E:()=>o});var r=t(54568);t(7620);var s=t(54616),i=t(25703);let n=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function o({className:e,variant:a,...t}){return(0,r.jsx)("div",{className:(0,i.cn)(n({variant:a}),e),...t})}},67550:(e,a,t)=>{t.d(a,{I:()=>l});var r=t(71620),s=t(50848),i=t(13719);let n=()=>{try{let e=i.n.getState();return e.isAuthenticated&&e.user?.id||"anonymous"}catch(e){return console.warn("Error getting auth state:",e),"anonymous"}},o=async(e,a={})=>{let t=await fetch(e,{headers:{"Content-Type":"application/json",...a.headers},...a});if(!t.ok)throw Error(`Wywołanie API nie powiodło się: ${t.statusText}`);return t.json()},l=(0,r.v)()((0,s.Zr)((e,a)=>({favorites:[],isModalOpen:!1,isLoading:!1,lastSyncTime:null,addToFavorites:async t=>{let{favorites:r}=a();if(!r.some(e=>e.id===t.id)){e({isLoading:!0});try{e({favorites:[...r,t]});let a=n();await o("/api/favorites",{method:"POST",body:JSON.stringify({userId:a,product:t})}),e({lastSyncTime:Date.now()})}catch(a){console.error("Nie udało się dodać do ulubionych:",a),e({favorites:r})}finally{e({isLoading:!1})}}},removeFromFavorites:async t=>{let{favorites:r}=a(),s=r.filter(e=>e.id!==t);e({isLoading:!0});try{e({favorites:s});let a=n();await o(`/api/favorites?userId=${a}&productId=${t}`,{method:"DELETE"}),e({lastSyncTime:Date.now()})}catch(a){console.error("Nie udało się usunąć z ulubionych:",a),e({favorites:r})}finally{e({isLoading:!1})}},toggleFavorite:async e=>{let{favorites:t,isFavorite:r}=a();r(e.id)?await a().removeFromFavorites(e.id):(await a().addToFavorites(e),a().openFavoritesModal())},isFavorite:e=>{let{favorites:t}=a();return t.some(a=>a.id===e)},openFavoritesModal:()=>{e({isModalOpen:!0})},closeFavoritesModal:()=>{e({isModalOpen:!1})},clearFavorites:async()=>{e({isLoading:!0});try{e({favorites:[]});let a=n();await o("/api/favorites/sync",{method:"POST",body:JSON.stringify({userId:a,favorites:[]})}),e({lastSyncTime:Date.now()})}catch(e){console.error("Nie udało się wyczyścić ulubionych:",e)}finally{e({isLoading:!1})}},getFavoritesCount:()=>{let{favorites:e}=a();return e.length},syncWithAPI:async()=>{let{favorites:t}=a();e({isLoading:!0});try{let a=n();await o("/api/favorites/sync",{method:"POST",body:JSON.stringify({userId:a,favorites:t})}),e({lastSyncTime:Date.now()})}catch(e){console.error("Nie udało się zsynchronizować ulubionych:",e)}finally{e({isLoading:!1})}},loadFromAPI:async()=>{e({isLoading:!0});try{let a=n(),t=await o(`/api/favorites?userId=${a}`);t.success&&e({favorites:t.data,lastSyncTime:Date.now()})}catch(e){console.error("Nie udało się załadować ulubionych z API:",e)}finally{e({isLoading:!1})}}}),{name:"favorites-storage",partialize:e=>({favorites:e.favorites,lastSyncTime:e.lastSyncTime})}))},88186:(e,a,t)=>{t.d(a,{Wu:()=>o,Zp:()=>i,aR:()=>n,wL:()=>l});var r=t(54568);t(7620);var s=t(25703);function i({className:e,...a}){return(0,r.jsx)("div",{"data-slot":"card",className:(0,s.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...a})}function n({className:e,...a}){return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,s.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...a})}function o({className:e,...a}){return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,s.cn)("px-6",e),...a})}function l({className:e,...a}){return(0,r.jsx)("div",{"data-slot":"card-footer",className:(0,s.cn)("flex items-center px-6 [.border-t]:pt-6",e),...a})}},95400:(e,a,t)=>{t.d(a,{$:()=>l});var r=t(54568);t(7620);var s=t(17398),i=t(54616),n=t(25703);let o=(0,i.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function l({className:e,variant:a,size:t,asChild:i=!1,...l}){let d=i?s.DX:"button";return(0,r.jsx)(d,{"data-slot":"button",className:(0,n.cn)(o({variant:a,size:t,className:e})),...l})}}}]);