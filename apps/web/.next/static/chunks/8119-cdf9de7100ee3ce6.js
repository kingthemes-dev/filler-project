"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8119],{58119:(e,r,a)=>{a.d(r,{A:()=>y});var t=a(54568),s=a(7620),l=a(56489),i=a(88186),o=a(95400),n=a(29977),c=a(26862),d=a(70415),u=a(38391),x=a(91762),p=a(19664),m=a.n(p),h=a(32536),g=a(43199),b=a(67550),f=a(16085),j=a(90011);function y({product:e,showActions:r=!0,variant:a="default",tabType:p}){let y,v,N,w,[k,_]=(0,s.useState)(!1),[$,z]=(0,s.useState)(!1),[F,A]=(0,s.useState)(!1),[E,P]=(0,s.useState)(""),[C,D]=(0,s.useState)(!1),[S,W]=(0,s.useState)([]),[L,M]=(0,s.useState)(!1),[B,O]=(0,s.useState)(!1),[R,Z]=(0,s.useState)(!1),[q,I]=(0,s.useState)(!1),U=(0,s.useRef)(null);(0,s.useEffect)(()=>{I(!0)},[]),(0,s.useEffect)(()=>{let e=e=>{U.current&&!U.current.contains(e.target)&&Z(!1)};return R&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[R]),(0,s.useEffect)(()=>{},[S]);try{let e=(0,g.x)();y=e.addItem,v=e.openCart}catch(e){console.warn("Cart store not available:",e),y=()=>{},v=()=>{}}try{let e=(0,b.I)();N=e.toggleFavorite,w=e.isFavorite}catch(e){console.warn("Favorites store not available:",e),N=()=>{},w=()=>!1}let V=async()=>{_(!0);try{let r;if("variable"===e.type&&E){let a=await l.Ay.getProductVariations(e.id),t=a.variations?.find(e=>e.attributes?.some(e=>"pa_pojemnosc"===e.slug&&e.option===E));r=t?{id:t.id,name:`${e.name} - ${E}`,price:parseFloat(t.price),regular_price:parseFloat(t.regular_price),sale_price:parseFloat(t.sale_price),image:ee,permalink:`/produkt/${e.slug}`}:{id:e.id,name:e.name,price:parseFloat(e.price),regular_price:parseFloat(e.regular_price),sale_price:parseFloat(e.sale_price),image:ee,permalink:`/produkt/${e.slug}`}}else r={id:e.id,name:e.name,price:parseFloat(e.price),regular_price:parseFloat(e.regular_price),sale_price:parseFloat(e.sale_price),image:ee,permalink:`/produkt/${e.slug}`};y(r),v()}catch(e){console.error("Błąd dodawania do koszyka:",e)}finally{_(!1)}},T=()=>{N(e)},G=()=>{z(!0)},H=async()=>{if(!C)try{let r=await l.Ay.getProductVariations(e.id),a=Array.isArray(r)?r:r.variations||[];W([...a]),D(!0),setTimeout(()=>{},100)}catch(e){console.error("Błąd ładowania wariant\xf3w:",e)}A(!0),Z(!0)},J=async()=>{if("variable"===e.type&&!E)return void H();await V()},K=async(r,a)=>{_(!0);try{let t={id:r.id,name:`${e.name} - ${a}`,price:parseFloat(r.price),regular_price:parseFloat(r.regular_price),sale_price:parseFloat(r.sale_price),image:ee,permalink:`/produkt/${e.slug}`};y(t),v()}catch(e){console.error("Błąd dodawania wariantu do koszyka:",e)}finally{_(!1)}},Q=()=>{if(S.length>0)return S.map(e=>{let r=e.attributes?.find(e=>e.slug&&e.option);return r?.option||e.name||`Wariant ${e.id}`});if(!e.attributes)return[];let r=e.attributes.find(e=>e.options&&e.options.length>0);return r?(r.options||[]).map(e=>"string"==typeof e?e:"object"==typeof e&&e.name?e.name:"object"==typeof e&&e.slug?e.slug:String(e)).filter(Boolean):[]},X=l.Ay.isProductOnSale(e),Y=l.Ay.getProductDiscount(e),ee=(()=>{if(Array.isArray(e.images)&&e.images.length>0)return l.Ay.getProductImageUrl(e,"medium");if("string"==typeof e.image&&e.image){let r=e.image;return r.includes("-300x300.")?r.replace("-300x300.","-600x600."):r.includes("-150x150.")?r.replace("-150x150.","-600x600."):r.includes("-100x100.")?r.replace("-100x100.","-600x600."):r}return"/images/placeholder-product.jpg"})(),er=l.Ay.formatPrice(e.price),ea=l.Ay.formatPrice(e.regular_price),et=()=>X?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-lg font-bold text-foreground",children:er}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground line-through",children:ea}),(0,t.jsxs)(n.E,{variant:"destructive",className:"text-xs",children:["-",Y,"%"]})]}):(0,t.jsx)("span",{className:"text-lg font-bold text-foreground",children:er}),es=()=>{let r=parseFloat(e.average_rating);return isNaN(r)||0===r?null:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(c.A,{className:"w-4 h-4 fill-current text-foreground"}),(0,t.jsx)("span",{className:"text-sm text-muted-foreground",children:r.toFixed(1)}),(0,t.jsxs)("span",{className:"text-xs text-muted-foreground",children:["(",e.rating_count,")"]})]})},el=()=>"outofstock"===e.stock_status?(0,t.jsx)(n.E,{variant:"secondary",className:"text-xs",children:"Niedostępny"}):"onbackorder"===e.stock_status?(0,t.jsx)(n.E,{variant:"secondary",className:"text-xs",children:"Na zam\xf3wienie"}):null;return"compact"===a?(0,t.jsx)(i.Zp,{className:"group hover:shadow-lg transition-all duration-300 border-border/50",children:(0,t.jsxs)(m(),{href:`/produkt/${e.slug}`,children:[(0,t.jsx)(i.aR,{className:"p-3 pb-0",children:(0,t.jsxs)("div",{className:"relative aspect-square overflow-hidden rounded-lg",children:[(0,t.jsx)(h.default,{src:ee,alt:e.name,width:300,height:300,sizes:"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 25vw",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),X&&(0,t.jsxs)(n.E,{variant:"destructive",className:"absolute top-2 left-2 text-xs",children:["-",Y,"%"]})]})}),(0,t.jsxs)(i.Wu,{className:"px-5 py-2",children:[(0,t.jsx)("h3",{className:"font-medium text-sm text-foreground line-clamp-2 mb-1",children:e.name}),et(),es()]})]})}):"featured"===a?(0,t.jsxs)(i.Zp,{className:"group hover:shadow-xl transition-all duration-300 border-border/50 bg-gradient-to-br from-background to-muted/20",children:[(0,t.jsxs)(m(),{href:`/produkt/${e.slug}`,children:[(0,t.jsx)(i.aR,{className:"p-4 pb-0",children:(0,t.jsxs)("div",{className:"relative aspect-square overflow-hidden rounded-lg",children:[(0,t.jsx)(h.default,{src:ee,alt:e.name,width:300,height:300,sizes:"(max-width: 640px) 50vw, (max-width: 1024px) 33vw, 25vw",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),X&&(0,t.jsxs)(n.E,{variant:"destructive",className:"absolute top-3 left-3 text-sm border-2 border-destructive/20 rounded-xl px-3 py-1",children:["-",Y,"%"]}),e.featured&&!X&&(0,t.jsx)(n.E,{className:"absolute top-3 right-3 text-sm bg-primary text-primary-foreground border-2 border-primary/20 rounded-xl px-3 py-1",children:"Polecany"}),X&&e.featured&&(0,t.jsx)(n.E,{className:"absolute top-3 right-3 text-sm bg-amber-600 text-white border-2 border-amber-500/20 rounded-xl px-3 py-1",children:"Promocja"})]})}),(0,t.jsxs)(i.Wu,{className:"px-6 py-3",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg text-foreground line-clamp-2 mb-2",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2 mb-3",children:e.short_description}),et(),es(),el()]})]}),r&&(0,t.jsx)(i.wL,{className:"px-6 pt-0 pb-4",children:(0,t.jsxs)("div",{className:"flex gap-2 w-full",children:["variable"===e.type&&R?(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsx)("div",{className:"text-sm font-medium text-gray-700 mb-2",children:"Wybierz wariant:"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:Q().map(e=>(0,t.jsx)("button",{onClick:()=>{P(e),A(!1)},className:`px-3 py-2 text-sm rounded-lg border transition-colors ${E===e?"bg-black text-white border-black":"bg-white text-gray-700 border-gray-300 hover:border-black"}`,children:e},e))}),E&&(0,t.jsxs)(o.$,{onClick:V,disabled:k||"outofstock"===e.stock_status,className:"w-full h-12 py-6 hover:bg-black hover:text-white transition-colors text-base",size:"sm",children:[(0,t.jsx)(d.A,{className:"w-4 h-4 mr-2"}),k?"Dodawanie...":`Dodaj ${E} do koszyka`]})]}):(0,t.jsxs)(o.$,{onClick:J,disabled:k||"outofstock"===e.stock_status,className:"flex-1 h-10 py-2 hover:bg-black hover:text-white transition-colors text-sm",size:"sm",children:[(0,t.jsx)(d.A,{className:"w-4 h-4 mr-2"}),k?"Dodawanie...":"variable"===e.type?"Wybierz wariant":"Dodaj do koszyka"]}),(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:G,className:"px-3 h-10 hover:bg-black hover:text-white transition-colors","aria-label":"Szybki podgląd",children:(0,t.jsx)(u.A,{className:"w-4 h-4"})}),(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:T,className:`px-3 h-10 hover:bg-black hover:text-white transition-colors ${q&&w(e.id)?"text-destructive":""}`,"aria-label":q&&w(e.id)?"Usuń z ulubionych":"Dodaj do ulubionych",children:(0,t.jsx)(x.A,{className:`w-4 h-4 ${q&&w(e.id)?"fill-current":""}`})})]})}),(0,t.jsx)(f.A,{isOpen:$,onClose:()=>z(!1),product:e})]}):"list"===a?(0,t.jsxs)(i.Zp,{className:"group hover:shadow-lg transition-all duration-300 border-gray-200 rounded-xl overflow-hidden relative",onMouseEnter:()=>{M(!0),"variable"!==e.type||C||H()},onMouseLeave:()=>{M(!1)},children:[(0,t.jsxs)(m(),{href:`/produkt/${e.slug}`,className:"flex h-40",children:[(0,t.jsxs)("div",{className:"w-40 h-40 flex-shrink-0 relative",children:[(0,t.jsx)(h.default,{src:ee,alt:e.name,width:160,height:160,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),(0,t.jsx)("div",{className:"absolute top-2 left-2",children:X?(0,t.jsx)(n.E,{className:"bg-red-100 text-red-800 text-xs px-2 py-1 rounded-full border-0",children:"Promocja"}):e.featured?(0,t.jsx)(n.E,{className:"bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full border-0",children:"Polecany"}):null})]}),(0,t.jsxs)("div",{className:"flex-1 px-6 py-4 flex flex-col justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg text-gray-900 group-hover:text-black transition-colors line-clamp-2",children:e.name}),(0,t.jsx)("div",{className:"mt-1",children:et()}),(0,t.jsx)("div",{className:"mt-1",children:es()}),(0,t.jsx)("div",{className:"mt-1",children:el()})]}),r&&(0,t.jsxs)("div",{className:"flex items-center gap-4 mt-4",children:["variable"===e.type?(0,t.jsx)(o.$,{onClick:e=>{e.preventDefault(),e.stopPropagation(),H()},size:"sm",className:"bg-black hover:bg-gray-800 text-white px-8 py-3 text-sm font-medium rounded-lg",children:"Wybierz wariant"}):(0,t.jsx)(o.$,{onClick:e=>{e.preventDefault(),e.stopPropagation(),V()},disabled:"outofstock"===e.stock_status||k,size:"sm",className:"bg-black hover:bg-gray-800 text-white px-8 py-3 text-sm font-medium rounded-lg",children:k?"Dodawanie...":"Dodaj do koszyka"}),(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),G()},className:"px-4 py-3 h-10 w-10 rounded-lg border-gray-200 hover:border-gray-300",children:(0,t.jsx)(u.A,{className:"w-4 h-4"})}),(0,t.jsx)(o.$,{variant:"outline",size:"sm",onClick:e=>{e.preventDefault(),e.stopPropagation(),T()},className:`px-4 py-3 h-10 w-10 rounded-lg ${q&&w(e.id)?"text-red-500 border-red-200 bg-red-50 hover:bg-red-100":"text-gray-500 border-gray-200 hover:border-gray-300"}`,children:(0,t.jsx)(x.A,{className:`w-4 h-4 ${q&&w(e.id)?"fill-current":""}`})})]})]})]}),"variable"===e.type&&S.length>0&&(0,t.jsx)("div",{className:`absolute inset-0 bg-white/50 backdrop-blur-sm transition-all duration-300 ${L?"opacity-100":"opacity-0 pointer-events-none"}`,children:(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center h-full p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"Wybierz wariant"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-3 justify-center",children:Q().map(e=>{let r=S.find(r=>{let a=r.attributes?.find(e=>e.slug&&e.option);return a?.option===e}),a=r?.price||r?.sale_price||r?.regular_price,s=r?.sale_price&&parseFloat(r.sale_price)<parseFloat(r.regular_price||"0"),l=r?.regular_price;return(0,t.jsxs)("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),r&&K(r,e)},className:"flex flex-col items-center p-3 border border-gray-200 rounded-xl hover:border-gray-900 hover:shadow-md transition-all duration-200 bg-white",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900 mb-1",children:e}),(0,t.jsx)("div",{className:"text-xs font-bold text-gray-900",children:a&&(0,t.jsx)(t.Fragment,{children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-red-600",children:(0,j.$g)(parseFloat(a))}),l&&(0,t.jsx)("span",{className:"text-gray-400 line-through ml-1",children:(0,j.$g)(parseFloat(l))})]}):(0,t.jsx)("span",{children:(0,j.$g)(parseFloat(a))})})})]},e)})})]})}),(0,t.jsx)(f.A,{isOpen:$,onClose:()=>z(!1),product:e})]}):(0,t.jsxs)(i.Zp,{className:"group flex flex-col h-full hover:shadow-lg transition-all duration-300 border-gray-200 rounded-2xl sm:rounded-3xl overflow-hidden p-0 relative",onMouseEnter:()=>{M(!0),"variable"!==e.type||C||H()},onMouseLeave:()=>{M(!1)},children:[(0,t.jsxs)(m(),{href:`/produkt/${e.slug}`,className:"flex flex-col flex-grow",onClick:e=>{e.target.closest("button")&&e.preventDefault()},children:[(0,t.jsx)(i.aR,{className:"p-0 relative",children:(0,t.jsxs)("div",{className:"relative aspect-square overflow-hidden",children:[(0,t.jsx)(h.default,{src:ee,alt:e.name,width:300,height:300,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"}),(0,t.jsx)("div",{className:"absolute top-2 left-2",children:"promocje"===p||X?(0,t.jsx)(n.E,{className:"bg-red-100 text-red-800 text-xs px-3 py-1 rounded-full border-0",children:"Promocja"}):"nowosci"===p?(0,t.jsx)(n.E,{className:"bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full border-0",children:"Nowość"}):"polecane"===p||e.featured?(0,t.jsx)(n.E,{className:"bg-green-100 text-green-800 text-xs px-3 py-1 rounded-full border-0",children:"Polecany"}):(0,t.jsx)(n.E,{className:"bg-blue-100 text-blue-800 text-xs px-3 py-1 rounded-full border-0",children:"Nowość"})}),(0,t.jsxs)("div",{className:"absolute top-2 right-2 flex gap-2",children:[(0,t.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),G()},className:"w-8 h-8 bg-white/80 hover:bg-white hover:shadow-md rounded-full flex items-center justify-center transition-all duration-150","aria-label":"Szybki podgląd",children:(0,t.jsx)(u.A,{className:"w-4 h-4 text-gray-700"})}),(0,t.jsx)("button",{onClick:e=>{e.preventDefault(),e.stopPropagation(),T()},className:"w-8 h-8 bg-white/80 hover:bg-white hover:shadow-md rounded-full flex items-center justify-center transition-all duration-150","aria-label":q&&w(e.id)?"Usuń z ulubionych":"Dodaj do ulubionych",children:(0,t.jsx)(x.A,{className:`w-4 h-4 ${q&&w(e.id)?"fill-current text-red-500":"text-gray-700"}`})})]})]})}),(0,t.jsxs)(i.Wu,{className:"px-3 sm:px-4 py-2 flex-grow",children:[(0,t.jsx)("div",{className:"text-xs sm:text-sm text-gray-500 mb-2 flex items-center",children:(()=>{let r=e.categories;if(!r||0===r.length)return null;let a=["Mezoterapia","Peelingi","Stymulatory","Wypełniacze"],t=r.find(e=>{let r="string"==typeof e?e:e?.name;return r&&a.includes(r)});return t?"string"==typeof t?t:t?.name:null})()||"Bez kategorii"}),(0,t.jsx)("p",{className:"font-bold text-foreground text-base sm:text-lg mb-2 line-clamp-2",children:e.name}),(0,t.jsx)("div",{className:"text-lg sm:text-xl font-bold text-foreground mb-2",children:er}),e.attributes&&e.attributes.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:e.attributes.map((e,r)=>e.options&&Array.isArray(e.options)?e.options.slice(0,2).map((e,a)=>{if(!e)return null;let s="string"==typeof e?e:e?.name||e?.slug||String(e?.id||"");return s?(0,t.jsx)("span",{className:"bg-gray-100 text-gray-600 text-xs font-medium px-2 py-0.5 rounded-full",children:s},`${r}-${a}`):null}):null)})]})]}),"variable"===e.type&&S.length>0&&(0,t.jsx)("div",{className:`absolute inset-0 bg-white/50 backdrop-blur-sm transition-all duration-300 ${L?"opacity-100":"opacity-0 pointer-events-none"}`,children:(0,t.jsxs)("div",{className:"flex flex-col justify-center items-center h-full p-6",children:[(0,t.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-4 text-center",children:"Wybierz wariant"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-3 justify-center",children:Q().map(e=>{let r=S.find(r=>{let a=r.attributes?.find(e=>e.slug&&e.option);return a?.option===e}),a=r?.price||r?.sale_price||r?.regular_price,s=r?.sale_price&&parseFloat(r.sale_price)<parseFloat(r.regular_price||"0"),l=r?.regular_price;return(0,t.jsxs)("button",{onClick:a=>{a.preventDefault(),a.stopPropagation(),r&&K(r,e)},className:"flex flex-col items-center p-3 border border-gray-200 rounded-xl hover:border-gray-900 hover:shadow-md transition-all duration-200 bg-white",children:[(0,t.jsx)("span",{className:"text-sm font-medium text-gray-900 mb-1",children:e}),(0,t.jsx)("div",{className:"text-xs font-bold text-gray-900",children:a&&(0,t.jsx)(t.Fragment,{children:s?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-red-600",children:(0,j.$g)(parseFloat(a))}),l&&(0,t.jsx)("span",{className:"text-gray-400 line-through ml-1",children:(0,j.$g)(parseFloat(l))})]}):(0,t.jsx)("span",{children:(0,j.$g)(parseFloat(a))})})})]},e)})})]})}),r&&(0,t.jsx)(i.wL,{className:"px-3 sm:px-4 pb-4 mt-auto",children:(0,t.jsxs)("div",{className:"w-full relative",ref:U,children:[(0,t.jsxs)(o.$,{onClick:r=>{r.preventDefault(),r.stopPropagation(),"variable"===e.type?H():V()},onMouseEnter:()=>{O(!0),"variable"!==e.type||C||H()},onMouseLeave:()=>{O(!1)},disabled:k||"outofstock"===e.stock_status,className:"w-full bg-white border border-black text-gray-900 hover:bg-gray-50 rounded-lg py-3 font-medium text-sm",size:"lg",children:[(0,t.jsx)(d.A,{className:"w-4 h-4 mr-2"}),k?"Dodawanie...":"variable"===e.type?"Wybierz wariant":"Dodaj do koszyka"]}),!1]})}),(0,t.jsx)(f.A,{isOpen:$,onClose:()=>z(!1),product:e})]})}}}]);