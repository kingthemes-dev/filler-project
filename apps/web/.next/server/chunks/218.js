"use strict";exports.id=218,exports.ids=[218],exports.modules={92218:(a,b,c)=>{c.r(b),c.d(b,{default:()=>p});var d=c(78157),e=c(31768),f=c(83042),g=c(72886),h=c(51320);let i=(0,c(81744).A)("chevron-up",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);var j=c(36022),k=c(6046),l=c(9686);class m{constructor(){this.baseUrl="http://localhost:3002/api/woocommerce"}async getAllCategories(){try{let a=await fetch(`${this.baseUrl}?endpoint=products/categories&per_page=100`);if(!a.ok)throw Error(`HTTP error! status: ${a.status}`);let b=await a.json();return Array.isArray(b)?b:b.categories||[]}catch(a){return console.error("Error fetching categories:",a),[]}}async getAllAttributes(){try{let a=await fetch(`${this.baseUrl}?endpoint=products/attributes&per_page=100`);if(!a.ok)throw Error(`HTTP error! status: ${a.status}`);let b=await a.json();return Array.isArray(b)?b:b.attributes||[]}catch(a){return console.error("Error fetching attributes:",a),[]}}async getAttributeTerms(a){try{let b=await fetch(`${this.baseUrl}?endpoint=products/attributes/${a}/terms&per_page=100`);if(!b.ok)throw Error(`HTTP error! status: ${b.status}`);let c=await b.json();return Array.isArray(c)?c:c.terms||[]}catch(b){return console.error(`Error fetching terms for attribute ${a}:`,b),[]}}buildCategoryHierarchy(a){let b=a.sort((a,b)=>a.parent!==b.parent?a.parent-b.parent:a.id-b.id),c=new Map,d=[];return b.forEach(a=>{let b={id:a.slug,name:a.name,slug:a.slug,count:a.count,parent:a.parent,level:0,subcategories:[],description:a.description,image:a.image};c.set(a.id,b)}),b.forEach(a=>{let b=c.get(a.id);if(b)if(0===a.parent)b.level=0,d.push(b);else{let e=c.get(a.parent);e?(b.level=e.level+1,e.subcategories.push(b)):(b.level=0,d.push(b))}}),d}async getDynamicFilters(){try{let[a,b]=await Promise.all([this.getAllCategories(),this.getAllAttributes()]),c=this.buildCategoryHierarchy(a),d={};for(let a of b){let b=await this.getAttributeTerms(a.id);d[a.slug]={name:a.name,slug:a.slug,terms:b}}return{categories:c,attributes:d}}catch(a){return console.error("Error fetching dynamic filters:",a),{categories:[],attributes:{}}}}async getCategoriesWithCounts(a={}){try{let b=await this.getAllCategories();if(!a.category&&!a.search&&!a.attributes&&!a.minPrice&&!a.maxPrice&&!a.onSale)return this.buildCategoryHierarchy(b);let c=new URLSearchParams;c.append("endpoint","shop"),c.append("per_page","1"),a.search&&c.append("search",a.search),a.minPrice&&c.append("min_price",a.minPrice.toString()),a.maxPrice&&c.append("max_price",a.maxPrice.toString()),a.onSale&&c.append("on_sale","true");let d=await fetch(`${this.baseUrl}?${c.toString()}`),e=await d.json();if(e.categories)return this.buildCategoryHierarchy(e.categories);return this.buildCategoryHierarchy(b)}catch(b){console.error("Error fetching categories with counts:",b);let a=await this.getAllCategories();return this.buildCategoryHierarchy(a)}}}function n({onCategoryChange:a,selectedCategories:b,totalProducts:c}){let[h,i]=(0,e.useState)([]),[j,k]=(0,e.useState)(!0),[m,n]=(0,e.useState)(new Set),o=a=>m.has(a),p=a=>b.includes(a);return j?(0,d.jsx)("div",{className:"space-y-2",children:(0,d.jsxs)("div",{className:"animate-pulse",children:[(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-3/4 mb-2"}),(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-2"}),(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-2/3"})]})}):(0,d.jsxs)("div",{className:"space-y-2",children:[h.map(b=>(0,d.jsxs)("div",{className:"border border-gray-100 rounded-lg overflow-hidden",children:[(0,d.jsx)("div",{className:"bg-gray-50",children:(0,d.jsxs)("div",{className:"flex items-center p-2 sm:p-3",children:[b.subcategories.length>0&&(0,d.jsx)("button",{onClick:()=>{var a;return a=b.id,void n(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},className:"flex items-center justify-center w-6 h-6 rounded hover:bg-gray-200 transition-colors mr-2",children:(0,d.jsx)(g.P.div,{animate:{rotate:90*!!o(b.id)},transition:{duration:.2},children:(0,d.jsx)(l.A,{className:"w-4 h-4 text-gray-500"})})}),(0,d.jsxs)("label",{className:"flex items-center flex-1 cursor-pointer",children:[(0,d.jsx)("input",{type:"checkbox",name:"categories",value:b.slug,checked:p(b.slug),onChange:()=>a(b.slug),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 rounded"}),(0,d.jsx)("span",{className:"ml-3 text-xs sm:text-sm font-semibold text-gray-800",children:b.name}),(0,d.jsxs)("span",{className:"ml-auto text-xs text-gray-500",children:["(",b.count,")"]})]})]})}),(0,d.jsx)(f.N,{children:o(b.id)&&b.subcategories.length>0&&(0,d.jsx)(g.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden bg-white",children:(0,d.jsx)("div",{className:"border-t border-gray-100",children:b.subcategories.map((c,e)=>(0,d.jsxs)(g.P.label,{className:"flex items-center p-2 sm:p-3 pl-8 hover:bg-gray-50 cursor-pointer transition-colors border-b border-gray-50 last:border-b-0",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*e},children:[(0,d.jsx)("input",{type:"checkbox",name:"categories",value:c.slug,checked:p(c.slug),onChange:()=>a(b.slug,c.slug),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 rounded"}),(0,d.jsx)("span",{className:"ml-3 text-xs sm:text-sm font-medium text-gray-700",children:c.name}),(0,d.jsxs)("span",{className:"ml-auto text-xs text-gray-500",children:["(",c.count,")"]})]},c.id))})})})]},b.id)),0===h.length&&!j&&(0,d.jsx)("div",{className:"text-center py-4",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Brak kategorii do wyświetlenia"})})]})}function o({onFilterChange:a,selectedFilters:b,totalProducts:c,currentFilters:h={categories:[]}}){let[k,l]=(0,e.useState)({}),[m,n]=(0,e.useState)(!0),[o,p]=(0,e.useState)(!1),[q,r]=(0,e.useState)(new Set),[s,t]=(0,e.useState)(""),u=a=>q.has(a);if(m)return(0,d.jsx)("div",{className:"space-y-4",children:[void 0,void 0].map((a,b)=>(0,d.jsxs)("div",{className:"animate-pulse",children:[(0,d.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/3 mb-2"}),(0,d.jsxs)("div",{className:"space-y-2",children:[(0,d.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),(0,d.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"}),(0,d.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]},b))});let v=Object.entries(k);return 0===v.length?(0,d.jsx)("div",{className:"text-center py-4",children:(0,d.jsx)("p",{className:"text-sm text-gray-500",children:"Brak atrybut\xf3w do wyświetlenia"})}):(0,d.jsxs)("div",{className:"space-y-4 relative",children:[o&&(0,d.jsx)("div",{className:"absolute top-0 right-0 z-10",children:(0,d.jsx)("div",{className:"w-4 h-4 border-2 border-gray-300 border-t-black rounded-full animate-spin"})}),v.map(([c,e])=>(0,d.jsxs)("div",{className:"border border-gray-100 rounded-lg overflow-hidden",children:[(0,d.jsx)("div",{className:"bg-gray-50",children:(0,d.jsxs)("button",{onClick:()=>{r(a=>{let b=new Set(a);return b.has(c)?b.delete(c):b.add(c),b})},className:"flex items-center justify-between w-full p-3 hover:bg-gray-100 transition-colors",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)("span",{className:"text-sm font-semibold text-gray-800",children:e.name}),(0,d.jsxs)("span",{className:"ml-2 text-xs text-gray-500",children:["(",e.terms.length,")"]})]}),u(c)?(0,d.jsx)(i,{className:"w-4 h-4 text-gray-500"}):(0,d.jsx)(j.A,{className:"w-4 h-4 text-gray-500"})]})}),(0,d.jsx)(f.N,{children:u(c)&&(0,d.jsx)(g.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3,ease:"easeInOut"},className:"overflow-hidden bg-white",children:(0,d.jsx)("div",{className:"border-t border-gray-100",children:e.terms.filter(a=>a.count>0).sort((a,b)=>b.count-a.count).map((e,f)=>(0,d.jsxs)(g.P.label,{className:"flex items-center p-2 sm:p-3 hover:bg-gray-50 cursor-pointer transition-colors border-b border-gray-50 last:border-b-0",initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.05*f},children:[(0,d.jsx)("input",{type:"checkbox",name:c,value:e.slug,checked:((a,c)=>{let d=b[`pa_${a}`];return(Array.isArray(d)?d:[]).includes(c)})(c,e.slug),onChange:()=>((c,d)=>{let e=b[`pa_${c}`],f=Array.isArray(e)?e:[];a(`pa_${c}`,(f.includes(d)?f.filter(a=>a!==d):[...f,d]).join(","))})(c,e.slug),className:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500 rounded"}),(0,d.jsx)("span",{className:"ml-3 text-xs sm:text-sm font-medium text-gray-700",children:e.name}),(0,d.jsxs)("span",{className:"ml-auto text-xs text-gray-500",children:["(",e.count,")"]})]},e.id))})})})]},c))]})}function p({categories:a,filters:b,onFilterChange:c,onCategoryChange:l,onClearFilters:m,showFilters:p,onToggleFilters:q,totalProducts:r,attributesLoading:s,wooCommerceCategories:t,products:u=[]}){let[v,w]=(0,e.useState)({categories:!0,attributes:!0,price:!0,availability:!0}),x=a=>{w(b=>({...b,[a]:!b[a]}))};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("div",{className:"lg:hidden mb-4",children:(0,d.jsxs)("button",{onClick:q,className:"w-full flex items-center justify-between p-4 bg-white border border-gray-200 rounded-xl hover:bg-gray-50 transition-colors",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(h.A,{className:"w-4 h-4 mr-2"}),(0,d.jsx)("span",{className:"font-medium",children:"Filtry"})]}),p?(0,d.jsx)(i,{className:"w-4 h-4"}):(0,d.jsx)(j.A,{className:"w-4 h-4"})]})}),(0,d.jsx)("div",{className:`${p?"block":"hidden lg:block"} lg:sticky lg:top-24 lg:self-start`,children:(0,d.jsxs)("div",{className:"bg-white border border-gray-200 rounded-2xl p-4 sm:p-6 shadow-sm",children:[(0,d.jsxs)("div",{className:"flex items-center justify-between mb-4 sm:mb-6",children:[(0,d.jsxs)("div",{className:"flex items-center",children:[(0,d.jsx)(h.A,{className:"w-4 h-4 sm:w-5 sm:h-5 mr-2 text-gray-600"}),(0,d.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:"Filtry"}),(0,d.jsxs)("span",{className:"ml-2 text-xs sm:text-sm text-gray-500",children:["(",r," produkt\xf3w)"]})]}),(0,d.jsxs)("div",{className:"flex items-center gap-2",children:[(0,d.jsx)("button",{onClick:m,className:"text-xs sm:text-sm text-gray-500 hover:text-gray-700 px-2 py-1 rounded-lg hover:bg-gray-100 transition-colors",children:"Wyczyść"}),(0,d.jsx)("button",{onClick:q,className:"lg:hidden p-1 hover:bg-gray-100 rounded-lg transition-colors",children:(0,d.jsx)(k.A,{className:"w-4 h-4"})})]})]}),(0,d.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,d.jsxs)("button",{onClick:()=>x("categories"),className:"flex items-center justify-between w-full mb-3 sm:mb-4",children:[(0,d.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Kategorie"}),v.categories?(0,d.jsx)(i,{className:"w-4 h-4 text-gray-500"}):(0,d.jsx)(j.A,{className:"w-4 h-4 text-gray-500"})]}),(0,d.jsx)(f.N,{children:v.categories&&(0,d.jsx)(g.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},children:(0,d.jsx)(n,{onCategoryChange:l,selectedCategories:b.categories,totalProducts:r})})})]}),(0,d.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,d.jsxs)("button",{onClick:()=>x("attributes"),className:"flex items-center justify-between w-full mb-3 sm:mb-4",children:[(0,d.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Atrybuty"}),v.attributes?(0,d.jsx)(i,{className:"w-4 h-4 text-gray-500"}):(0,d.jsx)(j.A,{className:"w-4 h-4 text-gray-500"})]}),(0,d.jsx)(f.N,{children:v.attributes&&(0,d.jsx)(g.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:(0,d.jsx)(o,{onFilterChange:c,selectedFilters:b,totalProducts:r,currentFilters:{categories:b.categories,search:b.search,minPrice:b.minPrice,maxPrice:b.maxPrice,attributes:Object.keys(b).filter(a=>a.startsWith("pa_")),attributeValues:Object.keys(b).filter(a=>a.startsWith("pa_")).reduce((a,c)=>(a[c]=b[c],a),{})}})})})]}),(0,d.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,d.jsxs)("button",{onClick:()=>x("price"),className:"flex items-center justify-between w-full mb-3 sm:mb-4",children:[(0,d.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Zakres cen"}),v.price?(0,d.jsx)(i,{className:"w-4 h-4 text-gray-500"}):(0,d.jsx)(j.A,{className:"w-4 h-4 text-gray-500"})]}),(0,d.jsx)(f.N,{children:v.price&&(0,d.jsx)(g.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-4",children:(0,d.jsx)("div",{className:"space-y-3",children:(0,d.jsxs)("div",{className:"flex gap-3",children:[(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Od (zł)"}),(0,d.jsx)("input",{type:"number",placeholder:"0",value:b.minPrice?b.minPrice:"",onChange:a=>c("minPrice",Number(a.target.value)||0),className:"w-full px-2 sm:px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,d.jsxs)("div",{className:"flex-1",children:[(0,d.jsx)("label",{className:"block text-xs font-medium text-gray-600 mb-1",children:"Do (zł)"}),(0,d.jsx)("input",{type:"number",placeholder:"9999",value:b.maxPrice?b.maxPrice:"",onChange:a=>c("maxPrice",Number(a.target.value)||999999),className:"w-full px-2 sm:px-3 py-2 border border-gray-300 rounded-lg text-xs sm:text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})})})})]}),(0,d.jsxs)("div",{className:"mb-4 sm:mb-6",children:[(0,d.jsxs)("button",{onClick:()=>x("availability"),className:"flex items-center justify-between w-full mb-3 sm:mb-4",children:[(0,d.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-gray-900",children:"Oferty specjalne"}),v.availability?(0,d.jsx)(i,{className:"w-4 h-4 text-gray-500"}):(0,d.jsx)(j.A,{className:"w-4 h-4 text-gray-500"})]}),(0,d.jsx)(f.N,{children:v.availability&&(0,d.jsx)(g.P.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.2},className:"space-y-3",children:(0,d.jsxs)("label",{className:`flex items-center p-3 sm:p-4 rounded-lg cursor-pointer transition-all duration-200 border-2 ${b.onSale?"bg-gradient-to-r from-blue-50 to-blue-100 border-blue-200 shadow-sm":"hover:bg-gradient-to-r hover:from-gray-50 hover:to-gray-100 border-transparent hover:border-gray-200"}`,children:[(0,d.jsx)("input",{type:"checkbox",checked:b.onSale,onChange:a=>c("onSale",a.target.checked),className:"w-5 h-5 text-blue-600 border-2 border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200"}),(0,d.jsxs)("div",{className:"ml-3 sm:ml-4",children:[(0,d.jsx)("span",{className:`text-xs sm:text-sm font-semibold ${b.onSale?"text-blue-700":"text-gray-700"}`,children:"Promocje"}),(0,d.jsx)("p",{className:"text-xs text-gray-500 mt-0.5",children:"Produkty w promocji"})]})]})})})]})]})})]})}new m}};