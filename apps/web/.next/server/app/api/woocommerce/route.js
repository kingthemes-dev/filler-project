/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/woocommerce/route";
exports.ids = ["app/api/woocommerce/route"];
exports.modules = {

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fwoocommerce%2Froute&page=%2Fapi%2Fwoocommerce%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwoocommerce%2Froute.ts&appDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!":
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fwoocommerce%2Froute&page=%2Fapi%2Fwoocommerce%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwoocommerce%2Froute.ts&appDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=! ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   handler: () => (/* binding */ handler),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   workAsyncStorage: () => (/* binding */ workAsyncStorage),\n/* harmony export */   workUnitAsyncStorage: () => (/* binding */ workUnitAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/route-modules/app-route/module.compiled */ \"(rsc)/../../node_modules/next/dist/server/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/route-kind */ \"(rsc)/../../node_modules/next/dist/server/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/../../node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! next/dist/server/request-meta */ \"(rsc)/../../node_modules/next/dist/server/request-meta.js\");\n/* harmony import */ var next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__);\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! next/dist/server/lib/trace/tracer */ \"(rsc)/../../node_modules/next/dist/server/lib/trace/tracer.js\");\n/* harmony import */ var next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next/dist/shared/lib/router/utils/app-paths */ \"next/dist/shared/lib/router/utils/app-paths\");\n/* harmony import */ var next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__);\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! next/dist/server/base-http/node */ \"(rsc)/../../node_modules/next/dist/server/base-http/node.js\");\n/* harmony import */ var next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__);\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! next/dist/server/web/spec-extension/adapters/next-request */ \"(rsc)/../../node_modules/next/dist/server/web/spec-extension/adapters/next-request.js\");\n/* harmony import */ var next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__);\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! next/dist/server/lib/trace/constants */ \"(rsc)/../../node_modules/next/dist/server/lib/trace/constants.js\");\n/* harmony import */ var next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__);\n/* harmony import */ var next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! next/dist/server/instrumentation/utils */ \"(rsc)/../../node_modules/next/dist/server/instrumentation/utils.js\");\n/* harmony import */ var next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! next/dist/server/send-response */ \"(rsc)/../../node_modules/next/dist/server/send-response.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! next/dist/server/web/utils */ \"(rsc)/../../node_modules/next/dist/server/web/utils.js\");\n/* harmony import */ var next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__);\n/* harmony import */ var next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! next/dist/server/lib/cache-control */ \"(rsc)/../../node_modules/next/dist/server/lib/cache-control.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! next/dist/lib/constants */ \"(rsc)/../../node_modules/next/dist/lib/constants.js\");\n/* harmony import */ var next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13___default = /*#__PURE__*/__webpack_require__.n(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__);\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! next/dist/shared/lib/no-fallback-error.external */ \"next/dist/shared/lib/no-fallback-error.external\");\n/* harmony import */ var next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14___default = /*#__PURE__*/__webpack_require__.n(next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__);\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! next/dist/server/response-cache */ \"(rsc)/../../node_modules/next/dist/server/response-cache/index.js\");\n/* harmony import */ var next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__);\n/* harmony import */ var _Users_kingbrand_Desktop_headless_woo_apps_web_src_app_api_woocommerce_route_ts__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./src/app/api/woocommerce/route.ts */ \"(rsc)/./src/app/api/woocommerce/route.ts\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/woocommerce/route\",\n        pathname: \"/api/woocommerce\",\n        filename: \"route\",\n        bundlePath: \"app/api/woocommerce/route\"\n    },\n    distDir: \".next\" || 0,\n    relativeProjectDir:  false || '',\n    resolvedPagePath: \"/Users/kingbrand/Desktop/headless-woo/apps/web/src/app/api/woocommerce/route.ts\",\n    nextConfigOutput,\n    userland: _Users_kingbrand_Desktop_headless_woo_apps_web_src_app_api_woocommerce_route_ts__WEBPACK_IMPORTED_MODULE_16__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { workAsyncStorage, workUnitAsyncStorage, serverHooks } = routeModule;\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        workAsyncStorage,\n        workUnitAsyncStorage\n    });\n}\n\nasync function handler(req, res, ctx) {\n    var _nextConfig_experimental;\n    let srcPage = \"/api/woocommerce/route\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (false) {} else if (srcPage === '/index') {\n        // we always normalize /index specifically\n        srcPage = '/';\n    }\n    const multiZoneDraftMode = false;\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage,\n        multiZoneDraftMode\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return null;\n    }\n    const { buildId, params, nextConfig, isDraftMode, prerenderManifest, routerServerContext, isOnDemandRevalidate, revalidateOnlyGenerated, resolvedPathname } = prepareResult;\n    const normalizedSrcPage = (0,next_dist_shared_lib_router_utils_app_paths__WEBPACK_IMPORTED_MODULE_5__.normalizeAppPath)(srcPage);\n    let isIsr = Boolean(prerenderManifest.dynamicRoutes[normalizedSrcPage] || prerenderManifest.routes[resolvedPathname]);\n    if (isIsr && !isDraftMode) {\n        const isPrerendered = Boolean(prerenderManifest.routes[resolvedPathname]);\n        const prerenderInfo = prerenderManifest.dynamicRoutes[normalizedSrcPage];\n        if (prerenderInfo) {\n            if (prerenderInfo.fallback === false && !isPrerendered) {\n                throw new next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError();\n            }\n        }\n    }\n    let cacheKey = null;\n    if (isIsr && !routeModule.isDev && !isDraftMode) {\n        cacheKey = resolvedPathname;\n        // ensure /index and / is normalized to one key\n        cacheKey = cacheKey === '/index' ? '/' : cacheKey;\n    }\n    const supportsDynamicResponse = // If we're in development, we always support dynamic HTML\n    routeModule.isDev === true || // If this is not SSG or does not have static paths, then it supports\n    // dynamic HTML.\n    !isIsr;\n    // This is a revalidation request if the request is for a static\n    // page and it is not being resumed from a postponed render and\n    // it is not a dynamic RSC request then it is a revalidation\n    // request.\n    const isRevalidate = isIsr && !supportsDynamicResponse;\n    const method = req.method || 'GET';\n    const tracer = (0,next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.getTracer)();\n    const activeSpan = tracer.getActiveScopeSpan();\n    const context = {\n        params,\n        prerenderManifest,\n        renderOpts: {\n            experimental: {\n                cacheComponents: Boolean(nextConfig.experimental.cacheComponents),\n                authInterrupts: Boolean(nextConfig.experimental.authInterrupts)\n            },\n            supportsDynamicResponse,\n            incrementalCache: (0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'incrementalCache'),\n            cacheLifeProfiles: (_nextConfig_experimental = nextConfig.experimental) == null ? void 0 : _nextConfig_experimental.cacheLife,\n            isRevalidate,\n            waitUntil: ctx.waitUntil,\n            onClose: (cb)=>{\n                res.on('close', cb);\n            },\n            onAfterTaskError: undefined,\n            onInstrumentationRequestError: (error, _request, errorContext)=>routeModule.onRequestError(req, error, errorContext, routerServerContext)\n        },\n        sharedContext: {\n            buildId\n        }\n    };\n    const nodeNextReq = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextRequest(req);\n    const nodeNextRes = new next_dist_server_base_http_node__WEBPACK_IMPORTED_MODULE_6__.NodeNextResponse(res);\n    const nextReq = next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.NextRequestAdapter.fromNodeNextRequest(nodeNextReq, (0,next_dist_server_web_spec_extension_adapters_next_request__WEBPACK_IMPORTED_MODULE_7__.signalFromNodeResponse)(res));\n    try {\n        const invokeRouteModule = async (span)=>{\n            return routeModule.handle(nextReq, context).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        };\n        const handleResponse = async (currentSpan)=>{\n            var _cacheEntry_value;\n            const responseGenerator = async ({ previousCacheEntry })=>{\n                try {\n                    if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isOnDemandRevalidate && revalidateOnlyGenerated && !previousCacheEntry) {\n                        res.statusCode = 404;\n                        // on-demand revalidate always sets this header\n                        res.setHeader('x-nextjs-cache', 'REVALIDATED');\n                        res.end('This page could not be found');\n                        return null;\n                    }\n                    const response = await invokeRouteModule(currentSpan);\n                    req.fetchMetrics = context.renderOpts.fetchMetrics;\n                    let pendingWaitUntil = context.renderOpts.pendingWaitUntil;\n                    // Attempt using provided waitUntil if available\n                    // if it's not we fallback to sendResponse's handling\n                    if (pendingWaitUntil) {\n                        if (ctx.waitUntil) {\n                            ctx.waitUntil(pendingWaitUntil);\n                            pendingWaitUntil = undefined;\n                        }\n                    }\n                    const cacheTags = context.renderOpts.collectedTags;\n                    // If the request is for a static response, we can cache it so long\n                    // as it's not edge.\n                    if (isIsr) {\n                        const blob = await response.blob();\n                        // Copy the headers from the response.\n                        const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.toNodeOutgoingHttpHeaders)(response.headers);\n                        if (cacheTags) {\n                            headers[next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER] = cacheTags;\n                        }\n                        if (!headers['content-type'] && blob.type) {\n                            headers['content-type'] = blob.type;\n                        }\n                        const revalidate = typeof context.renderOpts.collectedRevalidate === 'undefined' || context.renderOpts.collectedRevalidate >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? false : context.renderOpts.collectedRevalidate;\n                        const expire = typeof context.renderOpts.collectedExpire === 'undefined' || context.renderOpts.collectedExpire >= next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.INFINITE_CACHE ? undefined : context.renderOpts.collectedExpire;\n                        // Create the cache entry for the response.\n                        const cacheEntry = {\n                            value: {\n                                kind: next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE,\n                                status: response.status,\n                                body: Buffer.from(await blob.arrayBuffer()),\n                                headers\n                            },\n                            cacheControl: {\n                                revalidate,\n                                expire\n                            }\n                        };\n                        return cacheEntry;\n                    } else {\n                        // send response without caching if not ISR\n                        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, response, context.renderOpts.pendingWaitUntil);\n                        return null;\n                    }\n                } catch (err) {\n                    // if this is a background revalidate we need to report\n                    // the request error here as it won't be bubbled\n                    if (previousCacheEntry == null ? void 0 : previousCacheEntry.isStale) {\n                        await routeModule.onRequestError(req, err, {\n                            routerKind: 'App Router',\n                            routePath: srcPage,\n                            routeType: 'route',\n                            revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                                isRevalidate,\n                                isOnDemandRevalidate\n                            })\n                        }, routerServerContext);\n                    }\n                    throw err;\n                }\n            };\n            const cacheEntry = await routeModule.handleResponse({\n                req,\n                nextConfig,\n                cacheKey,\n                routeKind: next_dist_server_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n                isFallback: false,\n                prerenderManifest,\n                isRoutePPREnabled: false,\n                isOnDemandRevalidate,\n                revalidateOnlyGenerated,\n                responseGenerator,\n                waitUntil: ctx.waitUntil\n            });\n            // we don't create a cacheEntry for ISR\n            if (!isIsr) {\n                return null;\n            }\n            if ((cacheEntry == null ? void 0 : (_cacheEntry_value = cacheEntry.value) == null ? void 0 : _cacheEntry_value.kind) !== next_dist_server_response_cache__WEBPACK_IMPORTED_MODULE_15__.CachedRouteKind.APP_ROUTE) {\n                var _cacheEntry_value1;\n                throw Object.defineProperty(new Error(`Invariant: app-route received invalid cache entry ${cacheEntry == null ? void 0 : (_cacheEntry_value1 = cacheEntry.value) == null ? void 0 : _cacheEntry_value1.kind}`), \"__NEXT_ERROR_CODE\", {\n                    value: \"E701\",\n                    enumerable: false,\n                    configurable: true\n                });\n            }\n            if (!(0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode')) {\n                res.setHeader('x-nextjs-cache', isOnDemandRevalidate ? 'REVALIDATED' : cacheEntry.isMiss ? 'MISS' : cacheEntry.isStale ? 'STALE' : 'HIT');\n            }\n            // Draft mode should never be cached\n            if (isDraftMode) {\n                res.setHeader('Cache-Control', 'private, no-cache, no-store, max-age=0, must-revalidate');\n            }\n            const headers = (0,next_dist_server_web_utils__WEBPACK_IMPORTED_MODULE_11__.fromNodeOutgoingHttpHeaders)(cacheEntry.value.headers);\n            if (!((0,next_dist_server_request_meta__WEBPACK_IMPORTED_MODULE_3__.getRequestMeta)(req, 'minimalMode') && isIsr)) {\n                headers.delete(next_dist_lib_constants__WEBPACK_IMPORTED_MODULE_13__.NEXT_CACHE_TAGS_HEADER);\n            }\n            // If cache control is already set on the response we don't\n            // override it to allow users to customize it via next.config\n            if (cacheEntry.cacheControl && !res.getHeader('Cache-Control') && !headers.get('Cache-Control')) {\n                headers.set('Cache-Control', (0,next_dist_server_lib_cache_control__WEBPACK_IMPORTED_MODULE_12__.getCacheControlHeader)(cacheEntry.cacheControl));\n            }\n            await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(cacheEntry.value.body, {\n                headers,\n                status: cacheEntry.value.status || 200\n            }));\n            return null;\n        };\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await handleResponse(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(next_dist_server_lib_trace_constants__WEBPACK_IMPORTED_MODULE_8__.BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: next_dist_server_lib_trace_tracer__WEBPACK_IMPORTED_MODULE_4__.SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, handleResponse));\n        }\n    } catch (err) {\n        // if we aren't wrapped by base-server handle here\n        if (!activeSpan && !(err instanceof next_dist_shared_lib_no_fallback_error_external__WEBPACK_IMPORTED_MODULE_14__.NoFallbackError)) {\n            await routeModule.onRequestError(req, err, {\n                routerKind: 'App Router',\n                routePath: normalizedSrcPage,\n                routeType: 'route',\n                revalidateReason: (0,next_dist_server_instrumentation_utils__WEBPACK_IMPORTED_MODULE_9__.getRevalidateReason)({\n                    isRevalidate,\n                    isOnDemandRevalidate\n                })\n            });\n        }\n        // rethrow so that we can handle serving error page\n        // If this is during static generation, throw the error again.\n        if (isIsr) throw err;\n        // Otherwise, send a 500 response.\n        await (0,next_dist_server_send_response__WEBPACK_IMPORTED_MODULE_10__.sendResponse)(nodeNextReq, nodeNextRes, new Response(null, {\n            status: 500\n        }));\n        return null;\n    }\n}\n\n//# sourceMappingURL=app-route.js.map\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1hcHAtbG9hZGVyL2luZGV4LmpzP25hbWU9YXBwJTJGYXBpJTJGd29vY29tbWVyY2UlMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRndvb2NvbW1lcmNlJTJGcm91dGUmYXBwUGF0aHM9JnBhZ2VQYXRoPXByaXZhdGUtbmV4dC1hcHAtZGlyJTJGYXBpJTJGd29vY29tbWVyY2UlMkZyb3V0ZS50cyZhcHBEaXI9JTJGVXNlcnMlMkZraW5nYnJhbmQlMkZEZXNrdG9wJTJGaGVhZGxlc3Mtd29vJTJGYXBwcyUyRndlYiUyRnNyYyUyRmFwcCZwYWdlRXh0ZW5zaW9ucz10c3gmcGFnZUV4dGVuc2lvbnM9dHMmcGFnZUV4dGVuc2lvbnM9anN4JnBhZ2VFeHRlbnNpb25zPWpzJnJvb3REaXI9JTJGVXNlcnMlMkZraW5nYnJhbmQlMkZEZXNrdG9wJTJGaGVhZGxlc3Mtd29vJTJGYXBwcyUyRndlYiZpc0Rldj10cnVlJnRzY29uZmlnUGF0aD10c2NvbmZpZy5qc29uJmJhc2VQYXRoPSZhc3NldFByZWZpeD0mbmV4dENvbmZpZ091dHB1dD0mcHJlZmVycmVkUmVnaW9uPSZtaWRkbGV3YXJlQ29uZmlnPWUzMCUzRCZpc0dsb2JhbE5vdEZvdW5kRW5hYmxlZD0hIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQStGO0FBQ3ZDO0FBQ3FCO0FBQ2Q7QUFDUztBQUNPO0FBQ0s7QUFDbUM7QUFDakQ7QUFDTztBQUNmO0FBQ3NDO0FBQ3pCO0FBQ007QUFDQztBQUNoQjtBQUMwQztBQUM1RztBQUNBO0FBQ0E7QUFDQSx3QkFBd0IseUdBQW1CO0FBQzNDO0FBQ0EsY0FBYyxrRUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxhQUFhLE9BQW9DLElBQUksQ0FBRTtBQUN2RCx3QkFBd0IsTUFBdUM7QUFDL0Q7QUFDQTtB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QjtBQUNsRTtBQUNBLGtCQUFrQiw2RUFBWTtBQUM5QjtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDViw2RUFBNkUsZ0ZBQWM7QUFDM0YsaUNBQWlDLFFBQVEsRUFBRSxRQUFRO0FBQ25ELDBCQUEwQix1RUFBUTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQjtBQUNBLE1BQU07QUFDTjtBQUNBLDRDQUE0Qyw2RkFBZTtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQywyRkFBbUI7QUFDckQ7QUFDQTtBQUNBLGlCQUFpQjtBQUNqQixhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsNkVBQVk7QUFDMUI7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBOztBQUVBIiwic291cmNlcyI6WyIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXBwUm91dGVSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3JvdXRlLW1vZHVsZXMvYXBwLXJvdXRlL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0IHsgZ2V0UmVxdWVzdE1ldGEgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9yZXF1ZXN0LW1ldGFcIjtcbmltcG9ydCB7IGdldFRyYWNlciwgU3BhbktpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9saWIvdHJhY2UvdHJhY2VyXCI7XG5pbXBvcnQgeyBub3JtYWxpemVBcHBQYXRoIH0gZnJvbSBcIm5leHQvZGlzdC9zaGFyZWQvbGliL3JvdXRlci91dGlscy9hcHAtcGF0aHNcIjtcbmltcG9ydCB7IE5vZGVOZXh0UmVxdWVzdCwgTm9kZU5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Jhc2UtaHR0cC9ub2RlXCI7XG5pbXBvcnQgeyBOZXh0UmVxdWVzdEFkYXB0ZXIsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci93ZWIvc3BlYy1leHRlbnNpb24vYWRhcHRlcnMvbmV4dC1yZXF1ZXN0XCI7XG5pbXBvcnQgeyBCYXNlU2VydmVyU3BhbiB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi90cmFjZS9jb25zdGFudHNcIjtcbmltcG9ydCB7IGdldFJldmFsaWRhdGVSZWFzb24gfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9pbnN0cnVtZW50YXRpb24vdXRpbHNcIjtcbmltcG9ydCB7IHNlbmRSZXNwb25zZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3NlbmQtcmVzcG9uc2VcIjtcbmltcG9ydCB7IGZyb21Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycywgdG9Ob2RlT3V0Z29pbmdIdHRwSGVhZGVycyB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3dlYi91dGlsc1wiO1xuaW1wb3J0IHsgZ2V0Q2FjaGVDb250cm9sSGVhZGVyIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvbGliL2NhY2hlLWNvbnRyb2xcIjtcbmltcG9ydCB7IElORklOSVRFX0NBQ0hFLCBORVhUX0NBQ0hFX1RBR1NfSEVBREVSIH0gZnJvbSBcIm5leHQvZGlzdC9saWIvY29uc3RhbnRzXCI7XG5pbXBvcnQgeyBOb0ZhbGxiYWNrRXJyb3IgfSBmcm9tIFwibmV4dC9kaXN0L3NoYXJlZC9saWIvbm8tZmFsbGJhY2stZXJyb3IuZXh0ZXJuYWxcIjtcbmltcG9ydCB7IENhY2hlZFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL3Jlc3BvbnNlLWNhY2hlXCI7XG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiL1VzZXJzL2tpbmdicmFuZC9EZXNrdG9wL2hlYWRsZXNzLXdvby9hcHBzL3dlYi9zcmMvYXBwL2FwaS93b29jb21tZXJjZS9yb3V0ZS50c1wiO1xuLy8gV2UgaW5qZWN0IHRoZSBuZXh0Q29uZmlnT3V0cHV0IGhlcmUgc28gdGhhdCB3ZSBjYW4gdXNlIHRoZW0gaW4gdGhlIHJvdXRlXG4vLyBtb2R1bGUuXG5jb25zdCBuZXh0Q29uZmlnT3V0cHV0ID0gXCJcIlxuY29uc3Qgcm91dGVNb2R1bGUgPSBuZXcgQXBwUm91dGVSb3V0ZU1vZHVsZSh7XG4gICAgZGVmaW5pdGlvbjoge1xuICAgICAgICBraW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICBwYWdlOiBcIi9hcGkvd29vY29tbWVyY2Uvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS93b29jb21tZXJjZVwiLFxuICAgICAgICBmaWxlbmFtZTogXCJyb3V0ZVwiLFxuICAgICAgICBidW5kbGVQYXRoOiBcImFwcC9hcGkvd29vY29tbWVyY2Uvcm91dGVcIlxuICAgIH0sXG4gICAgZGlzdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX0RJU1RfRElSIHx8ICcnLFxuICAgIHJlbGF0aXZlUHJvamVjdERpcjogcHJvY2Vzcy5lbnYuX19ORVhUX1JFTEFUSVZFX1BST0pFQ1RfRElSIHx8ICcnLFxuICAgIHJlc29sdmVkUGFnZVBhdGg6IFwiL1VzZXJzL2tpbmdicmFuZC9EZXNrdG9wL2hlYWRsZXNzLXdvby9hcHBzL3dlYi9zcmMvYXBwL2FwaS93b29jb21tZXJjZS9yb3V0ZS50c1wiLFxuICAgIG5leHRDb25maWdPdXRwdXQsXG4gICAgdXNlcmxhbmRcbn0pO1xuLy8gUHVsbCBvdXQgdGhlIGV4cG9ydHMgdGhhdCB3ZSBuZWVkIHRvIGV4cG9zZSBmcm9tIHRoZSBtb2R1bGUuIFRoaXMgc2hvdWxkXG4vLyBiZSBlbGltaW5hdGVkIHdoZW4gd2UndmUgbW92ZWQgdGhlIG90aGVyIHJvdXRlcyB0byB0aGUgbmV3IGZvcm1hdC4gVGhlc2Vcbi8vIGFyZSB1c2VkIHRvIGhvb2sgaW50byB0aGUgcm91dGUuXG5jb25zdCB7IHdvcmtBc3luY1N0b3JhZ2UsIHdvcmtVbml0QXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcyB9ID0gcm91dGVNb2R1bGU7XG5mdW5jdGlvbiBwYXRjaEZldGNoKCkge1xuICAgIHJldHVybiBfcGF0Y2hGZXRjaCh7XG4gICAgICAgIHdvcmtBc3luY1N0b3JhZ2UsXG4gICAgICAgIHdvcmtVbml0QXN5bmNTdG9yYWdlXG4gICAgfSk7XG59XG5leHBvcnQgeyByb3V0ZU1vZHVsZSwgd29ya0FzeW5jU3RvcmFnZSwgd29ya1VuaXRBc3luY1N0b3JhZ2UsIHNlcnZlckhvb2tzLCBwYXRjaEZldGNoLCAgfTtcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzLCBjdHgpIHtcbiAgICB2YXIgX25leHRDb25maWdfZXhwZXJpbWVudGFsO1xuICAgIGxldCBzcmNQYWdlID0gXCIvYXBpL3dvb2NvbW1lcmNlL3JvdXRlXCI7XG4gICAgLy8gdHVyYm9wYWNrIGRvZXNuJ3Qgbm9ybWFsaXplIGAvaW5kZXhgIGluIHRoZSBwYWdlIG5hbWVcbiAgICAvLyBzbyB3ZSBuZWVkIHRvIHRvIHByb2Nlc3MgZHluYW1pYyByb3V0ZXMgcHJvcGVybHlcbiAgICAvLyBUT0RPOiBmaXggdHVyYm9wYWNrIHByb3ZpZGluZyBkaWZmZXJpbmcgdmFsdWUgZnJvbSB3ZWJwYWNrXG4gICAgaWYgKHByb2Nlc3MuZW52LlRVUkJPUEFDSykge1xuICAgICAgICBzcmNQYWdlID0gc3JjUGFnZS5yZXBsYWNlKC9cXC9pbmRleCQvLCAnJykgfHwgJy8nO1xuICAgIH0gZWxzZSBpZiAoc3JjUGFnZSA9PT0gJy9pbmRleCcpIHtcbiAgICAgICAgLy8gd2UgYWx3YXlzIG5vcm1hbGl6ZSAvaW5kZXggc3BlY2lmaWNhbGx5XG4gICAgICAgIHNyY1BhZ2UgPSAnLyc7XG4gICAgfVxuICAgIGNvbnN0IG11bHRpWm9uZURyYWZ0TW9kZSA9IHByb2Nlc3MuZW52Ll9fTkVYVF9NVUxUSV9aT05FX0RSQUZUX01PREU7XG4gICAgY29uc3QgcHJlcGFyZVJlc3VsdCA9IGF3YWl0IHJvdXRlTW9kdWxlLnByZXBhcmUocmVxLCByZXMsIHtcbiAgICAgICAgc3JjUGFnZSxcbiAgICAgICAgbXVsdGlab25lRHJhZnRNb2RlXG4gICAgfSk7XG4gICAgaWYgKCFwcmVwYXJlUmVzdWx0KSB7XG4gICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDAwO1xuICAgICAgICByZXMuZW5kKCdCYWQgUmVxdWVzdCcpO1xuICAgICAgICBjdHgud2FpdFVudGlsID09IG51bGwgPyB2b2lkIDAgOiBjdHgud2FpdFVudGlsLmNhbGwoY3R4LCBQcm9taXNlLnJlc29sdmUoKSk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICBjb25zdCB7IGJ1aWxkSWQsIHBhcmFtcywgbmV4dENvbmZpZywgaXNEcmFmdE1vZGUsIHByZXJlbmRlck1hbmlmZXN0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0LCBpc09uRGVtYW5kUmV2YWxpZGF0ZSwgcmV2YWxpZGF0ZU9ubHlHZW5lcmF0ZWQsIHJlc29sdmVkUGF0aG5hbWUgfSA9IHByZXBhcmVSZXN1bHQ7XG4gICAgY29uc3Qgbm9ybWFsaXplZFNyY1BhZ2UgPSBub3JtYWxpemVBcHBQYXRoKHNyY1BhZ2UpO1xuICAgIGxldCBpc0lzciA9IEJvb2xlYW4ocHJlcmVuZGVyTWFuaWZlc3QuZHluYW1pY1JvdXRlc1tub3JtYWxpemVkU3JjUGFnZV0gfHwgcHJlcmVuZGVyTWFuaWZlc3Qucm91dGVzW3Jlc29sdmVkUGF0aG5hbWVdKTtcbiAgICBpZiAoaXNJc3IgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNvbnN0IGlzUHJlcmVuZGVyZWQgPSBCb29sZWFuKHByZXJlbmRlck1hbmlmZXN0LnJvdXRlc1tyZXNvbHZlZFBhdGhuYW1lXSk7XG4gICAgICAgIGNvbnN0IHByZXJlbmRlckluZm8gPSBwcmVyZW5kZXJNYW5pZmVzdC5keW5hbWljUm91dGVzW25vcm1hbGl6ZWRTcmNQYWdlXTtcbiAgICAgICAgaWYgKHByZXJlbmRlckluZm8pIHtcbiAgICAgICAgICAgIGlmIChwcmVyZW5kZXJJbmZvLmZhbGxiYWNrID09PSBmYWxzZSAmJiAhaXNQcmVyZW5kZXJlZCkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBOb0ZhbGxiYWNrRXJyb3IoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBsZXQgY2FjaGVLZXkgPSBudWxsO1xuICAgIGlmIChpc0lzciAmJiAhcm91dGVNb2R1bGUuaXNEZXYgJiYgIWlzRHJhZnRNb2RlKSB7XG4gICAgICAgIGNhY2hlS2V5ID0gcmVzb2x2ZWRQYXRobmFtZTtcbiAgICAgICAgLy8gZW5zdXJlIC9pbmRleCBhbmQgLyBpcyBub3JtYWxpemVkIHRvIG9uZSBrZXlcbiAgICAgICAgY2FjaGVLZXkgPSBjYWNoZUtleSA9PT0gJy9pbmRleCcgPyAnLycgOiBjYWNoZUtleTtcbiAgICB9XG4gICAgY29uc3Qgc3VwcG9ydHNEeW5hbWljUmVzcG9uc2UgPSAvLyBJZiB3ZSdyZSBpbiBkZXZlbG9wbWVudCwgd2UgYWx3YXlzIHN1cHBvcnQgZHluYW1pYyBIVE1MXG4gICAgcm91dGVNb2R1bGUuaXNEZXYgPT09IHRydWUgfHwgLy8gSWYgdGhpcyBpcyBub3QgU1NHIG9yIGRvZXMgbm90IGhhdmUgc3RhdGljIHBhdGhzLCB0aGVuIGl0IHN1cHBvcnRzXG4gICAgLy8gZHluYW1pYyBIVE1MLlxuICAgICFpc0lzcjtcbiAgICAvLyBUaGlzIGlzIGEgcmV2YWxpZGF0aW9uIHJlcXVlc3QgaWYgdGhlIHJlcXVlc3QgaXMgZm9yIGEgc3RhdGljXG4gICAgLy8gcGFnZSBhbmQgaXQgaXMgbm90IGJlaW5nIHJlc3VtZWQgZnJvbSBhIHBvc3Rwb25lZCByZW5kZXIgYW5kXG4gICAgLy8gaXQgaXMgbm90IGEgZHluYW1pYyBSU0MgcmVxdWVzdCB0aGVuIGl0IGlzIGEgcmV2YWxpZGF0aW9uXG4gICAgLy8gcmVxdWVzdC5cbiAgICBjb25zdCBpc1JldmFsaWRhdGUgPSBpc0lzciAmJiAhc3VwcG9ydHNEeW5hbWljUmVzcG9uc2U7XG4gICAgY29uc3QgbWV0aG9kID0gcmVxLm1ldGhvZCB8fCAnR0VUJztcbiAgICBjb25zdCB0cmFjZXIgPSBnZXRUcmFjZXIoKTtcbiAgICBjb25zdCBhY3RpdmVTcGFuID0gdHJhY2VyLmdldEFjdGl2ZVNjb3BlU3BhbigpO1xuICAgIGNvbnN0IGNvbnRleHQgPSB7XG4gICAgICAgIHBhcmFtcyxcbiAgICAgICAgcHJlcmVuZGVyTWFuaWZlc3QsXG4gICAgICAgIHJlbmRlck9wdHM6IHtcbiAgICAgICAgICAgIGV4cGVyaW1lbnRhbDoge1xuICAgICAgICAgICAgICAgIGNhY2hlQ29tcG9uZW50czogQm9vbGVhbihuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbC5jYWNoZUNvbXBvbmVudHMpLFxuICAgICAgICAgICAgICAgIGF1dGhJbnRlcnJ1cHRzOiBCb29sZWFuKG5leHRDb25maWcuZXhwZXJpbWVudGFsLmF1dGhJbnRlcnJ1cHRzKVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHN1cHBvcnRzRHluYW1pY1Jlc3BvbnNlLFxuICAgICAgICAgICAgaW5jcmVtZW50YWxDYWNoZTogZ2V0UmVxdWVzdE1ldGEocmVxLCAnaW5jcmVtZW50YWxDYWNoZScpLFxuICAgICAgICAgICAgY2FjaGVMaWZlUHJvZmlsZXM6IChfbmV4dENvbmZpZ19leHBlcmltZW50YWwgPSBuZXh0Q29uZmlnLmV4cGVyaW1lbnRhbCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9uZXh0Q29uZmlnX2V4cGVyaW1lbnRhbC5jYWNoZUxpZmUsXG4gICAgICAgICAgICBpc1JldmFsaWRhdGUsXG4gICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWwsXG4gICAgICAgICAgICBvbkNsb3NlOiAoY2IpPT57XG4gICAgICAgICAgICAgICAgcmVzLm9uKCdjbG9zZScsIGNiKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBvbkFmdGVyVGFza0Vycm9yOiB1bmRlZmluZWQsXG4gICAgICAgICAgICBvbkluc3RydW1lbnRhdGlvblJlcXVlc3RFcnJvcjogKGVycm9yLCBfcmVxdWVzdCwgZXJyb3JDb250ZXh0KT0+cm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnJvciwgZXJyb3JDb250ZXh0LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KVxuICAgICAgICB9LFxuICAgICAgICBzaGFyZWRDb250ZXh0OiB7XG4gICAgICAgICAgICBidWlsZElkXG4gICAgICAgIH1cbiAgICB9O1xuICAgIGNvbnN0IG5vZGVOZXh0UmVxID0gbmV3IE5vZGVOZXh0UmVxdWVzdChyZXEpO1xuICAgIGNvbnN0IG5vZGVOZXh0UmVzID0gbmV3IE5vZGVOZXh0UmVzcG9uc2UocmVzKTtcbiAgICBjb25zdCBuZXh0UmVxID0gTmV4dFJlcXVlc3RBZGFwdGVyLmZyb21Ob2RlTmV4dFJlcXVlc3Qobm9kZU5leHRSZXEsIHNpZ25hbEZyb21Ob2RlUmVzcG9uc2UocmVzKSk7XG4gICAgdHJ5IHtcbiAgICAgICAgY29uc3QgaW52b2tlUm91dGVNb2R1bGUgPSBhc3luYyAoc3Bhbik9PntcbiAgICAgICAgICAgIHJldHVybiByb3V0ZU1vZHVsZS5oYW5kbGUobmV4dFJlcSwgY29udGV4dCkuZmluYWxseSgoKT0+e1xuICAgICAgICAgICAgICAgIGlmICghc3BhbikgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHNwYW4uc2V0QXR0cmlidXRlcyh7XG4gICAgICAgICAgICAgICAgICAgICdodHRwLnN0YXR1c19jb2RlJzogcmVzLnN0YXR1c0NvZGUsXG4gICAgICAgICAgICAgICAgICAgICduZXh0LnJzYyc6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgY29uc3Qgcm9vdFNwYW5BdHRyaWJ1dGVzID0gdHJhY2VyLmdldFJvb3RTcGFuQXR0cmlidXRlcygpO1xuICAgICAgICAgICAgICAgIC8vIFdlIHdlcmUgdW5hYmxlIHRvIGdldCBhdHRyaWJ1dGVzLCBwcm9iYWJseSBPVEVMIGlzIG5vdCBlbmFibGVkXG4gICAgICAgICAgICAgICAgaWYgKCFyb290U3BhbkF0dHJpYnV0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAocm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKSAhPT0gQmFzZVNlcnZlclNwYW4uaGFuZGxlUmVxdWVzdCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLndhcm4oYFVuZXhwZWN0ZWQgcm9vdCBzcGFuIHR5cGUgJyR7cm9vdFNwYW5BdHRyaWJ1dGVzLmdldCgnbmV4dC5zcGFuX3R5cGUnKX0nLiBQbGVhc2UgcmVwb3J0IHRoaXMgTmV4dC5qcyBpc3N1ZSBodHRwczovL2dpdGh1Yi5jb20vdmVyY2VsL25leHQuanNgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb25zdCByb3V0ZSA9IHJvb3RTcGFuQXR0cmlidXRlcy5nZXQoJ25leHQucm91dGUnKTtcbiAgICAgICAgICAgICAgICBpZiAocm91dGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmFtZSA9IGAke21ldGhvZH0gJHtyb3V0ZX1gO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnNldEF0dHJpYnV0ZXMoe1xuICAgICAgICAgICAgICAgICAgICAgICAgJ25leHQucm91dGUnOiByb3V0ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICdodHRwLnJvdXRlJzogcm91dGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAnbmV4dC5zcGFuX25hbWUnOiBuYW1lXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICBzcGFuLnVwZGF0ZU5hbWUobmFtZSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbi51cGRhdGVOYW1lKGAke21ldGhvZH0gJHtyZXEudXJsfWApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBoYW5kbGVSZXNwb25zZSA9IGFzeW5jIChjdXJyZW50U3Bhbik9PntcbiAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTtcbiAgICAgICAgICAgIGNvbnN0IHJlc3BvbnNlR2VuZXJhdG9yID0gYXN5bmMgKHsgcHJldmlvdXNDYWNoZUVudHJ5IH0pPT57XG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFnZXRSZXF1ZXN0TWV0YShyZXEsICdtaW5pbWFsTW9kZScpICYmIGlzT25EZW1hbmRSZXZhbGlkYXRlICYmIHJldmFsaWRhdGVPbmx5R2VuZXJhdGVkICYmICFwcmV2aW91c0NhY2hlRW50cnkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zdGF0dXNDb2RlID0gNDA0O1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gb24tZGVtYW5kIHJldmFsaWRhdGUgYWx3YXlzIHNldHMgdGhpcyBoZWFkZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgJ1JFVkFMSURBVEVEJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXMuZW5kKCdUaGlzIHBhZ2UgY291bGQgbm90IGJlIGZvdW5kJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGludm9rZVJvdXRlTW9kdWxlKGN1cnJlbnRTcGFuKTtcbiAgICAgICAgICAgICAgICAgICAgcmVxLmZldGNoTWV0cmljcyA9IGNvbnRleHQucmVuZGVyT3B0cy5mZXRjaE1ldHJpY3M7XG4gICAgICAgICAgICAgICAgICAgIGxldCBwZW5kaW5nV2FpdFVudGlsID0gY29udGV4dC5yZW5kZXJPcHRzLnBlbmRpbmdXYWl0VW50aWw7XG4gICAgICAgICAgICAgICAgICAgIC8vIEF0dGVtcHQgdXNpbmcgcHJvdmlkZWQgd2FpdFVudGlsIGlmIGF2YWlsYWJsZVxuICAgICAgICAgICAgICAgICAgICAvLyBpZiBpdCdzIG5vdCB3ZSBmYWxsYmFjayB0byBzZW5kUmVzcG9uc2UncyBoYW5kbGluZ1xuICAgICAgICAgICAgICAgICAgICBpZiAocGVuZGluZ1dhaXRVbnRpbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGN0eC53YWl0VW50aWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdHgud2FpdFVudGlsKHBlbmRpbmdXYWl0VW50aWwpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBlbmRpbmdXYWl0VW50aWwgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVUYWdzID0gY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFRhZ3M7XG4gICAgICAgICAgICAgICAgICAgIC8vIElmIHRoZSByZXF1ZXN0IGlzIGZvciBhIHN0YXRpYyByZXNwb25zZSwgd2UgY2FuIGNhY2hlIGl0IHNvIGxvbmdcbiAgICAgICAgICAgICAgICAgICAgLy8gYXMgaXQncyBub3QgZWRnZS5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGlzSXNyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBibG9iID0gYXdhaXQgcmVzcG9uc2UuYmxvYigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ29weSB0aGUgaGVhZGVycyBmcm9tIHRoZSByZXNwb25zZS5cbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSB0b05vZGVPdXRnb2luZ0h0dHBIZWFkZXJzKHJlc3BvbnNlLmhlYWRlcnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGNhY2hlVGFncykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbTkVYVF9DQUNIRV9UQUdTX0hFQURFUl0gPSBjYWNoZVRhZ3M7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoIWhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddICYmIGJsb2IudHlwZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhlYWRlcnNbJ2NvbnRlbnQtdHlwZSddID0gYmxvYi50eXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgcmV2YWxpZGF0ZSA9IHR5cGVvZiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkUmV2YWxpZGF0ZSA9PT0gJ3VuZGVmaW5lZCcgfHwgY29udGV4dC5yZW5kZXJPcHRzLmNvbGxlY3RlZFJldmFsaWRhdGUgPj0gSU5GSU5JVEVfQ0FDSEUgPyBmYWxzZSA6IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRSZXZhbGlkYXRlO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZXhwaXJlID0gdHlwZW9mIGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmUgPT09ICd1bmRlZmluZWQnIHx8IGNvbnRleHQucmVuZGVyT3B0cy5jb2xsZWN0ZWRFeHBpcmUgPj0gSU5GSU5JVEVfQ0FDSEUgPyB1bmRlZmluZWQgOiBjb250ZXh0LnJlbmRlck9wdHMuY29sbGVjdGVkRXhwaXJlO1xuICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ3JlYXRlIHRoZSBjYWNoZSBlbnRyeSBmb3IgdGhlIHJlc3BvbnNlLlxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2FjaGVFbnRyeSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YWx1ZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBraW5kOiBDYWNoZWRSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYm9keTogQnVmZmVyLmZyb20oYXdhaXQgYmxvYi5hcnJheUJ1ZmZlcigpKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGVDb250cm9sOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldmFsaWRhdGUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4cGlyZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2FjaGVFbnRyeTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlbmQgcmVzcG9uc2Ugd2l0aG91dCBjYWNoaW5nIGlmIG5vdCBJU1JcbiAgICAgICAgICAgICAgICAgICAgICAgIGF3YWl0IHNlbmRSZXNwb25zZShub2RlTmV4dFJlcSwgbm9kZU5leHRSZXMsIHJlc3BvbnNlLCBjb250ZXh0LnJlbmRlck9wdHMucGVuZGluZ1dhaXRVbnRpbCk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICAvLyBpZiB0aGlzIGlzIGEgYmFja2dyb3VuZCByZXZhbGlkYXRlIHdlIG5lZWQgdG8gcmVwb3J0XG4gICAgICAgICAgICAgICAgICAgIC8vIHRoZSByZXF1ZXN0IGVycm9yIGhlcmUgYXMgaXQgd29uJ3QgYmUgYnViYmxlZFxuICAgICAgICAgICAgICAgICAgICBpZiAocHJldmlvdXNDYWNoZUVudHJ5ID09IG51bGwgPyB2b2lkIDAgOiBwcmV2aW91c0NhY2hlRW50cnkuaXNTdGFsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgcm91dGVNb2R1bGUub25SZXF1ZXN0RXJyb3IocmVxLCBlcnIsIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByb3V0ZXJLaW5kOiAnQXBwIFJvdXRlcicsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcm91dGVQYXRoOiBzcmNQYWdlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICB9LCByb3V0ZXJTZXJ2ZXJDb250ZXh0KTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlRW50cnkgPSBhd2FpdCByb3V0ZU1vZHVsZS5oYW5kbGVSZXNwb25zZSh7XG4gICAgICAgICAgICAgICAgcmVxLFxuICAgICAgICAgICAgICAgIG5leHRDb25maWcsXG4gICAgICAgICAgICAgICAgY2FjaGVLZXksXG4gICAgICAgICAgICAgICAgcm91dGVLaW5kOiBSb3V0ZUtpbmQuQVBQX1JPVVRFLFxuICAgICAgICAgICAgICAgIGlzRmFsbGJhY2s6IGZhbHNlLFxuICAgICAgICAgICAgICAgIHByZXJlbmRlck1hbmlmZXN0LFxuICAgICAgICAgICAgICAgIGlzUm91dGVQUFJFbmFibGVkOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZSxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlT25seUdlbmVyYXRlZCxcbiAgICAgICAgICAgICAgICByZXNwb25zZUdlbmVyYXRvcixcbiAgICAgICAgICAgICAgICB3YWl0VW50aWw6IGN0eC53YWl0VW50aWxcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgLy8gd2UgZG9uJ3QgY3JlYXRlIGEgY2FjaGVFbnRyeSBmb3IgSVNSXG4gICAgICAgICAgICBpZiAoIWlzSXNyKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoKGNhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZSA9IGNhY2hlRW50cnkudmFsdWUpID09IG51bGwgPyB2b2lkIDAgOiBfY2FjaGVFbnRyeV92YWx1ZS5raW5kKSAhPT0gQ2FjaGVkUm91dGVLaW5kLkFQUF9ST1VURSkge1xuICAgICAgICAgICAgICAgIHZhciBfY2FjaGVFbnRyeV92YWx1ZTE7XG4gICAgICAgICAgICAgICAgdGhyb3cgT2JqZWN0LmRlZmluZVByb3BlcnR5KG5ldyBFcnJvcihgSW52YXJpYW50OiBhcHAtcm91dGUgcmVjZWl2ZWQgaW52YWxpZCBjYWNoZSBlbnRyeSAke2NhY2hlRW50cnkgPT0gbnVsbCA/IHZvaWQgMCA6IChfY2FjaGVFbnRyeV92YWx1ZTEgPSBjYWNoZUVudHJ5LnZhbHVlKSA9PSBudWxsID8gdm9pZCAwIDogX2NhY2hlRW50cnlfdmFsdWUxLmtpbmR9YCksIFwiX19ORVhUX0VSUk9SX0NPREVcIiwge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogXCJFNzAxXCIsXG4gICAgICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWVcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICghZ2V0UmVxdWVzdE1ldGEocmVxLCAnbWluaW1hbE1vZGUnKSkge1xuICAgICAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ3gtbmV4dGpzLWNhY2hlJywgaXNPbkRlbWFuZFJldmFsaWRhdGUgPyAnUkVWQUxJREFURUQnIDogY2FjaGVFbnRyeS5pc01pc3MgPyAnTUlTUycgOiBjYWNoZUVudHJ5LmlzU3RhbGUgPyAnU1RBTEUnIDogJ0hJVCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gRHJhZnQgbW9kZSBzaG91bGQgbmV2ZXIgYmUgY2FjaGVkXG4gICAgICAgICAgICBpZiAoaXNEcmFmdE1vZGUpIHtcbiAgICAgICAgICAgICAgICByZXMuc2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJywgJ3ByaXZhdGUsIG5vLWNhY2hlLCBuby1zdG9yZSwgbWF4LWFnZT0wLCBtdXN0LXJldmFsaWRhdGUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNvbnN0IGhlYWRlcnMgPSBmcm9tTm9kZU91dGdvaW5nSHR0cEhlYWRlcnMoY2FjaGVFbnRyeS52YWx1ZS5oZWFkZXJzKTtcbiAgICAgICAgICAgIGlmICghKGdldFJlcXVlc3RNZXRhKHJlcSwgJ21pbmltYWxNb2RlJykgJiYgaXNJc3IpKSB7XG4gICAgICAgICAgICAgICAgaGVhZGVycy5kZWxldGUoTkVYVF9DQUNIRV9UQUdTX0hFQURFUik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJZiBjYWNoZSBjb250cm9sIGlzIGFscmVhZHkgc2V0IG9uIHRoZSByZXNwb25zZSB3ZSBkb24ndFxuICAgICAgICAgICAgLy8gb3ZlcnJpZGUgaXQgdG8gYWxsb3cgdXNlcnMgdG8gY3VzdG9taXplIGl0IHZpYSBuZXh0LmNvbmZpZ1xuICAgICAgICAgICAgaWYgKGNhY2hlRW50cnkuY2FjaGVDb250cm9sICYmICFyZXMuZ2V0SGVhZGVyKCdDYWNoZS1Db250cm9sJykgJiYgIWhlYWRlcnMuZ2V0KCdDYWNoZS1Db250cm9sJykpIHtcbiAgICAgICAgICAgICAgICBoZWFkZXJzLnNldCgnQ2FjaGUtQ29udHJvbCcsIGdldENhY2hlQ29udHJvbEhlYWRlcihjYWNoZUVudHJ5LmNhY2hlQ29udHJvbCkpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgbmV3IFJlc3BvbnNlKGNhY2hlRW50cnkudmFsdWUuYm9keSwge1xuICAgICAgICAgICAgICAgIGhlYWRlcnMsXG4gICAgICAgICAgICAgICAgc3RhdHVzOiBjYWNoZUVudHJ5LnZhbHVlLnN0YXR1cyB8fCAyMDBcbiAgICAgICAgICAgIH0pKTtcbiAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9O1xuICAgICAgICAvLyBUT0RPOiBhY3RpdmVTcGFuIGNvZGUgcGF0aCBpcyBmb3Igd2hlbiB3cmFwcGVkIGJ5XG4gICAgICAgIC8vIG5leHQtc2VydmVyIGNhbiBiZSByZW1vdmVkIHdoZW4gdGhpcyBpcyBubyBsb25nZXIgdXNlZFxuICAgICAgICBpZiAoYWN0aXZlU3Bhbikge1xuICAgICAgICAgICAgYXdhaXQgaGFuZGxlUmVzcG9uc2UoYWN0aXZlU3Bhbik7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBhd2FpdCB0cmFjZXIud2l0aFByb3BhZ2F0ZWRDb250ZXh0KHJlcS5oZWFkZXJzLCAoKT0+dHJhY2VyLnRyYWNlKEJhc2VTZXJ2ZXJTcGFuLmhhbmRsZVJlcXVlc3QsIHtcbiAgICAgICAgICAgICAgICAgICAgc3Bhbk5hbWU6IGAke21ldGhvZH0gJHtyZXEudXJsfWAsXG4gICAgICAgICAgICAgICAgICAgIGtpbmQ6IFNwYW5LaW5kLlNFUlZFUixcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAubWV0aG9kJzogbWV0aG9kLFxuICAgICAgICAgICAgICAgICAgICAgICAgJ2h0dHAudGFyZ2V0JzogcmVxLnVybFxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSwgaGFuZGxlUmVzcG9uc2UpKTtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAvLyBpZiB3ZSBhcmVuJ3Qgd3JhcHBlZCBieSBiYXNlLXNlcnZlciBoYW5kbGUgaGVyZVxuICAgICAgICBpZiAoIWFjdGl2ZVNwYW4gJiYgIShlcnIgaW5zdGFuY2VvZiBOb0ZhbGxiYWNrRXJyb3IpKSB7XG4gICAgICAgICAgICBhd2FpdCByb3V0ZU1vZHVsZS5vblJlcXVlc3RFcnJvcihyZXEsIGVyciwge1xuICAgICAgICAgICAgICAgIHJvdXRlcktpbmQ6ICdBcHAgUm91dGVyJyxcbiAgICAgICAgICAgICAgICByb3V0ZVBhdGg6IG5vcm1hbGl6ZWRTcmNQYWdlLFxuICAgICAgICAgICAgICAgIHJvdXRlVHlwZTogJ3JvdXRlJyxcbiAgICAgICAgICAgICAgICByZXZhbGlkYXRlUmVhc29uOiBnZXRSZXZhbGlkYXRlUmVhc29uKHtcbiAgICAgICAgICAgICAgICAgICAgaXNSZXZhbGlkYXRlLFxuICAgICAgICAgICAgICAgICAgICBpc09uRGVtYW5kUmV2YWxpZGF0ZVxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICAvLyByZXRocm93IHNvIHRoYXQgd2UgY2FuIGhhbmRsZSBzZXJ2aW5nIGVycm9yIHBhZ2VcbiAgICAgICAgLy8gSWYgdGhpcyBpcyBkdXJpbmcgc3RhdGljIGdlbmVyYXRpb24sIHRocm93IHRoZSBlcnJvciBhZ2Fpbi5cbiAgICAgICAgaWYgKGlzSXNyKSB0aHJvdyBlcnI7XG4gICAgICAgIC8vIE90aGVyd2lzZSwgc2VuZCBhIDUwMCByZXNwb25zZS5cbiAgICAgICAgYXdhaXQgc2VuZFJlc3BvbnNlKG5vZGVOZXh0UmVxLCBub2RlTmV4dFJlcywgbmV3IFJlc3BvbnNlKG51bGwsIHtcbiAgICAgICAgICAgIHN0YXR1czogNTAwXG4gICAgICAgIH0pKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxufVxuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1hcHAtcm91dGUuanMubWFwXG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fwoocommerce%2Froute&page=%2Fapi%2Fwoocommerce%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwoocommerce%2Froute.ts&appDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!\n");

/***/ }),

/***/ "(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "(rsc)/./src/app/api/woocommerce/route.ts":
/*!******************************************!*\
  !*** ./src/app/api/woocommerce/route.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/../../node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_cache__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/cache */ \"(rsc)/./src/lib/cache.ts\");\n\n\n// Redis is optional - will be undefined if not available\nconst redis = undefined;\nconst WC_URL = process.env.WOOCOMMERCE_API_URL;\nconst SITE_BASE = WC_URL ? WC_URL.replace(/\\/wp-json\\/wc\\/v3.*/, '') : '';\nconst CK = process.env.WOOCOMMERCE_CONSUMER_KEY;\nconst CS = process.env.WOOCOMMERCE_CONSUMER_SECRET;\n// Handle password reset using WordPress REST API\nasync function handlePasswordReset(body) {\n    const { email } = body;\n    if (!email) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Email jest wymagany'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Password reset request for:', email);\n        // Użyj custom mu-plugin endpoint\n        const customUrl = 'https://qvwltjhdjw.cfolks.pl/wp-json/custom/v1/password-reset';\n        const response = await fetch(customUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            },\n            body: JSON.stringify({\n                email\n            })\n        });\n        console.log('🔄 Custom endpoint response status:', response.status);\n        console.log('🔄 Custom endpoint response headers:', Object.fromEntries(response.headers.entries()));\n        if (response.ok) {\n            const data = await response.json();\n            console.log('✅ Custom password reset API response:', data);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: data.success,\n                message: data.message,\n                debug_info: data.debug_info\n            });\n        } else {\n            console.log('❌ Custom password reset API failed:', response.status);\n            const errorText = await response.text();\n            console.log('❌ Custom endpoint error response:', errorText);\n            // Fallback: Sprawdź czy użytkownik istnieje przez WooCommerce API\n            const wcUrl = 'https://qvwltjhdjw.cfolks.pl/wp-json/wc/v3/customers';\n            const auth = 'Basic ' + Buffer.from('ck_deb61eadd7300ebfc5f8074ce7c53c6668eb725d:cs_0de18ed0e013f96aebfb51c77f506bb94e416cb8').toString('base64');\n            const wcResponse = await fetch(`${wcUrl}?email=${encodeURIComponent(email)}`, {\n                method: 'GET',\n                headers: {\n                    'Authorization': auth,\n                    'Content-Type': 'application/json',\n                    'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n                }\n            });\n            if (wcResponse.ok) {\n                const customerData = await wcResponse.json();\n                console.log('✅ Customer found via WooCommerce API:', customerData.length > 0);\n                if (customerData.length > 0) {\n                    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                        success: true,\n                        message: 'Użytkownik został znaleziony. Ze względów bezpieczeństwa, skontaktuj się z obsługą klienta w celu resetowania hasła.'\n                    });\n                }\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: 'Jeśli podany email istnieje w systemie, otrzymasz link do resetowania hasła.'\n            });\n        }\n    } catch (error) {\n        console.error('🚨 Password reset error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: 'Jeśli podany email istnieje w systemie, otrzymasz link do resetowania hasła.'\n        });\n    }\n}\nasync function handlePasswordResetConfirm(body) {\n    const { key, login, password } = body;\n    if (!key || !login || !password) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Wszystkie pola są wymagane'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Password reset confirm for user:', login);\n        // Użyj custom mu-plugin endpoint\n        const customUrl = 'https://qvwltjhdjw.cfolks.pl/wp-json/custom/v1/reset-password';\n        console.log('🔄 Attempting password reset with:', {\n            key: key.substring(0, 10) + '...',\n            login,\n            passwordLength: password.length\n        });\n        const response = await fetch(customUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            },\n            body: JSON.stringify({\n                key: key,\n                login: login,\n                password: password\n            })\n        });\n        console.log('🔄 Password reset response status:', response.status);\n        if (response.ok) {\n            const data = await response.json();\n            console.log('✅ Password reset successful for user:', login);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: 'Hasło zostało pomyślnie zresetowane'\n            });\n        } else {\n            console.log('❌ WordPress password reset failed:', response.status);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: 'Nieprawidłowy lub wygasły klucz resetujący'\n            }, {\n                status: 400\n            });\n        }\n    } catch (error) {\n        console.error('🚨 Password reset confirm error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Wystąpił błąd podczas resetowania hasła'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleCustomerInvoices(req) {\n    const { searchParams } = new URL(req.url);\n    const customerId = searchParams.get('customer_id');\n    if (!customerId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Customer ID jest wymagany'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Fetching invoices for customer:', customerId);\n        // Call WordPress custom API\n        const invoicesUrl = `https://qvwltjhdjw.cfolks.pl/wp-json/custom/v1/invoices?customer_id=${customerId}`;\n        const response = await fetch(invoicesUrl, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            }\n        });\n        const raw = await response.text();\n        let data = null;\n        try {\n            data = raw ? JSON.parse(raw) : null;\n        } catch (e) {}\n        if (!response.ok) {\n            const msg = data && (data.error || data.message) || raw || 'Błąd pobierania faktur';\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: String(msg).slice(0, 1000)\n            }, {\n                status: response.status || 502\n            });\n        }\n        if (!data) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                invoices: []\n            });\n        }\n        console.log('✅ Successfully fetched invoices for customer:', customerId);\n        const rawInvoices = Array.isArray(data.invoices) ? data.invoices : [];\n        const enriched = rawInvoices.map((inv)=>{\n            const id = inv.id || inv.order_id;\n            const hasDownload = inv.download_url && typeof inv.download_url === 'string' && inv.download_url.length > 0;\n            const pluginUrl = id ? `${SITE_BASE}/?action=generate_wpo_wcpdf&document_type=invoice&order_ids=${id}` : undefined;\n            return {\n                ...inv,\n                download_url: hasDownload ? inv.download_url : pluginUrl\n            };\n        });\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            invoices: enriched\n        });\n    } catch (error) {\n        console.error('🚨 Error fetching customer invoices:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Nie udało się pobrać faktur'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleOrderTracking(req) {\n    const { searchParams } = new URL(req.url);\n    const orderId = searchParams.get('order_id');\n    if (!orderId) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Order ID jest wymagany'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Fetching tracking for order:', orderId);\n        // Call WordPress custom API\n        const trackingUrl = `https://qvwltjhdjw.cfolks.pl/wp-json/custom/v1/tracking/${orderId}`;\n        const response = await fetch(trackingUrl, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            }\n        });\n        const raw = await response.text();\n        let data = null;\n        try {\n            data = raw ? JSON.parse(raw) : null;\n        } catch (e) {}\n        if (!response.ok) {\n            const msg = data && (data.error || data.message) || raw || 'Błąd pobierania śledzenia';\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: String(msg).slice(0, 1000)\n            }, {\n                status: response.status || 502\n            });\n        }\n        if (!data) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                tracking: {}\n            });\n        }\n        console.log('✅ Successfully fetched tracking for order:', orderId);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            tracking: data.tracking || {}\n        });\n    } catch (error) {\n        console.error('🚨 Error fetching order tracking:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Nie udało się pobrać informacji o śledzeniu'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleCustomerProfileUpdate(body) {\n    const { customer_id, profile_data } = body;\n    if (!customer_id || !profile_data) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Customer ID i dane profilu są wymagane'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Updating customer profile:', customer_id);\n        // 1) Update via custom WP endpoint (best-effort)\n        let customerFromCustom = null;\n        try {\n            const updateUrl = 'https://qvwltjhdjw.cfolks.pl/wp-json/custom/v1/customer/update-profile';\n            const response = await fetch(updateUrl, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                    'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n                },\n                body: JSON.stringify({\n                    customer_id: customer_id,\n                    profile_data: profile_data\n                })\n            });\n            const raw = await response.text();\n            let data = null;\n            try {\n                data = raw ? JSON.parse(raw) : null;\n            } catch (e) {}\n            if (response.ok && data && data.success) {\n                customerFromCustom = data.customer || null;\n            } else {\n                console.log('ℹ️ Custom update-profile did not return success, continuing with Woo update');\n            }\n        } catch (e) {\n            console.log('ℹ️ Custom update-profile call failed, continuing with Woo update');\n        }\n        // 2) Ensure persistence in WooCommerce via REST API (PATCH customers/{id})\n        if (!WC_URL || !CK || !CS) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: 'Brak konfiguracji WooCommerce API'\n            }, {\n                status: 500\n            });\n        }\n        const wooPayload = {\n            first_name: profile_data.firstName,\n            last_name: profile_data.lastName,\n            billing: {\n                first_name: profile_data.firstName,\n                last_name: profile_data.lastName,\n                company: profile_data.billing?.company || '',\n                phone: profile_data.billing?.phone || '',\n                address_1: profile_data.billing?.address || '',\n                city: profile_data.billing?.city || '',\n                postcode: profile_data.billing?.postcode || '',\n                country: profile_data.billing?.country || 'PL',\n                email: undefined\n            },\n            shipping: {\n                first_name: profile_data.firstName,\n                last_name: profile_data.lastName,\n                company: profile_data.shipping?.company || '',\n                address_1: profile_data.shipping?.address || '',\n                city: profile_data.shipping?.city || '',\n                postcode: profile_data.shipping?.postcode || '',\n                country: profile_data.shipping?.country || 'PL'\n            },\n            meta_data: []\n        };\n        const nip = profile_data.billing?.nip || profile_data.nip;\n        const invoiceReq = profile_data.billing?.invoiceRequest ?? profile_data.invoiceRequest;\n        if (nip !== undefined) {\n            wooPayload.meta_data.push({\n                key: '_billing_nip',\n                value: String(nip)\n            });\n        }\n        if (invoiceReq !== undefined) {\n            wooPayload.meta_data.push({\n                key: '_invoice_request',\n                value: invoiceReq ? 'yes' : 'no'\n            });\n        }\n        const wooUrl = `${WC_URL}/customers/${customer_id}?consumer_key=${CK}&consumer_secret=${CS}`;\n        const wooResp = await fetch(wooUrl, {\n            method: 'PUT',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            },\n            body: JSON.stringify(wooPayload)\n        });\n        const wooRaw = await wooResp.text();\n        let wooData = null;\n        try {\n            wooData = wooRaw ? JSON.parse(wooRaw) : null;\n        } catch (_) {}\n        if (!wooResp.ok) {\n            const msg = wooData && (wooData.error || wooData.message) || wooRaw || 'Błąd aktualizacji klienta w WooCommerce';\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: String(msg).slice(0, 1000)\n            }, {\n                status: wooResp.status || 502\n            });\n        }\n        console.log('✅ WooCommerce customer updated:', customer_id);\n        // Merge best available customer data\n        const mergedCustomer = customerFromCustom || wooData;\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: 'Profil został zaktualizowany',\n            customer: mergedCustomer\n        });\n    } catch (error) {\n        console.error('🚨 Error updating customer profile:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message || 'Nie udało się zaktualizować profilu'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleCustomerPasswordChange(body) {\n    const { customer_id, current_password, new_password } = body;\n    if (!customer_id || !current_password || !new_password) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Wszystkie pola są wymagane'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Changing customer password:', customer_id);\n        // Call WordPress custom API\n        const changePasswordUrl = 'https://qvwltjhdjw.cfolks.pl/wp-json/custom/v1/customer/change-password';\n        const response = await fetch(changePasswordUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            },\n            body: JSON.stringify({\n                customer_id: customer_id,\n                current_password: current_password,\n                new_password: new_password\n            })\n        });\n        const raw = await response.text();\n        let data = null;\n        try {\n            data = raw ? JSON.parse(raw) : null;\n        } catch (e) {}\n        if (!response.ok) {\n            const msg = response.status === 404 ? 'Funkcja zmiany hasła nie jest jeszcze dostępna. Skontaktuj się z administratorem.' : data && (data.error || data.message) || raw || 'Błąd zmiany hasła';\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: String(msg).slice(0, 1000)\n            }, {\n                status: response.status || 502\n            });\n        }\n        if (!data) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                message: 'Hasło zostało zmienione'\n            });\n        }\n        console.log('✅ Successfully changed customer password:', customer_id);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            message: data.message\n        });\n    } catch (error) {\n        console.error('🚨 Error changing customer password:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message || 'Nie udało się zmienić hasła'\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleOrderCreation(body) {\n    const { billing, shipping, line_items, payment_method, payment_method_title, shipping_lines, customer_id, coupon_lines, meta_data } = body;\n    if (!billing || !line_items || !payment_method) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: 'Brakuje wymaganych danych zamówienia'\n        }, {\n            status: 400\n        });\n    }\n    try {\n        console.log('🔄 Creating order in WooCommerce');\n        console.log('🎫 Coupon lines received:', coupon_lines);\n        // Prepare order data for WooCommerce\n        const orderData = {\n            payment_method: payment_method,\n            payment_method_title: payment_method_title || payment_method,\n            set_paid: false,\n            customer_id: customer_id,\n            billing: {\n                first_name: billing.firstName,\n                last_name: billing.lastName,\n                email: billing.email,\n                phone: billing.phone,\n                company: billing.company || '',\n                address_1: billing.address,\n                city: billing.city,\n                state: '',\n                postcode: billing.postcode,\n                country: billing.country || 'PL'\n            },\n            shipping: shipping ? {\n                first_name: shipping.firstName,\n                last_name: shipping.lastName,\n                company: shipping.company || '',\n                address_1: shipping.address,\n                city: shipping.city,\n                state: '',\n                postcode: shipping.postcode,\n                country: shipping.country || 'PL'\n            } : {\n                first_name: billing.firstName,\n                last_name: billing.lastName,\n                company: billing.company || '',\n                address_1: billing.address,\n                city: billing.city,\n                state: '',\n                postcode: billing.postcode,\n                country: billing.country || 'PL'\n            },\n            line_items: line_items.map((item)=>({\n                    product_id: item.product_id,\n                    variation_id: item.variation_id || 0,\n                    quantity: item.quantity,\n                    meta_data: item.meta_data || []\n                })),\n            shipping_lines: shipping_lines || [],\n            coupon_lines: coupon_lines || [],\n            meta_data: [\n                ...meta_data || [],\n                {\n                    key: '_created_via',\n                    value: 'headless-woo'\n                },\n                {\n                    key: '_order_version',\n                    value: '1.0.0'\n                }\n            ]\n        };\n        // Create order via WooCommerce REST API\n        const orderUrl = `${WC_URL}/orders?consumer_key=${CK}&consumer_secret=${CS}`;\n        const response = await fetch(orderUrl, {\n            method: 'POST',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Mozilla/5.0 (compatible; HeadlessWoo/1.0)'\n            },\n            body: JSON.stringify(orderData)\n        });\n        const raw = await response.text();\n        let data = null;\n        try {\n            data = raw ? JSON.parse(raw) : null;\n        } catch (e) {}\n        if (!response.ok) {\n            const msg = data && (data.message || data.error) || raw || 'Błąd tworzenia zamówienia';\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: String(msg).slice(0, 1000)\n            }, {\n                status: response.status || 502\n            });\n        }\n        if (!data) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: 'Nie udało się utworzyć zamówienia'\n            }, {\n                status: 500\n            });\n        }\n        console.log('✅ Successfully created order:', data.id);\n        // Trigger WooCommerce emails after order creation\n        try {\n            console.log('📧 Triggering WooCommerce emails for order:', data.id);\n            // Use our custom email API endpoint\n            const emailApiUrl = `${WC_URL}/wp-json/king-email/v1/trigger-order-email`;\n            const emailResponse = await fetch(emailApiUrl, {\n                method: 'POST',\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json'\n                },\n                body: JSON.stringify({\n                    order_id: data.id\n                })\n            });\n            if (emailResponse.ok) {\n                const emailResult = await emailResponse.json();\n                console.log('✅ Email triggered via API:', emailResult);\n            } else {\n                console.log('⚠️ Failed to trigger email via API');\n            }\n        } catch (emailError) {\n            console.error('❌ Error triggering emails:', emailError);\n        }\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            order: {\n                id: data.id,\n                number: data.number,\n                status: data.status,\n                total: data.total,\n                currency: data.currency,\n                payment_url: data.payment_url,\n                checkout_payment_url: data.checkout_payment_url,\n                date_created: data.date_created,\n                billing: data.billing,\n                shipping: data.shipping,\n                line_items: data.line_items\n            }\n        });\n    } catch (error) {\n        console.error('🚨 Error creating order:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: false,\n            error: error.message || 'Nie udało się utworzyć zamówienia'\n        }, {\n            status: 500\n        });\n    }\n}\n// Handle attributes endpoint - PRO Architecture: Dynamic attributes based on filters\nasync function handleAttributesEndpoint(req) {\n    const { searchParams } = new URL(req.url);\n    if (!WC_URL || !CK || !CS) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Błąd konfiguracji serwera',\n            details: 'Brakuje zmiennych środowiskowych WooCommerce'\n        }, {\n            status: 500\n        });\n    }\n    try {\n        // PRO Architecture: WordPress robi całe filtrowanie atrybutów\n        const attributesUrl = `https://qvwltjhdjw.cfolks.pl/wp-json/king-shop/v1/attributes?${searchParams.toString()}`;\n        console.log('🏷️ Attributes endpoint - calling King Shop API:', attributesUrl);\n        const response = await fetch(attributesUrl, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Filler-Store/1.0'\n            },\n            cache: 'no-store'\n        });\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        console.log('✅ Attributes data received from WordPress:', {\n            attributes: data.attributes ? Object.keys(data.attributes).length : 0,\n            total_products: data.total_products || 0\n        });\n        // WordPress zrobił całe filtrowanie - zwracamy dane jak są\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data, {\n            status: 200,\n            headers: {\n                \"content-type\": \"application/json\",\n                \"Cache-Control\": \"public, max-age=60, s-maxage=120, stale-while-revalidate=300\",\n                \"X-Cache\": \"MISS\"\n            }\n        });\n    } catch (error) {\n        console.error('❌ Attributes endpoint error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Nie udało się pobrać atrybutów',\n            details: error instanceof Error ? error.message : 'Nieznany błąd'\n        }, {\n            status: 500\n        });\n    }\n}\n// Handle shop endpoint - PRO Architecture: WordPress robi całe filtrowanie\nasync function handleShopEndpoint(req) {\n    const { searchParams } = new URL(req.url);\n    if (!WC_URL || !CK || !CS) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Błąd konfiguracji serwera',\n            details: 'Brakuje zmiennych środowiskowych WooCommerce'\n        }, {\n            status: 500\n        });\n    }\n    try {\n        // PRO Architecture: WordPress robi całe filtrowanie\n        // Next.js tylko przekazuje parametry i cache'uje odpowiedź\n        const shopUrl = `https://qvwltjhdjw.cfolks.pl/wp-json/king-shop/v1/data?${searchParams.toString()}`;\n        console.log('🛍️ Shop endpoint - calling King Shop API:', shopUrl);\n        const response = await fetch(shopUrl, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json',\n                'User-Agent': 'Filler-Store/1.0'\n            },\n            cache: 'no-store'\n        });\n        if (!response.ok) {\n            throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const data = await response.json();\n        console.log('✅ Shop data received from WordPress:', {\n            products: data.products?.length || 0,\n            total: data.total,\n            categories: data.categories?.length || 0,\n            attributes: data.attributes ? Object.keys(data.attributes).length : 0\n        });\n        // WordPress zrobił całe filtrowanie - zwracamy dane jak są\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data, {\n            status: 200,\n            headers: {\n                \"content-type\": \"application/json\",\n                \"Cache-Control\": \"public, max-age=60, s-maxage=120, stale-while-revalidate=300\",\n                \"X-Cache\": \"MISS\"\n            }\n        });\n    } catch (error) {\n        console.error('❌ Shop endpoint error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Nie udało się pobrać danych sklepu',\n            details: error instanceof Error ? error.message : 'Nieznany błąd'\n        }, {\n            status: 500\n        });\n    }\n}\n// Handle shipping methods endpoint\nasync function handleShippingMethods(req) {\n    const { searchParams } = new URL(req.url);\n    const country = searchParams.get(\"country\") || \"PL\";\n    const state = searchParams.get(\"state\") || \"\";\n    const city = searchParams.get(\"city\") || \"\";\n    const postcode = searchParams.get(\"postcode\") || \"\";\n    if (!WC_URL || !CK || !CS) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Błąd konfiguracji serwera',\n            details: 'Brakuje zmiennych środowiskowych WooCommerce'\n        }, {\n            status: 500\n        });\n    }\n    try {\n        // Get shipping zones and methods from WooCommerce\n        const shippingZonesUrl = `${WC_URL}/shipping/zones?consumer_key=${CK}&consumer_secret=${CS}`;\n        const zonesResponse = await fetch(shippingZonesUrl, {\n            headers: {\n                Accept: 'application/json',\n                'User-Agent': 'Filler-Store/1.0'\n            }\n        });\n        if (!zonesResponse.ok) {\n            throw new Error(`Nie udało się pobrać stref wysyłki: ${zonesResponse.status}`);\n        }\n        // Harden against HTML/non-JSON responses\n        const zonesText = await zonesResponse.text();\n        let zonesParsed;\n        try {\n            zonesParsed = JSON.parse(zonesText);\n        } catch (_) {\n            console.error('Shipping zones returned non-JSON (truncated):', zonesText.substring(0, 200));\n            zonesParsed = [];\n        }\n        const zones = Array.isArray(zonesParsed) ? zonesParsed : [];\n        // Get methods for each zone\n        const shippingMethods = [];\n        for (const zone of zones){\n            const methodsUrl = `${WC_URL}/shipping/zones/${zone.id}/methods?consumer_key=${CK}&consumer_secret=${CS}`;\n            const methodsResponse = await fetch(methodsUrl);\n            if (methodsResponse.ok) {\n                const responseText = await methodsResponse.text();\n                let methods = [];\n                // Prefer native JSON parsing first\n                try {\n                    methods = await JSON.parse(responseText);\n                } catch (_) {\n                    // If parsing fails due to raw HTML inside fields (e.g. method_description),\n                    // sanitize the payload by stripping HTML-bearing properties before parsing again.\n                    try {\n                        const sanitized = responseText// Remove/empty method_description HTML blobs that can break JSON\n                        .replace(/\"method_description\"\\s*:\\s*\"[\\s\\S]*?\"(?=,|\\}|\\])/g, '\"method_description\":\"\"')// Ensure method_title is a flat string (strip tags if any)\n                        .replace(/\"method_title\"\\s*:\\s*\"([\\s\\S]*?)\"/g, (_m, g1)=>{\n                            const clean = String(g1).replace(/<[^>]*>/g, ' ').replace(/\\s+/g, ' ').trim();\n                            return `\"method_title\":\"${clean}\"`;\n                        });\n                        methods = JSON.parse(sanitized);\n                    } catch (error) {\n                        console.error('Nie udało się bezpiecznie sparsować metod wysyłki:', error);\n                        console.log('Response text (truncated):', responseText.substring(0, 200));\n                        methods = [];\n                    }\n                }\n                for (const method of methods){\n                    if (method.enabled) {\n                        shippingMethods.push({\n                            id: method.id,\n                            method_id: method.method_id,\n                            title: method.title,\n                            cost: method.cost || '0',\n                            zone_id: zone.id,\n                            zone_name: zone.name,\n                            // Additional properties for internal use\n                            method_title: method.method_title || method.title,\n                            method_description: method.method_description || '',\n                            settings: method.settings || {},\n                            zone_locations: zone.locations || []\n                        });\n                    }\n                }\n            }\n        }\n        // Process and normalize shipping methods (same logic as in service)\n        const processedMethods = shippingMethods.map((method)=>{\n            let cost = 0;\n            let freeShippingThreshold = 0;\n            // Handle Flexible Shipping methods\n            if (method.method_id === 'flexible_shipping_single') {\n                const settings = method.settings || {};\n                // Get free shipping threshold\n                if (settings.method_free_shipping && settings.method_free_shipping.value) {\n                    freeShippingThreshold = parseFloat(settings.method_free_shipping.value); // Keep as PLN, not cents\n                }\n                // Get cost from rules\n                if (settings.method_rules && settings.method_rules.value && settings.method_rules.value.length > 0) {\n                    const rules = settings.method_rules.value;\n                    // Find the rule that applies (usually the first one)\n                    if (rules[0] && rules[0].cost_per_order) {\n                        cost = parseFloat(rules[0].cost_per_order); // Keep as PLN, not cents\n                    }\n                }\n            } else if (method.method_id === 'flat_rate') {\n                const settings = method.settings || {};\n                if (settings.cost && settings.cost.value) {\n                    cost = parseFloat(settings.cost.value); // Keep as PLN, not cents\n                }\n            }\n            // Clean HTML from description\n            const cleanDescription = (desc)=>{\n                if (!desc) return '';\n                // Remove HTML tags and decode entities\n                return desc.replace(/<[^>]*>/g, '') // Remove HTML tags\n                .replace(/&rarr;/g, '→') // Decode arrow\n                .replace(/&nbsp;/g, ' ') // Decode non-breaking space\n                .replace(/&amp;/g, '&') // Decode ampersand\n                .replace(/&lt;/g, '<') // Decode less than\n                .replace(/&gt;/g, '>') // Decode greater than\n                .replace(/&quot;/g, '\"') // Decode quote\n                .trim();\n            };\n            return {\n                id: method.id,\n                method_id: method.method_id,\n                method_title: method.settings?.method_title?.value || method.method_title,\n                method_description: cleanDescription(method.settings?.method_description?.value || method.method_description),\n                cost: cost,\n                free_shipping_threshold: freeShippingThreshold,\n                zone_id: method.zone_id,\n                zone_name: method.zone_name,\n                settings: method.settings\n            };\n        });\n        // Fallback: if no methods found, provide sensible defaults so checkout remains usable\n        const methodsOut = Array.isArray(processedMethods) && processedMethods.length > 0 ? processedMethods : [\n            {\n                id: 'free_shipping_default',\n                method_id: 'free_shipping',\n                method_title: 'Darmowa dostawa',\n                method_description: '',\n                cost: 0,\n                free_shipping_threshold: 0,\n                zone_id: 0,\n                zone_name: 'Domyślna',\n                settings: {}\n            },\n            {\n                id: 'flat_rate_default',\n                method_id: 'flat_rate',\n                method_title: 'Dostawa standardowa',\n                method_description: '',\n                cost: 15,\n                free_shipping_threshold: 0,\n                zone_id: 0,\n                zone_name: 'Domyślna',\n                settings: {}\n            },\n            {\n                id: 'local_pickup_default',\n                method_id: 'local_pickup',\n                method_title: 'Odbiór osobisty',\n                method_description: '',\n                cost: 0,\n                free_shipping_threshold: 0,\n                zone_id: 0,\n                zone_name: 'Domyślna',\n                settings: {}\n            }\n        ];\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            shipping_methods: methodsOut,\n            country,\n            state,\n            city,\n            postcode\n        });\n    } catch (error) {\n        console.error('Shipping methods API error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Nie udało się pobrać metod wysyłki',\n            details: error instanceof Error ? error.message : String(error)\n        }, {\n            status: 500\n        });\n    }\n}\nasync function handleCoupons(req) {\n    try {\n        const { searchParams } = new URL(req.url);\n        const code = searchParams.get('code');\n        if (!WC_URL || !CK || !CS) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Brak konfiguracji WooCommerce'\n            }, {\n                status: 500\n            });\n        }\n        // If specific code requested, validate it\n        if (code) {\n            const response = await fetch(`${WC_URL}/coupons?code=${encodeURIComponent(code)}&status=active`, {\n                headers: {\n                    'Authorization': `Basic ${Buffer.from(`${CK}:${CS}`).toString('base64')}`\n                }\n            });\n            if (!response.ok) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Nieprawidłowy kod rabatowy'\n                }, {\n                    status: 400\n                });\n            }\n            const coupons = await response.json();\n            if (coupons.length === 0) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Nieprawidłowy kod rabatowy'\n                }, {\n                    status: 400\n                });\n            }\n            const coupon = coupons[0];\n            // Check if coupon is still valid\n            if (coupon.usage_limit && coupon.usage_count >= coupon.usage_limit) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Kod rabatowy został już wykorzystany'\n                }, {\n                    status: 400\n                });\n            }\n            if (coupon.date_expires && new Date(coupon.date_expires) < new Date()) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Kod rabatowy wygasł'\n                }, {\n                    status: 400\n                });\n            }\n            // Check per-user usage limit\n            if (coupon.usage_limit_per_user && coupon.usage_limit_per_user > 0) {\n                // For now, we'll rely on WooCommerce to enforce this when creating the order\n                // The used_by array will be checked by WooCommerce API\n                console.log('ℹ️ Coupon has per-user limit:', coupon.usage_limit_per_user);\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                coupon: {\n                    id: coupon.id,\n                    code: coupon.code,\n                    discount_type: coupon.discount_type,\n                    amount: parseFloat(coupon.amount),\n                    minimum_amount: coupon.minimum_amount ? parseFloat(coupon.minimum_amount) : null,\n                    maximum_amount: coupon.maximum_amount ? parseFloat(coupon.maximum_amount) : null,\n                    usage_limit: coupon.usage_limit,\n                    usage_count: coupon.usage_count,\n                    date_expires: coupon.date_expires\n                }\n            });\n        }\n        // Return all active coupons (for admin purposes)\n        const response = await fetch(`${WC_URL}/coupons?status=active&_fields=id,code,discount_type,amount,minimum_amount,maximum_amount,usage_limit,usage_count,date_expires`, {\n            headers: {\n                'Authorization': `Basic ${Buffer.from(`${CK}:${CS}`).toString('base64')}`\n            }\n        });\n        const coupons = await response.json();\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            coupons: coupons.map((coupon)=>({\n                    id: coupon.id,\n                    code: coupon.code,\n                    discount_type: coupon.discount_type,\n                    amount: parseFloat(coupon.amount),\n                    minimum_amount: coupon.minimum_amount ? parseFloat(coupon.minimum_amount) : null,\n                    maximum_amount: coupon.maximum_amount ? parseFloat(coupon.maximum_amount) : null,\n                    usage_limit: coupon.usage_limit,\n                    usage_count: coupon.usage_count,\n                    date_expires: coupon.date_expires\n                }))\n        });\n    } catch (error) {\n        console.error('Coupons API error:', error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Nie udało się pobrać kuponów',\n            details: error instanceof Error ? error.message : String(error)\n        }, {\n            status: 500\n        });\n    }\n}\nasync function GET(req) {\n    const { searchParams } = new URL(req.url);\n    const endpoint = searchParams.get(\"endpoint\") || \"products\";\n    const bypassCache = searchParams.get(\"cache\") === \"off\";\n    // Optimized product endpoint\n    if (endpoint.startsWith('king-optimized/product/')) {\n        const slug = endpoint.replace('king-optimized/product/', '');\n        const url = `${\"https://qvwltjhdjw.cfolks.pl\"}/wp-json/king-optimized/v1/product/${slug}`;\n        try {\n            const response = await fetch(url, {\n                headers: {\n                    'Accept': 'application/json'\n                },\n                cache: bypassCache ? 'no-store' : 'default'\n            });\n            if (!response.ok) {\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: 'Product not found'\n                }, {\n                    status: response.status\n                });\n            }\n            const data = await response.json();\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(data);\n        } catch (error) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n    }\n    // Customer profile endpoint\n    if (endpoint.startsWith('customers/')) {\n        const customerId = endpoint.replace('customers/', '');\n        const authHeader = req.headers.get('authorization');\n        if (!authHeader || !authHeader.startsWith('Bearer ')) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: 'Unauthorized'\n            }, {\n                status: 401\n            });\n        }\n        try {\n            console.log('🔄 Fetching customer data for ID:', customerId);\n            const response = await fetch(`${WC_URL}/customers/${customerId}?consumer_key=${CK}&consumer_secret=${CS}`, {\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json'\n                }\n            });\n            console.log('🔍 Customer API response status:', response.status);\n            if (!response.ok) {\n                const errorText = await response.text();\n                console.error('❌ Customer API error:', errorText);\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    error: 'Customer not found'\n                }, {\n                    status: response.status\n                });\n            }\n            const customerData = await response.json();\n            console.log('✅ Customer data fetched:', customerData);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json(customerData);\n        } catch (error) {\n            console.error('❌ Customer fetch error:', error);\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: error.message\n            }, {\n                status: 500\n            });\n        }\n    }\n    // Payment gateways\n    if (endpoint === 'payment_gateways') {\n        if (!WC_URL || !CK || !CS) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: 'Brak konfiguracji WooCommerce API'\n            }, {\n                status: 500\n            });\n        }\n        try {\n            const url = `${WC_URL}/payment_gateways?consumer_key=${CK}&consumer_secret=${CS}`;\n            const r = await fetch(url, {\n                headers: {\n                    Accept: 'application/json',\n                    'User-Agent': 'Filler-Store/1.0'\n                },\n                cache: 'no-store'\n            });\n            const text = await r.text();\n            let data = null;\n            try {\n                data = text ? JSON.parse(text) : null;\n            } catch (_) {}\n            if (!r.ok) {\n                const msg = data && (data.message || data.error) || text || 'Błąd pobierania metod płatności';\n                return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                    success: false,\n                    error: String(msg).slice(0, 1000)\n                }, {\n                    status: r.status || 502\n                });\n            }\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: true,\n                gateways: Array.isArray(data) ? data : []\n            });\n        } catch (e) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                success: false,\n                error: e instanceof Error ? e.message : String(e)\n            }, {\n                status: 502\n            });\n        }\n    }\n    // Special handling for shipping methods\n    if (endpoint === \"shipping_methods\") {\n        return handleShippingMethods(req);\n    }\n    // Special handling for coupons\n    if (endpoint === \"coupons\") {\n        return handleCoupons(req);\n    }\n    // Special handling for attributes endpoint - PRO Architecture\n    if (endpoint === \"attributes\") {\n        return handleAttributesEndpoint(req);\n    }\n    // Special handling for shop endpoint - use new King Shop API\n    if (endpoint === \"shop\") {\n        return handleShopEndpoint(req);\n    }\n    if (!WC_URL || !CK || !CS) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Błąd konfiguracji serwera',\n            details: 'Brakuje zmiennych środowiskowych WooCommerce'\n        }, {\n            status: 500\n        });\n    }\n    // Rate limiting\n    const ip = req.headers.get('x-forwarded-for') || req.headers.get('x-real-ip') || 'unknown';\n    const rateLimit = _lib_cache__WEBPACK_IMPORTED_MODULE_1__.cache.checkRateLimit(ip);\n    if (!rateLimit.allowed) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: 'Przekroczono limit zapytań',\n            retryAfter: Math.ceil((rateLimit.resetAt - Date.now()) / 1000)\n        }, {\n            status: 429,\n            headers: {\n                'Retry-After': Math.ceil((rateLimit.resetAt - Date.now()) / 1000).toString(),\n                'X-RateLimit-Limit': '100',\n                'X-RateLimit-Remaining': '0',\n                'X-RateLimit-Reset': rateLimit.resetAt.toString()\n            }\n        });\n    }\n    const url = new URL(`${WC_URL.replace(/\\/$/, \"\")}/${endpoint}`);\n    searchParams.forEach((v, k)=>{\n        if (k !== \"endpoint\" && k !== \"cache\") url.searchParams.set(k, v);\n    });\n    url.searchParams.set(\"consumer_key\", CK || '');\n    url.searchParams.set(\"consumer_secret\", CS || '');\n    console.log('🔍 API Route Debug:');\n    console.log('WC_URL:', WC_URL);\n    console.log('CK:', CK ? 'SET' : 'NOT SET');\n    console.log('CS:', CS ? 'SET' : 'NOT SET');\n    console.log('Final URL:', url.toString());\n    console.log('Bypass cache:', bypassCache);\n    console.log('Search params:', Object.fromEntries(searchParams.entries()));\n    try {\n        // Cache lookup (skip if bypass)\n        const cacheKey = _lib_cache__WEBPACK_IMPORTED_MODULE_1__.cache.generateKey(url.toString());\n        let cached = null;\n        if (!bypassCache) {\n            cached = await _lib_cache__WEBPACK_IMPORTED_MODULE_1__.cache.get(cacheKey);\n        }\n        if (cached) {\n            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(cached.body, {\n                status: 200,\n                headers: {\n                    \"content-type\": \"application/json\",\n                    \"Cache-Control\": `public, max-age=30, s-maxage=60`,\n                    \"ETag\": cached.etag,\n                    \"X-Cache\": \"HIT\",\n                    \"X-RateLimit-Limit\": \"100\",\n                    \"X-RateLimit-Remaining\": rateLimit.remaining.toString(),\n                    \"X-RateLimit-Reset\": rateLimit.resetAt.toString(),\n                    ...cached.headers\n                }\n            });\n        }\n        // Retry logic for better reliability\n        let lastError = null;\n        for(let attempt = 1; attempt <= 3; attempt++){\n            try {\n                console.log(`🔄 Attempt ${attempt} for ${url.toString()}`);\n                const r = await fetch(url.toString(), {\n                    headers: {\n                        Accept: \"application/json\",\n                        'User-Agent': 'Filler-Store/1.0'\n                    },\n                    cache: \"no-store\"\n                });\n                const text = await r.text();\n                if (!r.ok) {\n                    console.log(`❌ HTTP ${r.status}: ${text}`);\n                    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(text || r.statusText, {\n                        status: r.status,\n                        headers: {\n                            \"content-type\": r.headers.get(\"content-type\") || \"text/plain\"\n                        }\n                    });\n                }\n                // Check if response is HTML instead of JSON (WordPress error page)\n                if (text.trim().startsWith('<!DOCTYPE html>') || text.trim().startsWith('<html')) {\n                    console.log(`❌ WordPress returned HTML instead of JSON: ${text.substring(0, 100)}...`);\n                    // Try to get cached data first\n                    if (!bypassCache && redis && typeof redis.get === 'function') {\n                        try {\n                            const cachedData = await redis.get(cacheKey);\n                            if (cachedData) {\n                                console.log('✅ Using cached data as fallback');\n                                return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(cachedData, {\n                                    status: 200,\n                                    headers: {\n                                        'content-type': 'application/json'\n                                    }\n                                });\n                            }\n                        } catch  {\n                            console.log('⚠️ Redis not available, skipping cache fallback');\n                        }\n                    }\n                    // Retry the request once more\n                    console.log('🔄 Retrying request...');\n                    const retryResponse = await fetch(url, {\n                        method: 'GET',\n                        headers: {\n                            'Content-Type': 'application/json',\n                            Accept: \"application/json\",\n                            'User-Agent': 'Filler-Store/1.0'\n                        },\n                        cache: \"no-store\"\n                    });\n                    if (retryResponse.ok) {\n                        const retryText = await retryResponse.text();\n                        if (!retryText.trim().startsWith('<!DOCTYPE html>') && !retryText.trim().startsWith('<html')) {\n                            console.log('✅ Retry successful, returning data');\n                            return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(retryText, {\n                                status: 200,\n                                headers: {\n                                    'content-type': 'application/json'\n                                }\n                            });\n                        }\n                    }\n                    // Return empty data instead of error to prevent app crashes\n                    console.log('⚠️ Returning empty data as fallback');\n                    const emptyResponse = {\n                        data: [],\n                        total: 0,\n                        totalPages: 0,\n                        currentPage: 1,\n                        perPage: 10,\n                        error: 'API tymczasowo niedostępne'\n                    };\n                    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(JSON.stringify(emptyResponse), {\n                        status: 200,\n                        headers: {\n                            'content-type': 'application/json'\n                        }\n                    });\n                }\n                console.log(`✅ Success on attempt ${attempt}`);\n                // Populate cache (skip if bypass)\n                if (!bypassCache) {\n                    await _lib_cache__WEBPACK_IMPORTED_MODULE_1__.cache.set(cacheKey, text, 60000, {\n                        'X-Response-Time': `${Date.now() - Date.now()}ms`,\n                        'X-Attempt': attempt.toString()\n                    });\n                }\n                const etag = _lib_cache__WEBPACK_IMPORTED_MODULE_1__.cache.generateETag(text);\n                return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(text, {\n                    status: 200,\n                    headers: {\n                        \"content-type\": \"application/json\",\n                        \"Cache-Control\": `public, max-age=30, s-maxage=60`,\n                        \"ETag\": etag,\n                        \"X-Cache\": bypassCache ? \"BYPASS\" : \"MISS\",\n                        \"X-RateLimit-Limit\": \"100\",\n                        \"X-RateLimit-Remaining\": rateLimit.remaining.toString(),\n                        \"X-RateLimit-Reset\": rateLimit.resetAt.toString()\n                    }\n                });\n            } catch (error) {\n                lastError = error;\n                console.log(`❌ Attempt ${attempt} failed:`, error);\n                if (attempt < 3) {\n                    // Wait before retry (exponential backoff)\n                    await new Promise((resolve)=>setTimeout(resolve, attempt * 1000));\n                }\n            }\n        }\n        // All attempts failed\n        throw lastError;\n    } catch (e) {\n        console.error('🚨 All attempts failed:', e);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Błąd serwera proxy\",\n            message: e instanceof Error ? e.message : String(e)\n        }, {\n            status: 502\n        });\n    }\n}\nasync function POST(req) {\n    const { searchParams } = new URL(req.url);\n    const endpoint = searchParams.get(\"endpoint\") || \"products\";\n    console.log('🔄 POST request to endpoint:', endpoint);\n    try {\n        const body = await req.json();\n        // Special handling for password reset\n        if (endpoint === 'customers/password-reset') {\n            console.log('🔄 Handling password reset request');\n            return await handlePasswordReset(body);\n        }\n        // Special handling for password reset confirmation\n        if (endpoint === 'customers/reset-password') {\n            console.log('🔄 Handling password reset confirm request');\n            return await handlePasswordResetConfirm(body);\n        }\n        // Special handling for customer invoices\n        if (endpoint === 'customers/invoices') {\n            console.log('🔄 Handling customer invoices request');\n            return await handleCustomerInvoices(req);\n        }\n        // Special handling for order creation\n        if (endpoint === 'orders') {\n            console.log('🔄 Handling order creation request');\n            return await handleOrderCreation(body);\n        }\n        // Special handling for order tracking\n        if (endpoint === 'orders/tracking') {\n            console.log('🔄 Handling order tracking request');\n            return await handleOrderTracking(req);\n        }\n        // Special handling for customer profile update\n        if (endpoint === 'customer/update-profile') {\n            console.log('🔄 Handling customer profile update request');\n            return await handleCustomerProfileUpdate(body);\n        }\n        // Special handling for customer password change\n        if (endpoint === 'customer/change-password') {\n            console.log('🔄 Handling customer password change request');\n            return await handleCustomerPasswordChange(body);\n        }\n        // Special handling for customer invoices\n        if (endpoint === 'customers/invoices') {\n            console.log('🔄 Handling customer invoices request');\n            return await handleCustomerInvoices(req);\n        }\n        console.log('🔄 Using standard WooCommerce endpoint:', endpoint);\n        const url = new URL(`${WC_URL?.replace(/\\/$/, \"\") || 'https://qvwltjhdjw.cfolks.pl/wp-json/wc/v3'}/${endpoint}`);\n        url.searchParams.set(\"consumer_key\", CK || '');\n        url.searchParams.set(\"consumer_secret\", CS || '');\n        // Retry logic for POST requests too\n        let lastError = null;\n        for(let attempt = 1; attempt <= 3; attempt++){\n            try {\n                console.log(`🔄 POST Attempt ${attempt} for ${url.toString()}`);\n                const r = await fetch(url.toString(), {\n                    method: 'POST',\n                    headers: {\n                        Accept: \"application/json\",\n                        'Content-Type': 'application/json',\n                        'User-Agent': 'Filler-Store/1.0'\n                    },\n                    body: JSON.stringify(body),\n                    cache: \"no-store\"\n                });\n                const text = await r.text();\n                if (!r.ok) {\n                    console.log(`❌ POST HTTP ${r.status}: ${text}`);\n                    return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(text || r.statusText, {\n                        status: r.status,\n                        headers: {\n                            \"content-type\": r.headers.get(\"content-type\") || \"text/plain\"\n                        }\n                    });\n                }\n                console.log(`✅ POST Success on attempt ${attempt}`);\n                return new next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse(text, {\n                    status: 200,\n                    headers: {\n                        \"content-type\": \"application/json\"\n                    }\n                });\n            } catch (error) {\n                lastError = error;\n                console.log(`❌ POST Attempt ${attempt} failed:`, error);\n                if (attempt < 3) {\n                    await new Promise((resolve)=>setTimeout(resolve, attempt * 1000));\n                }\n            }\n        }\n        throw lastError;\n    } catch (e) {\n        console.error('🚨 POST All attempts failed:', e);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Błąd serwera proxy\",\n            message: e instanceof Error ? e.message : String(e)\n        }, {\n            status: 502\n        });\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QW1CO2dCQUNoRDtZQUNGLEVBQUUsT0FBT1IsT0FBTztnQkFDZDJOLFlBQVkzTjtnQkFDWkUsUUFBUUMsR0FBRyxDQUFDLENBQUMsZUFBZSxFQUFFeU4sUUFBUSxRQUFRLENBQUMsRUFBRTVOO2dCQUVqRCxJQUFJNE4sVUFBVSxHQUFHO29CQUNmLE1BQU0sSUFBSVUsUUFBUUMsQ0FBQUEsVUFBV0MsV0FBV0QsU0FBU1gsVUFBVTtnQkFDN0Q7WUFDRjtRQUNGO1FBRUEsTUFBTUQ7SUFDUixFQUFFLE9BQU85SyxHQUFZO1FBQ25CM0MsUUFBUUYsS0FBSyxDQUFDLGdDQUFnQzZDO1FBQzlDLE9BQU9oRSxxREFBWUEsQ0FBQ2lCLElBQUksQ0FDdEI7WUFBRUUsT0FBTztZQUFzQmdCLFNBQVM2QixhQUFhb0YsUUFBUXBGLEVBQUU3QixPQUFPLEdBQUcrQixPQUFPRjtRQUFHLEdBQ25GO1lBQUU1QyxRQUFRO1FBQUk7SUFFbEI7QUFDRiIsInNvdXJjZXMiOlsiL1VzZXJzL2tpbmdicmFuZC9EZXNrdG9wL2hlYWRsZXNzLXdvby9hcHBzL3dlYi9zcmMvYXBwL2FwaS93b29jb21tZXJjZS9yb3V0ZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBOZXh0UmVxdWVzdCwgTmV4dFJlc3BvbnNlIH0gZnJvbSAnbmV4dC9zZXJ2ZXInO1xuaW1wb3J0IHsgY2FjaGUgfSBmcm9tICdAL2xpYi9jYWNoZSc7XG5pbXBvcnQgeyBXb29TaGlwcGluZ01ldGhvZCB9IGZyb20gJ0AvdHlwZXMvd29vY29tbWVyY2UnO1xuXG4vLyBSZWRpcyBpcyBvcHRpb25hbCAtIHdpbGwgYmUgdW5kZWZpbmVkIGlmIG5vdCBhdmFpbGFibGVcbmNvbnN0IHJlZGlzOiB1bmtub3duID0gdW5kZWZpbmVkO1xuXG5jb25zdCBXQ19VUkwgPSBwcm9jZXNzLmVudi5XT09DT01NRVJDRV9BUElfVVJMO1xuY29uc3QgU0lURV9CQVNFID0gV0NfVVJMID8gV0NfVVJMLnJlcGxhY2UoL1xcL3dwLWpzb25cXC93Y1xcL3YzLiovLCAnJykgOiAnJztcbmNvbnN0IENLID0gcHJvY2Vzcy5lbnYuV09PQ09NTUVSQ0VfQ09OU1VNRVJfS0VZO1xuY29uc3QgQ1MgPSBwcm9jZXNzLmVudi5XT09DT01NRVJDRV9DT05TVU1FUl9TRUNSRVQ7XG5cbi8vIEhhbmRsZSBwYXNzd29yZCByZXNldCB1c2luZyBXb3JkUHJlc3MgUkVTVCBBUElcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVBhc3N3b3JkUmVzZXQoYm9keTogeyBlbWFpbDogc3RyaW5nIH0pIHtcbiAgY29uc3QgeyBlbWFpbCB9ID0gYm9keTtcblxuICBpZiAoIWVtYWlsKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdFbWFpbCBqZXN0IHd5bWFnYW55JyB9LFxuICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgUGFzc3dvcmQgcmVzZXQgcmVxdWVzdCBmb3I6JywgZW1haWwpO1xuICAgIFxuICAgIC8vIFXFvHlqIGN1c3RvbSBtdS1wbHVnaW4gZW5kcG9pbnRcbiAgICBjb25zdCBjdXN0b21VcmwgPSAnaHR0cHM6Ly9xdndsdGpoZGp3LmNmb2xrcy5wbC93cC1qc29uL2N1c3RvbS92MS9wYXNzd29yZC1yZXNldCc7XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChjdXN0b21VcmwsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgSGVhZGxlc3NXb28vMS4wKScsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoeyBlbWFpbCB9KSxcbiAgICB9KTtcblxuICAgIGNvbnNvbGUubG9nKCfwn5SEIEN1c3RvbSBlbmRwb2ludCByZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBDdXN0b20gZW5kcG9pbnQgcmVzcG9uc2UgaGVhZGVyczonLCBPYmplY3QuZnJvbUVudHJpZXMocmVzcG9uc2UuaGVhZGVycy5lbnRyaWVzKCkpKTtcblxuICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgQ3VzdG9tIHBhc3N3b3JkIHJlc2V0IEFQSSByZXNwb25zZTonLCBkYXRhKTtcbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogZGF0YS5zdWNjZXNzLFxuICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UsXG4gICAgICAgIGRlYnVnX2luZm86IGRhdGEuZGVidWdfaW5mb1xuICAgICAgfSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgQ3VzdG9tIHBhc3N3b3JkIHJlc2V0IEFQSSBmYWlsZWQ6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIGNvbnNvbGUubG9nKCfinYwgQ3VzdG9tIGVuZHBvaW50IGVycm9yIHJlc3BvbnNlOicsIGVycm9yVGV4dCk7XG4gICAgICBcbiAgICAgIC8vIEZhbGxiYWNrOiBTcHJhd2TFuiBjenkgdcW8eXRrb3duaWsgaXN0bmllamUgcHJ6ZXogV29vQ29tbWVyY2UgQVBJXG4gICAgICBjb25zdCB3Y1VybCA9ICdodHRwczovL3F2d2x0amhkancuY2ZvbGtzLnBsL3dwLWpzb24vd2MvdjMvY3VzdG9tZXJzJztcbiAgICAgIGNvbnN0IGF1dGggPSAnQmFzaWMgJyArIEJ1ZmZlci5mcm9tKCdja19kZWI2MWVhZGQ3MzAwZWJmYzVmODA3NGNlN2M1M2M2NjY4ZWI3MjVkOmNzXzBkZTE4ZWQwZTAxM2Y5NmFlYmZiNTFjNzdmNTA2YmI5NGU0MTZjYjgnKS50b1N0cmluZygnYmFzZTY0Jyk7XG4gICAgICBcbiAgICAgIGNvbnN0IHdjUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChgJHt3Y1VybH0/ZW1haWw9JHtlbmNvZGVVUklDb21wb25lbnQoZW1haWwpfWAsIHtcbiAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdBdXRob3JpemF0aW9uJzogYXV0aCxcbiAgICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChjb21wYXRpYmxlOyBIZWFkbGVzc1dvby8xLjApJyxcbiAgICAgICAgfSxcbiAgICAgIH0pO1xuXG4gICAgICBpZiAod2NSZXNwb25zZS5vaykge1xuICAgICAgICBjb25zdCBjdXN0b21lckRhdGEgPSBhd2FpdCB3Y1Jlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgY29uc29sZS5sb2coJ+KchSBDdXN0b21lciBmb3VuZCB2aWEgV29vQ29tbWVyY2UgQVBJOicsIGN1c3RvbWVyRGF0YS5sZW5ndGggPiAwKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChjdXN0b21lckRhdGEubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgICAgICAgbWVzc2FnZTogJ1XFvHl0a293bmlrIHpvc3RhxYIgem5hbGV6aW9ueS4gWmUgd3pnbMSZZMOzdyBiZXpwaWVjemXFhHN0d2EsIHNrb250YWt0dWogc2nEmSB6IG9ic8WCdWfEhSBrbGllbnRhIHcgY2VsdSByZXNldG93YW5pYSBoYXPFgmEuJ1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdKZcWbbGkgcG9kYW55IGVtYWlsIGlzdG5pZWplIHcgc3lzdGVtaWUsIG90cnp5bWFzeiBsaW5rIGRvIHJlc2V0b3dhbmlhIGhhc8WCYS4nXG4gICAgICB9KTtcbiAgICB9XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfwn5qoIFBhc3N3b3JkIHJlc2V0IGVycm9yOicsIGVycm9yKTtcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIG1lc3NhZ2U6ICdKZcWbbGkgcG9kYW55IGVtYWlsIGlzdG5pZWplIHcgc3lzdGVtaWUsIG90cnp5bWFzeiBsaW5rIGRvIHJlc2V0b3dhbmlhIGhhc8WCYS4nXG4gICAgfSk7XG4gIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlUGFzc3dvcmRSZXNldENvbmZpcm0oYm9keTogeyBrZXk6IHN0cmluZzsgbG9naW46IHN0cmluZzsgcGFzc3dvcmQ6IHN0cmluZyB9KSB7XG4gIGNvbnN0IHsga2V5LCBsb2dpbiwgcGFzc3dvcmQgfSA9IGJvZHk7XG5cbiAgaWYgKCFrZXkgfHwgIWxvZ2luIHx8ICFwYXNzd29yZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnV3N6eXN0a2llIHBvbGEgc8SFIHd5bWFnYW5lJyB9LFxuICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgUGFzc3dvcmQgcmVzZXQgY29uZmlybSBmb3IgdXNlcjonLCBsb2dpbik7XG4gICAgXG4gICAgLy8gVcW8eWogY3VzdG9tIG11LXBsdWdpbiBlbmRwb2ludFxuICAgIGNvbnN0IGN1c3RvbVVybCA9ICdodHRwczovL3F2d2x0amhkancuY2ZvbGtzLnBsL3dwLWpzb24vY3VzdG9tL3YxL3Jlc2V0LXBhc3N3b3JkJztcbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+UhCBBdHRlbXB0aW5nIHBhc3N3b3JkIHJlc2V0IHdpdGg6JywgeyBrZXk6IGtleS5zdWJzdHJpbmcoMCwgMTApICsgJy4uLicsIGxvZ2luLCBwYXNzd29yZExlbmd0aDogcGFzc3dvcmQubGVuZ3RoIH0pO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goY3VzdG9tVXJsLCB7XG4gICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKGNvbXBhdGlibGU7IEhlYWRsZXNzV29vLzEuMCknLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAga2V5OiBrZXksXG4gICAgICAgIGxvZ2luOiBsb2dpbixcbiAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXG4gICAgICB9KSxcbiAgICB9KTtcbiAgICBcbiAgICBjb25zb2xlLmxvZygn8J+UhCBQYXNzd29yZCByZXNldCByZXNwb25zZSBzdGF0dXM6JywgcmVzcG9uc2Uuc3RhdHVzKTtcblxuICAgIGlmIChyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIGNvbnNvbGUubG9nKCfinIUgUGFzc3dvcmQgcmVzZXQgc3VjY2Vzc2Z1bCBmb3IgdXNlcjonLCBsb2dpbik7XG4gICAgICBcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6ICdIYXPFgm8gem9zdGHFgm8gcG9tecWbbG5pZSB6cmVzZXRvd2FuZSdcbiAgICAgIH0pO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zb2xlLmxvZygn4p2MIFdvcmRQcmVzcyBwYXNzd29yZCByZXNldCBmYWlsZWQ6JywgcmVzcG9uc2Uuc3RhdHVzKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgICBlcnJvcjogJ05pZXByYXdpZMWCb3d5IGx1YiB3eWdhc8WCeSBrbHVjeiByZXNldHVqxIVjeSdcbiAgICAgIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgfVxuXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcign8J+aqCBQYXNzd29yZCByZXNldCBjb25maXJtIGVycm9yOicsIGVycm9yKTtcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogJ1d5c3TEhXBpxYIgYsWCxIVkIHBvZGN6YXMgcmVzZXRvd2FuaWEgaGFzxYJhJ1xuICAgIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gIH1cbn1cblxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDdXN0b21lckludm9pY2VzKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBzZWFyY2hQYXJhbXMgfSA9IG5ldyBVUkwocmVxLnVybCk7XG4gIGNvbnN0IGN1c3RvbWVySWQgPSBzZWFyY2hQYXJhbXMuZ2V0KCdjdXN0b21lcl9pZCcpO1xuICBcbiAgaWYgKCFjdXN0b21lcklkKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdDdXN0b21lciBJRCBqZXN0IHd5bWFnYW55JyB9LFxuICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgRmV0Y2hpbmcgaW52b2ljZXMgZm9yIGN1c3RvbWVyOicsIGN1c3RvbWVySWQpO1xuICAgIFxuICAgIC8vIENhbGwgV29yZFByZXNzIGN1c3RvbSBBUElcbiAgICBjb25zdCBpbnZvaWNlc1VybCA9IGBodHRwczovL3F2d2x0amhkancuY2ZvbGtzLnBsL3dwLWpzb24vY3VzdG9tL3YxL2ludm9pY2VzP2N1c3RvbWVyX2lkPSR7Y3VzdG9tZXJJZH1gO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goaW52b2ljZXNVcmwsIHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChjb21wYXRpYmxlOyBIZWFkbGVzc1dvby8xLjApJyxcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgICBjb25zdCByYXcgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgbGV0IGRhdGE6IGFueSA9IG51bGw7XG4gICAgdHJ5IHsgZGF0YSA9IHJhdyA/IEpTT04ucGFyc2UocmF3KSA6IG51bGw7IH0gY2F0Y2ggKGUpIHsgLyogbm90IGpzb24gKi8gfVxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIGNvbnN0IG1zZyA9IChkYXRhICYmIChkYXRhLmVycm9yIHx8IGRhdGEubWVzc2FnZSkpIHx8IHJhdyB8fCAnQsWCxIVkIHBvYmllcmFuaWEgZmFrdHVyJztcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogU3RyaW5nKG1zZykuc2xpY2UoMCwgMTAwMCkgfSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB8fCA1MDIgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBpbnZvaWNlczogW10gfSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCfinIUgU3VjY2Vzc2Z1bGx5IGZldGNoZWQgaW52b2ljZXMgZm9yIGN1c3RvbWVyOicsIGN1c3RvbWVySWQpO1xuICAgIFxuICAgIGNvbnN0IHJhd0ludm9pY2VzID0gQXJyYXkuaXNBcnJheShkYXRhLmludm9pY2VzKSA/IGRhdGEuaW52b2ljZXMgOiBbXTtcbiAgICBjb25zdCBlbnJpY2hlZCA9IHJhd0ludm9pY2VzLm1hcCgoaW52OiBhbnkpID0+IHtcbiAgICAgIGNvbnN0IGlkID0gaW52LmlkIHx8IGludi5vcmRlcl9pZDtcbiAgICAgIGNvbnN0IGhhc0Rvd25sb2FkID0gaW52LmRvd25sb2FkX3VybCAmJiB0eXBlb2YgaW52LmRvd25sb2FkX3VybCA9PT0gJ3N0cmluZycgJiYgaW52LmRvd25sb2FkX3VybC5sZW5ndGggPiAwO1xuICAgICAgY29uc3QgcGx1Z2luVXJsID0gaWQgPyBgJHtTSVRFX0JBU0V9Lz9hY3Rpb249Z2VuZXJhdGVfd3BvX3djcGRmJmRvY3VtZW50X3R5cGU9aW52b2ljZSZvcmRlcl9pZHM9JHtpZH1gIDogdW5kZWZpbmVkO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uaW52LFxuICAgICAgICBkb3dubG9hZF91cmw6IGhhc0Rvd25sb2FkID8gaW52LmRvd25sb2FkX3VybCA6IHBsdWdpblVybFxuICAgICAgfTtcbiAgICB9KTtcblxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgaW52b2ljZXM6IGVucmljaGVkXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfwn5qoIEVycm9yIGZldGNoaW5nIGN1c3RvbWVyIGludm9pY2VzOicsIGVycm9yKTtcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogJ05pZSB1ZGHFgm8gc2nEmSBwb2JyYcSHIGZha3R1cidcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZU9yZGVyVHJhY2tpbmcocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXEudXJsKTtcbiAgY29uc3Qgb3JkZXJJZCA9IHNlYXJjaFBhcmFtcy5nZXQoJ29yZGVyX2lkJyk7XG4gIFxuICBpZiAoIW9yZGVySWQpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ09yZGVyIElEIGplc3Qgd3ltYWdhbnknIH0sXG4gICAgICB7IHN0YXR1czogNDAwIH1cbiAgICApO1xuICB9XG5cbiAgdHJ5IHtcbiAgICBjb25zb2xlLmxvZygn8J+UhCBGZXRjaGluZyB0cmFja2luZyBmb3Igb3JkZXI6Jywgb3JkZXJJZCk7XG4gICAgXG4gICAgLy8gQ2FsbCBXb3JkUHJlc3MgY3VzdG9tIEFQSVxuICAgIGNvbnN0IHRyYWNraW5nVXJsID0gYGh0dHBzOi8vcXZ3bHRqaGRqdy5jZm9sa3MucGwvd3AtanNvbi9jdXN0b20vdjEvdHJhY2tpbmcvJHtvcmRlcklkfWA7XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh0cmFja2luZ1VybCwge1xuICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgJ1VzZXItQWdlbnQnOiAnTW96aWxsYS81LjAgKGNvbXBhdGlibGU7IEhlYWRsZXNzV29vLzEuMCknLFxuICAgICAgfSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJhdyA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICBsZXQgZGF0YTogYW55ID0gbnVsbDtcbiAgICB0cnkgeyBkYXRhID0gcmF3ID8gSlNPTi5wYXJzZShyYXcpIDogbnVsbDsgfSBjYXRjaCAoZSkgeyAvKiBub3QganNvbiAqLyB9XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgbXNnID0gKGRhdGEgJiYgKGRhdGEuZXJyb3IgfHwgZGF0YS5tZXNzYWdlKSkgfHwgcmF3IHx8ICdCxYLEhWQgcG9iaWVyYW5pYSDFm2xlZHplbmlhJztcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogU3RyaW5nKG1zZykuc2xpY2UoMCwgMTAwMCkgfSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB8fCA1MDIgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBzdWNjZXNzOiB0cnVlLCB0cmFja2luZzoge30gfSk7XG4gICAgfVxuICAgIFxuICAgIGNvbnNvbGUubG9nKCfinIUgU3VjY2Vzc2Z1bGx5IGZldGNoZWQgdHJhY2tpbmcgZm9yIG9yZGVyOicsIG9yZGVySWQpO1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgdHJhY2tpbmc6IGRhdGEudHJhY2tpbmcgfHwge31cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ/CfmqggRXJyb3IgZmV0Y2hpbmcgb3JkZXIgdHJhY2tpbmc6JywgZXJyb3IpO1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnTmllIHVkYcWCbyBzacSZIHBvYnJhxIcgaW5mb3JtYWNqaSBvIMWbbGVkemVuaXUnXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDdXN0b21lclByb2ZpbGVVcGRhdGUoYm9keTogYW55KSB7XG4gIGNvbnN0IHsgY3VzdG9tZXJfaWQsIHByb2ZpbGVfZGF0YSB9ID0gYm9keTtcblxuICBpZiAoIWN1c3RvbWVyX2lkIHx8ICFwcm9maWxlX2RhdGEpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0N1c3RvbWVyIElEIGkgZGFuZSBwcm9maWx1IHPEhSB3eW1hZ2FuZScgfSxcbiAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn5SEIFVwZGF0aW5nIGN1c3RvbWVyIHByb2ZpbGU6JywgY3VzdG9tZXJfaWQpO1xuICAgIFxuICAgIC8vIDEpIFVwZGF0ZSB2aWEgY3VzdG9tIFdQIGVuZHBvaW50IChiZXN0LWVmZm9ydClcbiAgICBsZXQgY3VzdG9tZXJGcm9tQ3VzdG9tOiBhbnkgPSBudWxsO1xuICAgIHRyeSB7XG4gICAgICBjb25zdCB1cGRhdGVVcmwgPSAnaHR0cHM6Ly9xdndsdGpoZGp3LmNmb2xrcy5wbC93cC1qc29uL2N1c3RvbS92MS9jdXN0b21lci91cGRhdGUtcHJvZmlsZSc7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVwZGF0ZVVybCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgSGVhZGxlc3NXb28vMS4wKScsXG4gICAgICAgIH0sXG4gICAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICBjdXN0b21lcl9pZDogY3VzdG9tZXJfaWQsXG4gICAgICAgICAgcHJvZmlsZV9kYXRhOiBwcm9maWxlX2RhdGFcbiAgICAgICAgfSksXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHJhdyA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgIGxldCBkYXRhOiBhbnkgPSBudWxsO1xuICAgICAgdHJ5IHsgZGF0YSA9IHJhdyA/IEpTT04ucGFyc2UocmF3KSA6IG51bGw7IH0gY2F0Y2ggKGUpIHsgLyogbm90IGpzb24gKi8gfVxuICAgICAgaWYgKHJlc3BvbnNlLm9rICYmIGRhdGEgJiYgZGF0YS5zdWNjZXNzKSB7XG4gICAgICAgIGN1c3RvbWVyRnJvbUN1c3RvbSA9IGRhdGEuY3VzdG9tZXIgfHwgbnVsbDtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCfihLnvuI8gQ3VzdG9tIHVwZGF0ZS1wcm9maWxlIGRpZCBub3QgcmV0dXJuIHN1Y2Nlc3MsIGNvbnRpbnVpbmcgd2l0aCBXb28gdXBkYXRlJyk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgY29uc29sZS5sb2coJ+KEue+4jyBDdXN0b20gdXBkYXRlLXByb2ZpbGUgY2FsbCBmYWlsZWQsIGNvbnRpbnVpbmcgd2l0aCBXb28gdXBkYXRlJyk7XG4gICAgfVxuXG4gICAgLy8gMikgRW5zdXJlIHBlcnNpc3RlbmNlIGluIFdvb0NvbW1lcmNlIHZpYSBSRVNUIEFQSSAoUEFUQ0ggY3VzdG9tZXJzL3tpZH0pXG4gICAgaWYgKCFXQ19VUkwgfHwgIUNLIHx8ICFDUykge1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnQnJhayBrb25maWd1cmFjamkgV29vQ29tbWVyY2UgQVBJJyB9LCB7IHN0YXR1czogNTAwIH0pO1xuICAgIH1cblxuICAgIGNvbnN0IHdvb1BheWxvYWQ6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7XG4gICAgICBmaXJzdF9uYW1lOiBwcm9maWxlX2RhdGEuZmlyc3ROYW1lLFxuICAgICAgbGFzdF9uYW1lOiBwcm9maWxlX2RhdGEubGFzdE5hbWUsXG4gICAgICBiaWxsaW5nOiB7XG4gICAgICAgIGZpcnN0X25hbWU6IHByb2ZpbGVfZGF0YS5maXJzdE5hbWUsXG4gICAgICAgIGxhc3RfbmFtZTogcHJvZmlsZV9kYXRhLmxhc3ROYW1lLFxuICAgICAgICBjb21wYW55OiBwcm9maWxlX2RhdGEuYmlsbGluZz8uY29tcGFueSB8fCAnJyxcbiAgICAgICAgcGhvbmU6IHByb2ZpbGVfZGF0YS5iaWxsaW5nPy5waG9uZSB8fCAnJyxcbiAgICAgICAgYWRkcmVzc18xOiBwcm9maWxlX2RhdGEuYmlsbGluZz8uYWRkcmVzcyB8fCAnJyxcbiAgICAgICAgY2l0eTogcHJvZmlsZV9kYXRhLmJpbGxpbmc/LmNpdHkgfHwgJycsXG4gICAgICAgIHBvc3Rjb2RlOiBwcm9maWxlX2RhdGEuYmlsbGluZz8ucG9zdGNvZGUgfHwgJycsXG4gICAgICAgIGNvdW50cnk6IHByb2ZpbGVfZGF0YS5iaWxsaW5nPy5jb3VudHJ5IHx8ICdQTCcsXG4gICAgICAgIGVtYWlsOiB1bmRlZmluZWQsXG4gICAgICB9LFxuICAgICAgc2hpcHBpbmc6IHtcbiAgICAgICAgZmlyc3RfbmFtZTogcHJvZmlsZV9kYXRhLmZpcnN0TmFtZSxcbiAgICAgICAgbGFzdF9uYW1lOiBwcm9maWxlX2RhdGEubGFzdE5hbWUsXG4gICAgICAgIGNvbXBhbnk6IHByb2ZpbGVfZGF0YS5zaGlwcGluZz8uY29tcGFueSB8fCAnJyxcbiAgICAgICAgYWRkcmVzc18xOiBwcm9maWxlX2RhdGEuc2hpcHBpbmc/LmFkZHJlc3MgfHwgJycsXG4gICAgICAgIGNpdHk6IHByb2ZpbGVfZGF0YS5zaGlwcGluZz8uY2l0eSB8fCAnJyxcbiAgICAgICAgcG9zdGNvZGU6IHByb2ZpbGVfZGF0YS5zaGlwcGluZz8ucG9zdGNvZGUgfHwgJycsXG4gICAgICAgIGNvdW50cnk6IHByb2ZpbGVfZGF0YS5zaGlwcGluZz8uY291bnRyeSB8fCAnUEwnLFxuICAgICAgfSxcbiAgICAgIG1ldGFfZGF0YTogW10gYXMgQXJyYXk8eyBrZXk6IHN0cmluZzsgdmFsdWU6IHN0cmluZyB9PixcbiAgICB9O1xuXG4gICAgY29uc3QgbmlwID0gcHJvZmlsZV9kYXRhLmJpbGxpbmc/Lm5pcCB8fCBwcm9maWxlX2RhdGEubmlwO1xuICAgIGNvbnN0IGludm9pY2VSZXEgPSBwcm9maWxlX2RhdGEuYmlsbGluZz8uaW52b2ljZVJlcXVlc3QgPz8gcHJvZmlsZV9kYXRhLmludm9pY2VSZXF1ZXN0O1xuICAgIGlmIChuaXAgIT09IHVuZGVmaW5lZCkge1xuICAgICAgd29vUGF5bG9hZC5tZXRhX2RhdGEucHVzaCh7IGtleTogJ19iaWxsaW5nX25pcCcsIHZhbHVlOiBTdHJpbmcobmlwKSB9KTtcbiAgICB9XG4gICAgaWYgKGludm9pY2VSZXEgIT09IHVuZGVmaW5lZCkge1xuICAgICAgd29vUGF5bG9hZC5tZXRhX2RhdGEucHVzaCh7IGtleTogJ19pbnZvaWNlX3JlcXVlc3QnLCB2YWx1ZTogaW52b2ljZVJlcSA/ICd5ZXMnIDogJ25vJyB9KTtcbiAgICB9XG5cbiAgICBjb25zdCB3b29VcmwgPSBgJHtXQ19VUkx9L2N1c3RvbWVycy8ke2N1c3RvbWVyX2lkfT9jb25zdW1lcl9rZXk9JHtDS30mY29uc3VtZXJfc2VjcmV0PSR7Q1N9YDtcbiAgICBjb25zdCB3b29SZXNwID0gYXdhaXQgZmV0Y2god29vVXJsLCB7XG4gICAgICBtZXRob2Q6ICdQVVQnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgSGVhZGxlc3NXb28vMS4wKScsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkod29vUGF5bG9hZCksXG4gICAgfSk7XG5cbiAgICBjb25zdCB3b29SYXcgPSBhd2FpdCB3b29SZXNwLnRleHQoKTtcbiAgICBsZXQgd29vRGF0YTogYW55ID0gbnVsbDtcbiAgICB0cnkgeyB3b29EYXRhID0gd29vUmF3ID8gSlNPTi5wYXJzZSh3b29SYXcpIDogbnVsbDsgfSBjYXRjaCAoXykgeyAvKiBub3QganNvbiAqLyB9XG4gICAgaWYgKCF3b29SZXNwLm9rKSB7XG4gICAgICBjb25zdCBtc2cgPSAod29vRGF0YSAmJiAod29vRGF0YS5lcnJvciB8fCB3b29EYXRhLm1lc3NhZ2UpKSB8fCB3b29SYXcgfHwgJ0LFgsSFZCBha3R1YWxpemFjamkga2xpZW50YSB3IFdvb0NvbW1lcmNlJztcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogU3RyaW5nKG1zZykuc2xpY2UoMCwgMTAwMCkgfSwgeyBzdGF0dXM6IHdvb1Jlc3Auc3RhdHVzIHx8IDUwMiB9KTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygn4pyFIFdvb0NvbW1lcmNlIGN1c3RvbWVyIHVwZGF0ZWQ6JywgY3VzdG9tZXJfaWQpO1xuXG4gICAgLy8gTWVyZ2UgYmVzdCBhdmFpbGFibGUgY3VzdG9tZXIgZGF0YVxuICAgIGNvbnN0IG1lcmdlZEN1c3RvbWVyID0gY3VzdG9tZXJGcm9tQ3VzdG9tIHx8IHdvb0RhdGE7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiAnUHJvZmlsIHpvc3RhxYIgemFrdHVhbGl6b3dhbnknLFxuICAgICAgY3VzdG9tZXI6IG1lcmdlZEN1c3RvbWVyLFxuICAgIH0pO1xuXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICBjb25zb2xlLmVycm9yKCfwn5qoIEVycm9yIHVwZGF0aW5nIGN1c3RvbWVyIHByb2ZpbGU6JywgZXJyb3IpO1xuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIGVycm9yOiBlcnJvci5tZXNzYWdlIHx8ICdOaWUgdWRhxYJvIHNpxJkgemFrdHVhbGl6b3dhxIcgcHJvZmlsdSdcbiAgICB9LCB7IHN0YXR1czogNTAwIH0pO1xuICB9XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZUN1c3RvbWVyUGFzc3dvcmRDaGFuZ2UoYm9keTogYW55KSB7XG4gIGNvbnN0IHsgY3VzdG9tZXJfaWQsIGN1cnJlbnRfcGFzc3dvcmQsIG5ld19wYXNzd29yZCB9ID0gYm9keTtcblxuICBpZiAoIWN1c3RvbWVyX2lkIHx8ICFjdXJyZW50X3Bhc3N3b3JkIHx8ICFuZXdfcGFzc3dvcmQpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1dzenlzdGtpZSBwb2xhIHPEhSB3eW1hZ2FuZScgfSxcbiAgICAgIHsgc3RhdHVzOiA0MDAgfVxuICAgICk7XG4gIH1cblxuICB0cnkge1xuICAgIGNvbnNvbGUubG9nKCfwn5SEIENoYW5naW5nIGN1c3RvbWVyIHBhc3N3b3JkOicsIGN1c3RvbWVyX2lkKTtcbiAgICBcbiAgICAvLyBDYWxsIFdvcmRQcmVzcyBjdXN0b20gQVBJXG4gICAgY29uc3QgY2hhbmdlUGFzc3dvcmRVcmwgPSAnaHR0cHM6Ly9xdndsdGpoZGp3LmNmb2xrcy5wbC93cC1qc29uL2N1c3RvbS92MS9jdXN0b21lci9jaGFuZ2UtcGFzc3dvcmQnO1xuICAgIFxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goY2hhbmdlUGFzc3dvcmRVcmwsIHtcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nLFxuICAgICAgICAnVXNlci1BZ2VudCc6ICdNb3ppbGxhLzUuMCAoY29tcGF0aWJsZTsgSGVhZGxlc3NXb28vMS4wKScsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBjdXN0b21lcl9pZDogY3VzdG9tZXJfaWQsXG4gICAgICAgIGN1cnJlbnRfcGFzc3dvcmQ6IGN1cnJlbnRfcGFzc3dvcmQsXG4gICAgICAgIG5ld19wYXNzd29yZDogbmV3X3Bhc3N3b3JkXG4gICAgICB9KSxcbiAgICB9KTtcblxuICAgIGNvbnN0IHJhdyA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICBsZXQgZGF0YTogYW55ID0gbnVsbDtcbiAgICB0cnkgeyBkYXRhID0gcmF3ID8gSlNPTi5wYXJzZShyYXcpIDogbnVsbDsgfSBjYXRjaCAoZSkgeyAvKiBub3QganNvbiAqLyB9XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgbXNnID0gcmVzcG9uc2Uuc3RhdHVzID09PSA0MDRcbiAgICAgICAgPyAnRnVua2NqYSB6bWlhbnkgaGFzxYJhIG5pZSBqZXN0IGplc3pjemUgZG9zdMSZcG5hLiBTa29udGFrdHVqIHNpxJkgeiBhZG1pbmlzdHJhdG9yZW0uJ1xuICAgICAgICA6IChkYXRhICYmIChkYXRhLmVycm9yIHx8IGRhdGEubWVzc2FnZSkpIHx8IHJhdyB8fCAnQsWCxIVkIHptaWFueSBoYXPFgmEnO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiBTdHJpbmcobXNnKS5zbGljZSgwLCAxMDAwKSB9LCB7IHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzIHx8IDUwMiB9KTtcbiAgICB9XG5cbiAgICBpZiAoIWRhdGEpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIG1lc3NhZ2U6ICdIYXPFgm8gem9zdGHFgm8gem1pZW5pb25lJyB9KTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ+KchSBTdWNjZXNzZnVsbHkgY2hhbmdlZCBjdXN0b21lciBwYXNzd29yZDonLCBjdXN0b21lcl9pZCk7XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2VcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcign8J+aqCBFcnJvciBjaGFuZ2luZyBjdXN0b21lciBwYXNzd29yZDonLCBlcnJvcik7XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ05pZSB1ZGHFgm8gc2nEmSB6bWllbmnEhyBoYXPFgmEnXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVPcmRlckNyZWF0aW9uKGJvZHk6IGFueSkge1xuICBjb25zdCB7IFxuICAgIGJpbGxpbmcsIFxuICAgIHNoaXBwaW5nLCBcbiAgICBsaW5lX2l0ZW1zLCBcbiAgICBwYXltZW50X21ldGhvZCwgXG4gICAgcGF5bWVudF9tZXRob2RfdGl0bGUsXG4gICAgc2hpcHBpbmdfbGluZXMsXG4gICAgY3VzdG9tZXJfaWQsXG4gICAgY291cG9uX2xpbmVzLFxuICAgIG1ldGFfZGF0YVxuICB9ID0gYm9keTtcblxuICBpZiAoIWJpbGxpbmcgfHwgIWxpbmVfaXRlbXMgfHwgIXBheW1lbnRfbWV0aG9kKSB7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdCcmFrdWplIHd5bWFnYW55Y2ggZGFueWNoIHphbcOzd2llbmlhJyB9LFxuICAgICAgeyBzdGF0dXM6IDQwMCB9XG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgY29uc29sZS5sb2coJ/CflIQgQ3JlYXRpbmcgb3JkZXIgaW4gV29vQ29tbWVyY2UnKTtcbiAgICBjb25zb2xlLmxvZygn8J+OqyBDb3Vwb24gbGluZXMgcmVjZWl2ZWQ6JywgY291cG9uX2xpbmVzKTtcbiAgICBcbiAgICAvLyBQcmVwYXJlIG9yZGVyIGRhdGEgZm9yIFdvb0NvbW1lcmNlXG4gICAgY29uc3Qgb3JkZXJEYXRhOiBhbnkgPSB7XG4gICAgICBwYXltZW50X21ldGhvZDogcGF5bWVudF9tZXRob2QsXG4gICAgICBwYXltZW50X21ldGhvZF90aXRsZTogcGF5bWVudF9tZXRob2RfdGl0bGUgfHwgcGF5bWVudF9tZXRob2QsXG4gICAgICBzZXRfcGFpZDogZmFsc2UsIC8vIFdpbGwgYmUgc2V0IHRvIHRydWUgYWZ0ZXIgcGF5bWVudCBjb25maXJtYXRpb25cbiAgICAgIGN1c3RvbWVyX2lkOiBjdXN0b21lcl9pZCxcbiAgICAgIGJpbGxpbmc6IHtcbiAgICAgICAgZmlyc3RfbmFtZTogYmlsbGluZy5maXJzdE5hbWUsXG4gICAgICAgIGxhc3RfbmFtZTogYmlsbGluZy5sYXN0TmFtZSxcbiAgICAgICAgZW1haWw6IGJpbGxpbmcuZW1haWwsXG4gICAgICAgIHBob25lOiBiaWxsaW5nLnBob25lLFxuICAgICAgICBjb21wYW55OiBiaWxsaW5nLmNvbXBhbnkgfHwgJycsXG4gICAgICAgIGFkZHJlc3NfMTogYmlsbGluZy5hZGRyZXNzLFxuICAgICAgICBjaXR5OiBiaWxsaW5nLmNpdHksXG4gICAgICAgIHN0YXRlOiAnJyxcbiAgICAgICAgcG9zdGNvZGU6IGJpbGxpbmcucG9zdGNvZGUsXG4gICAgICAgIGNvdW50cnk6IGJpbGxpbmcuY291bnRyeSB8fCAnUEwnXG4gICAgICB9LFxuICAgICAgc2hpcHBpbmc6IHNoaXBwaW5nID8ge1xuICAgICAgICBmaXJzdF9uYW1lOiBzaGlwcGluZy5maXJzdE5hbWUsXG4gICAgICAgIGxhc3RfbmFtZTogc2hpcHBpbmcubGFzdE5hbWUsXG4gICAgICAgIGNvbXBhbnk6IHNoaXBwaW5nLmNvbXBhbnkgfHwgJycsXG4gICAgICAgIGFkZHJlc3NfMTogc2hpcHBpbmcuYWRkcmVzcyxcbiAgICAgICAgY2l0eTogc2hpcHBpbmcuY2l0eSxcbiAgICAgICAgc3RhdGU6ICcnLFxuICAgICAgICBwb3N0Y29kZTogc2hpcHBpbmcucG9zdGNvZGUsXG4gICAgICAgIGNvdW50cnk6IHNoaXBwaW5nLmNvdW50cnkgfHwgJ1BMJ1xuICAgICAgfSA6IHtcbiAgICAgICAgZmlyc3RfbmFtZTogYmlsbGluZy5maXJzdE5hbWUsXG4gICAgICAgIGxhc3RfbmFtZTogYmlsbGluZy5sYXN0TmFtZSxcbiAgICAgICAgY29tcGFueTogYmlsbGluZy5jb21wYW55IHx8ICcnLFxuICAgICAgICBhZGRyZXNzXzE6IGJpbGxpbmcuYWRkcmVzcyxcbiAgICAgICAgY2l0eTogYmlsbGluZy5jaXR5LFxuICAgICAgICBzdGF0ZTogJycsXG4gICAgICAgIHBvc3Rjb2RlOiBiaWxsaW5nLnBvc3Rjb2RlLFxuICAgICAgICBjb3VudHJ5OiBiaWxsaW5nLmNvdW50cnkgfHwgJ1BMJ1xuICAgICAgfSxcbiAgICAgIGxpbmVfaXRlbXM6IGxpbmVfaXRlbXMubWFwKChpdGVtOiBhbnkpID0+ICh7XG4gICAgICAgIHByb2R1Y3RfaWQ6IGl0ZW0ucHJvZHVjdF9pZCxcbiAgICAgICAgdmFyaWF0aW9uX2lkOiBpdGVtLnZhcmlhdGlvbl9pZCB8fCAwLFxuICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcbiAgICAgICAgbWV0YV9kYXRhOiBpdGVtLm1ldGFfZGF0YSB8fCBbXVxuICAgICAgfSkpLFxuICAgICAgc2hpcHBpbmdfbGluZXM6IHNoaXBwaW5nX2xpbmVzIHx8IFtdLFxuICAgICAgY291cG9uX2xpbmVzOiBjb3Vwb25fbGluZXMgfHwgW10sXG4gICAgICBtZXRhX2RhdGE6IFtcbiAgICAgICAgLi4uKG1ldGFfZGF0YSB8fCBbXSksXG4gICAgICAgIHsga2V5OiAnX2NyZWF0ZWRfdmlhJywgdmFsdWU6ICdoZWFkbGVzcy13b28nIH0sXG4gICAgICAgIHsga2V5OiAnX29yZGVyX3ZlcnNpb24nLCB2YWx1ZTogJzEuMC4wJyB9XG4gICAgICBdXG4gICAgfTtcblxuXG4gICAgLy8gQ3JlYXRlIG9yZGVyIHZpYSBXb29Db21tZXJjZSBSRVNUIEFQSVxuICAgIGNvbnN0IG9yZGVyVXJsID0gYCR7V0NfVVJMfS9vcmRlcnM/Y29uc3VtZXJfa2V5PSR7Q0t9JmNvbnN1bWVyX3NlY3JldD0ke0NTfWA7XG4gICAgXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChvcmRlclVybCwge1xuICAgICAgbWV0aG9kOiAnUE9TVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdVc2VyLUFnZW50JzogJ01vemlsbGEvNS4wIChjb21wYXRpYmxlOyBIZWFkbGVzc1dvby8xLjApJyxcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShvcmRlckRhdGEpLFxuICAgIH0pO1xuXG4gICAgY29uc3QgcmF3ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIGxldCBkYXRhOiBhbnkgPSBudWxsO1xuICAgIHRyeSB7IGRhdGEgPSByYXcgPyBKU09OLnBhcnNlKHJhdykgOiBudWxsOyB9IGNhdGNoIChlKSB7IC8qIG5vdCBqc29uICovIH1cbiAgICBcbiAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICBjb25zdCBtc2cgPSAoZGF0YSAmJiAoZGF0YS5tZXNzYWdlIHx8IGRhdGEuZXJyb3IpKSB8fCByYXcgfHwgJ0LFgsSFZCB0d29yemVuaWEgemFtw7N3aWVuaWEnO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgXG4gICAgICAgIHN1Y2Nlc3M6IGZhbHNlLCBcbiAgICAgICAgZXJyb3I6IFN0cmluZyhtc2cpLnNsaWNlKDAsIDEwMDApIFxuICAgICAgfSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB8fCA1MDIgfSk7XG4gICAgfVxuXG4gICAgaWYgKCFkYXRhKSB7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBcbiAgICAgICAgc3VjY2VzczogZmFsc2UsIFxuICAgICAgICBlcnJvcjogJ05pZSB1ZGHFgm8gc2nEmSB1dHdvcnp5xIcgemFtw7N3aWVuaWEnIFxuICAgICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG4gICAgXG4gICAgY29uc29sZS5sb2coJ+KchSBTdWNjZXNzZnVsbHkgY3JlYXRlZCBvcmRlcjonLCBkYXRhLmlkKTtcbiAgICBcbiAgICAvLyBUcmlnZ2VyIFdvb0NvbW1lcmNlIGVtYWlscyBhZnRlciBvcmRlciBjcmVhdGlvblxuICAgIHRyeSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+TpyBUcmlnZ2VyaW5nIFdvb0NvbW1lcmNlIGVtYWlscyBmb3Igb3JkZXI6JywgZGF0YS5pZCk7XG4gICAgICBcbiAgICAgIC8vIFVzZSBvdXIgY3VzdG9tIGVtYWlsIEFQSSBlbmRwb2ludFxuICAgICAgY29uc3QgZW1haWxBcGlVcmwgPSBgJHtXQ19VUkx9L3dwLWpzb24va2luZy1lbWFpbC92MS90cmlnZ2VyLW9yZGVyLWVtYWlsYDtcbiAgICAgIGNvbnN0IGVtYWlsUmVzcG9uc2UgPSBhd2FpdCBmZXRjaChlbWFpbEFwaVVybCwge1xuICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIG9yZGVyX2lkOiBkYXRhLmlkXG4gICAgICAgIH0pLFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmIChlbWFpbFJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVtYWlsUmVzdWx0ID0gYXdhaXQgZW1haWxSZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGNvbnNvbGUubG9nKCfinIUgRW1haWwgdHJpZ2dlcmVkIHZpYSBBUEk6JywgZW1haWxSZXN1bHQpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBGYWlsZWQgdG8gdHJpZ2dlciBlbWFpbCB2aWEgQVBJJyk7XG4gICAgICB9XG4gICAgICBcbiAgICB9IGNhdGNoIChlbWFpbEVycm9yKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyb3IgdHJpZ2dlcmluZyBlbWFpbHM6JywgZW1haWxFcnJvcik7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgb3JkZXI6IHtcbiAgICAgICAgaWQ6IGRhdGEuaWQsXG4gICAgICAgIG51bWJlcjogZGF0YS5udW1iZXIsXG4gICAgICAgIHN0YXR1czogZGF0YS5zdGF0dXMsXG4gICAgICAgIHRvdGFsOiBkYXRhLnRvdGFsLFxuICAgICAgICBjdXJyZW5jeTogZGF0YS5jdXJyZW5jeSxcbiAgICAgICAgcGF5bWVudF91cmw6IGRhdGEucGF5bWVudF91cmwsXG4gICAgICAgIGNoZWNrb3V0X3BheW1lbnRfdXJsOiBkYXRhLmNoZWNrb3V0X3BheW1lbnRfdXJsLFxuICAgICAgICBkYXRlX2NyZWF0ZWQ6IGRhdGEuZGF0ZV9jcmVhdGVkLFxuICAgICAgICBiaWxsaW5nOiBkYXRhLmJpbGxpbmcsXG4gICAgICAgIHNoaXBwaW5nOiBkYXRhLnNoaXBwaW5nLFxuICAgICAgICBsaW5lX2l0ZW1zOiBkYXRhLmxpbmVfaXRlbXNcbiAgICAgIH1cbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcjogYW55KSB7XG4gICAgY29uc29sZS5lcnJvcign8J+aqCBFcnJvciBjcmVhdGluZyBvcmRlcjonLCBlcnJvcik7XG4gICAgXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IGZhbHNlLFxuICAgICAgZXJyb3I6IGVycm9yLm1lc3NhZ2UgfHwgJ05pZSB1ZGHFgm8gc2nEmSB1dHdvcnp5xIcgemFtw7N3aWVuaWEnXG4gICAgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgfVxufVxuXG4vLyBIYW5kbGUgYXR0cmlidXRlcyBlbmRwb2ludCAtIFBSTyBBcmNoaXRlY3R1cmU6IER5bmFtaWMgYXR0cmlidXRlcyBiYXNlZCBvbiBmaWx0ZXJzXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVBdHRyaWJ1dGVzRW5kcG9pbnQocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXEudXJsKTtcbiAgXG4gIGlmICghV0NfVVJMIHx8ICFDSyB8fCAhQ1MpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnQsWCxIVkIGtvbmZpZ3VyYWNqaSBzZXJ3ZXJhJywgZGV0YWlsczogJ0JyYWt1amUgem1pZW5ueWNoIMWbcm9kb3dpc2tvd3ljaCBXb29Db21tZXJjZScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIFBSTyBBcmNoaXRlY3R1cmU6IFdvcmRQcmVzcyByb2JpIGNhxYJlIGZpbHRyb3dhbmllIGF0cnlidXTDs3dcbiAgICBjb25zdCBhdHRyaWJ1dGVzVXJsID0gYGh0dHBzOi8vcXZ3bHRqaGRqdy5jZm9sa3MucGwvd3AtanNvbi9raW5nLXNob3AvdjEvYXR0cmlidXRlcz8ke3NlYXJjaFBhcmFtcy50b1N0cmluZygpfWA7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/Cfj7fvuI8gQXR0cmlidXRlcyBlbmRwb2ludCAtIGNhbGxpbmcgS2luZyBTaG9wIEFQSTonLCBhdHRyaWJ1dGVzVXJsKTtcbiAgICBcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGF0dHJpYnV0ZXNVcmwsIHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdVc2VyLUFnZW50JzogJ0ZpbGxlci1TdG9yZS8xLjAnXG4gICAgICB9LFxuICAgICAgY2FjaGU6ICduby1zdG9yZSdcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCfinIUgQXR0cmlidXRlcyBkYXRhIHJlY2VpdmVkIGZyb20gV29yZFByZXNzOicsIHtcbiAgICAgIGF0dHJpYnV0ZXM6IGRhdGEuYXR0cmlidXRlcyA/IE9iamVjdC5rZXlzKGRhdGEuYXR0cmlidXRlcykubGVuZ3RoIDogMCxcbiAgICAgIHRvdGFsX3Byb2R1Y3RzOiBkYXRhLnRvdGFsX3Byb2R1Y3RzIHx8IDBcbiAgICB9KTtcblxuICAgIC8vIFdvcmRQcmVzcyB6cm9iacWCIGNhxYJlIGZpbHRyb3dhbmllIC0gendyYWNhbXkgZGFuZSBqYWsgc8SFXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGRhdGEsIHtcbiAgICAgIHN0YXR1czogMjAwLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgXCJDYWNoZS1Db250cm9sXCI6IFwicHVibGljLCBtYXgtYWdlPTYwLCBzLW1heGFnZT0xMjAsIHN0YWxlLXdoaWxlLXJldmFsaWRhdGU9MzAwXCIsXG4gICAgICAgIFwiWC1DYWNoZVwiOiBcIk1JU1NcIixcbiAgICAgIH0sXG4gICAgfSk7XG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgQXR0cmlidXRlcyBlbmRwb2ludCBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ05pZSB1ZGHFgm8gc2nEmSBwb2JyYcSHIGF0cnlidXTDs3cnLCBkZXRhaWxzOiBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IubWVzc2FnZSA6ICdOaWV6bmFueSBixYLEhWQnIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbi8vIEhhbmRsZSBzaG9wIGVuZHBvaW50IC0gUFJPIEFyY2hpdGVjdHVyZTogV29yZFByZXNzIHJvYmkgY2HFgmUgZmlsdHJvd2FuaWVcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVNob3BFbmRwb2ludChyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcS51cmwpO1xuICBcbiAgaWYgKCFXQ19VUkwgfHwgIUNLIHx8ICFDUykge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdCxYLEhWQga29uZmlndXJhY2ppIHNlcndlcmEnLCBkZXRhaWxzOiAnQnJha3VqZSB6bWllbm55Y2ggxZtyb2Rvd2lza293eWNoIFdvb0NvbW1lcmNlJyB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxuXG4gIHRyeSB7XG4gICAgLy8gUFJPIEFyY2hpdGVjdHVyZTogV29yZFByZXNzIHJvYmkgY2HFgmUgZmlsdHJvd2FuaWVcbiAgICAvLyBOZXh0LmpzIHR5bGtvIHByemVrYXp1amUgcGFyYW1ldHJ5IGkgY2FjaGUndWplIG9kcG93aWVkxbpcbiAgICBjb25zdCBzaG9wVXJsID0gYGh0dHBzOi8vcXZ3bHRqaGRqdy5jZm9sa3MucGwvd3AtanNvbi9raW5nLXNob3AvdjEvZGF0YT8ke3NlYXJjaFBhcmFtcy50b1N0cmluZygpfWA7XG4gICAgXG4gICAgY29uc29sZS5sb2coJ/Cfm43vuI8gU2hvcCBlbmRwb2ludCAtIGNhbGxpbmcgS2luZyBTaG9wIEFQSTonLCBzaG9wVXJsKTtcbiAgICBcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHNob3BVcmwsIHtcbiAgICAgIG1ldGhvZDogJ0dFVCcsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdVc2VyLUFnZW50JzogJ0ZpbGxlci1TdG9yZS8xLjAnXG4gICAgICB9LFxuICAgICAgY2FjaGU6ICduby1zdG9yZSdcbiAgICB9KTtcblxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgSFRUUCBlcnJvciEgc3RhdHVzOiAke3Jlc3BvbnNlLnN0YXR1c31gKTtcbiAgICB9XG5cbiAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIFxuICAgIGNvbnNvbGUubG9nKCfinIUgU2hvcCBkYXRhIHJlY2VpdmVkIGZyb20gV29yZFByZXNzOicsIHtcbiAgICAgIHByb2R1Y3RzOiBkYXRhLnByb2R1Y3RzPy5sZW5ndGggfHwgMCxcbiAgICAgIHRvdGFsOiBkYXRhLnRvdGFsLFxuICAgICAgY2F0ZWdvcmllczogZGF0YS5jYXRlZ29yaWVzPy5sZW5ndGggfHwgMCxcbiAgICAgIGF0dHJpYnV0ZXM6IGRhdGEuYXR0cmlidXRlcyA/IE9iamVjdC5rZXlzKGRhdGEuYXR0cmlidXRlcykubGVuZ3RoIDogMFxuICAgIH0pO1xuXG4gICAgLy8gV29yZFByZXNzIHpyb2JpxYIgY2HFgmUgZmlsdHJvd2FuaWUgLSB6d3JhY2FteSBkYW5lIGphayBzxIVcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oZGF0YSwge1xuICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICBcIkNhY2hlLUNvbnRyb2xcIjogXCJwdWJsaWMsIG1heC1hZ2U9NjAsIHMtbWF4YWdlPTEyMCwgc3RhbGUtd2hpbGUtcmV2YWxpZGF0ZT0zMDBcIixcbiAgICAgICAgXCJYLUNhY2hlXCI6IFwiTUlTU1wiLFxuICAgICAgfSxcbiAgICB9KTtcblxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBTaG9wIGVuZHBvaW50IGVycm9yOicsIGVycm9yKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnTmllIHVkYcWCbyBzacSZIHBvYnJhxIcgZGFueWNoIHNrbGVwdScsIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ05pZXpuYW55IGLFgsSFZCcgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cbn1cblxuLy8gSGFuZGxlIHNoaXBwaW5nIG1ldGhvZHMgZW5kcG9pbnRcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVNoaXBwaW5nTWV0aG9kcyhyZXE6IE5leHRSZXF1ZXN0KSB7XG4gIGNvbnN0IHsgc2VhcmNoUGFyYW1zIH0gPSBuZXcgVVJMKHJlcS51cmwpO1xuICBjb25zdCBjb3VudHJ5ID0gc2VhcmNoUGFyYW1zLmdldChcImNvdW50cnlcIikgfHwgXCJQTFwiO1xuICBjb25zdCBzdGF0ZSA9IHNlYXJjaFBhcmFtcy5nZXQoXCJzdGF0ZVwiKSB8fCBcIlwiO1xuICBjb25zdCBjaXR5ID0gc2VhcmNoUGFyYW1zLmdldChcImNpdHlcIikgfHwgXCJcIjtcbiAgY29uc3QgcG9zdGNvZGUgPSBzZWFyY2hQYXJhbXMuZ2V0KFwicG9zdGNvZGVcIikgfHwgXCJcIjtcbiAgXG4gIGlmICghV0NfVVJMIHx8ICFDSyB8fCAhQ1MpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnQsWCxIVkIGtvbmZpZ3VyYWNqaSBzZXJ3ZXJhJywgZGV0YWlsczogJ0JyYWt1amUgem1pZW5ueWNoIMWbcm9kb3dpc2tvd3ljaCBXb29Db21tZXJjZScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cblxuICB0cnkge1xuICAgIC8vIEdldCBzaGlwcGluZyB6b25lcyBhbmQgbWV0aG9kcyBmcm9tIFdvb0NvbW1lcmNlXG4gICAgY29uc3Qgc2hpcHBpbmdab25lc1VybCA9IGAke1dDX1VSTH0vc2hpcHBpbmcvem9uZXM/Y29uc3VtZXJfa2V5PSR7Q0t9JmNvbnN1bWVyX3NlY3JldD0ke0NTfWA7XG4gICAgY29uc3Qgem9uZXNSZXNwb25zZSA9IGF3YWl0IGZldGNoKHNoaXBwaW5nWm9uZXNVcmwsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgQWNjZXB0OiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICdVc2VyLUFnZW50JzogJ0ZpbGxlci1TdG9yZS8xLjAnXG4gICAgICB9XG4gICAgfSk7XG4gICAgXG4gICAgaWYgKCF6b25lc1Jlc3BvbnNlLm9rKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYE5pZSB1ZGHFgm8gc2nEmSBwb2JyYcSHIHN0cmVmIHd5c3nFgmtpOiAke3pvbmVzUmVzcG9uc2Uuc3RhdHVzfWApO1xuICAgIH1cbiAgICBcbiAgICAvLyBIYXJkZW4gYWdhaW5zdCBIVE1ML25vbi1KU09OIHJlc3BvbnNlc1xuICAgIGNvbnN0IHpvbmVzVGV4dCA9IGF3YWl0IHpvbmVzUmVzcG9uc2UudGV4dCgpO1xuICAgIGxldCB6b25lc1BhcnNlZDogQXJyYXk8eyBpZDogbnVtYmVyOyBuYW1lOiBzdHJpbmcgfT47IFxuICAgIHRyeSB7XG4gICAgICB6b25lc1BhcnNlZCA9IEpTT04ucGFyc2Uoem9uZXNUZXh0KTtcbiAgICB9IGNhdGNoIChfKSB7XG4gICAgICBjb25zb2xlLmVycm9yKCdTaGlwcGluZyB6b25lcyByZXR1cm5lZCBub24tSlNPTiAodHJ1bmNhdGVkKTonLCB6b25lc1RleHQuc3Vic3RyaW5nKDAsIDIwMCkpO1xuICAgICAgem9uZXNQYXJzZWQgPSBbXSBhcyBhbnk7XG4gICAgfVxuICAgIGNvbnN0IHpvbmVzID0gQXJyYXkuaXNBcnJheSh6b25lc1BhcnNlZCkgPyB6b25lc1BhcnNlZCA6IFtdO1xuICAgIFxuICAgIC8vIEdldCBtZXRob2RzIGZvciBlYWNoIHpvbmVcbiAgICBjb25zdCBzaGlwcGluZ01ldGhvZHM6IEFycmF5PHtcbiAgICAgIGlkOiBzdHJpbmc7XG4gICAgICBtZXRob2RfaWQ6IHN0cmluZztcbiAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICBjb3N0OiBzdHJpbmc7XG4gICAgICB6b25lX2lkOiBudW1iZXI7XG4gICAgICB6b25lX25hbWU6IHN0cmluZztcbiAgICB9PiA9IFtdO1xuICAgIFxuICAgIGZvciAoY29uc3Qgem9uZSBvZiB6b25lcykge1xuICAgICAgY29uc3QgbWV0aG9kc1VybCA9IGAke1dDX1VSTH0vc2hpcHBpbmcvem9uZXMvJHt6b25lLmlkfS9tZXRob2RzP2NvbnN1bWVyX2tleT0ke0NLfSZjb25zdW1lcl9zZWNyZXQ9JHtDU31gO1xuICAgICAgY29uc3QgbWV0aG9kc1Jlc3BvbnNlID0gYXdhaXQgZmV0Y2gobWV0aG9kc1VybCk7XG4gICAgICBcbiAgICAgIGlmIChtZXRob2RzUmVzcG9uc2Uub2spIHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gYXdhaXQgbWV0aG9kc1Jlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgbGV0IG1ldGhvZHM6IEFycmF5PHtcbiAgICAgICAgICBpZDogc3RyaW5nO1xuICAgICAgICAgIG1ldGhvZF9pZDogc3RyaW5nO1xuICAgICAgICAgIHRpdGxlOiBzdHJpbmc7XG4gICAgICAgICAgY29zdDogc3RyaW5nO1xuICAgICAgICAgIGVuYWJsZWQ6IGJvb2xlYW47XG4gICAgICAgIH0+ID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBQcmVmZXIgbmF0aXZlIEpTT04gcGFyc2luZyBmaXJzdFxuICAgICAgICB0cnkge1xuICAgICAgICAgIG1ldGhvZHMgPSBhd2FpdCBKU09OLnBhcnNlKHJlc3BvbnNlVGV4dCk7XG4gICAgICAgIH0gY2F0Y2ggKF8pIHtcbiAgICAgICAgICAvLyBJZiBwYXJzaW5nIGZhaWxzIGR1ZSB0byByYXcgSFRNTCBpbnNpZGUgZmllbGRzIChlLmcuIG1ldGhvZF9kZXNjcmlwdGlvbiksXG4gICAgICAgICAgLy8gc2FuaXRpemUgdGhlIHBheWxvYWQgYnkgc3RyaXBwaW5nIEhUTUwtYmVhcmluZyBwcm9wZXJ0aWVzIGJlZm9yZSBwYXJzaW5nIGFnYWluLlxuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBzYW5pdGl6ZWQgPSByZXNwb25zZVRleHRcbiAgICAgICAgICAgICAgLy8gUmVtb3ZlL2VtcHR5IG1ldGhvZF9kZXNjcmlwdGlvbiBIVE1MIGJsb2JzIHRoYXQgY2FuIGJyZWFrIEpTT05cbiAgICAgICAgICAgICAgLnJlcGxhY2UoL1wibWV0aG9kX2Rlc2NyaXB0aW9uXCJcXHMqOlxccypcIltcXHNcXFNdKj9cIig/PSx8XFx9fFxcXSkvZywgJ1wibWV0aG9kX2Rlc2NyaXB0aW9uXCI6XCJcIicpXG4gICAgICAgICAgICAgIC8vIEVuc3VyZSBtZXRob2RfdGl0bGUgaXMgYSBmbGF0IHN0cmluZyAoc3RyaXAgdGFncyBpZiBhbnkpXG4gICAgICAgICAgICAgIC5yZXBsYWNlKC9cIm1ldGhvZF90aXRsZVwiXFxzKjpcXHMqXCIoW1xcc1xcU10qPylcIi9nLCAoX20sIGcxKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2xlYW4gPSBTdHJpbmcoZzEpLnJlcGxhY2UoLzxbXj5dKj4vZywgJyAnKS5yZXBsYWNlKC9cXHMrL2csICcgJykudHJpbSgpO1xuICAgICAgICAgICAgICAgIHJldHVybiBgXCJtZXRob2RfdGl0bGVcIjpcIiR7Y2xlYW59XCJgO1xuICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIG1ldGhvZHMgPSBKU09OLnBhcnNlKHNhbml0aXplZCk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ05pZSB1ZGHFgm8gc2nEmSBiZXpwaWVjem5pZSBzcGFyc293YcSHIG1ldG9kIHd5c3nFgmtpOicsIGVycm9yKTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSB0ZXh0ICh0cnVuY2F0ZWQpOicsIHJlc3BvbnNlVGV4dC5zdWJzdHJpbmcoMCwgMjAwKSk7XG4gICAgICAgICAgICBtZXRob2RzID0gW107XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGZvciAoY29uc3QgbWV0aG9kIG9mIG1ldGhvZHMpIHtcbiAgICAgICAgICBpZiAobWV0aG9kLmVuYWJsZWQpIHtcbiAgICAgICAgICAgIHNoaXBwaW5nTWV0aG9kcy5wdXNoKHtcbiAgICAgICAgICAgICAgaWQ6IG1ldGhvZC5pZCxcbiAgICAgICAgICAgICAgbWV0aG9kX2lkOiBtZXRob2QubWV0aG9kX2lkLFxuICAgICAgICAgICAgICB0aXRsZTogbWV0aG9kLnRpdGxlLFxuICAgICAgICAgICAgICBjb3N0OiBtZXRob2QuY29zdCB8fCAnMCcsXG4gICAgICAgICAgICAgIHpvbmVfaWQ6IHpvbmUuaWQsXG4gICAgICAgICAgICAgIHpvbmVfbmFtZTogem9uZS5uYW1lLFxuICAgICAgICAgICAgICAvLyBBZGRpdGlvbmFsIHByb3BlcnRpZXMgZm9yIGludGVybmFsIHVzZVxuICAgICAgICAgICAgICBtZXRob2RfdGl0bGU6IChtZXRob2QgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLm1ldGhvZF90aXRsZSBhcyBzdHJpbmcgfHwgbWV0aG9kLnRpdGxlLFxuICAgICAgICAgICAgICBtZXRob2RfZGVzY3JpcHRpb246IChtZXRob2QgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4pLm1ldGhvZF9kZXNjcmlwdGlvbiBhcyBzdHJpbmcgfHwgJycsXG4gICAgICAgICAgICAgIHNldHRpbmdzOiAobWV0aG9kIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5zZXR0aW5ncyBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiB8fCB7fSxcbiAgICAgICAgICAgICAgem9uZV9sb2NhdGlvbnM6ICh6b25lIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5sb2NhdGlvbnMgYXMgdW5rbm93bltdIHx8IFtdXG4gICAgICAgICAgICB9IGFzIFdvb1NoaXBwaW5nTWV0aG9kKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gUHJvY2VzcyBhbmQgbm9ybWFsaXplIHNoaXBwaW5nIG1ldGhvZHMgKHNhbWUgbG9naWMgYXMgaW4gc2VydmljZSlcbiAgICBjb25zdCBwcm9jZXNzZWRNZXRob2RzID0gc2hpcHBpbmdNZXRob2RzLm1hcCgobWV0aG9kOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPikgPT4ge1xuICAgICAgbGV0IGNvc3QgPSAwO1xuICAgICAgbGV0IGZyZWVTaGlwcGluZ1RocmVzaG9sZCA9IDA7XG4gICAgICBcbiAgICAgIC8vIEhhbmRsZSBGbGV4aWJsZSBTaGlwcGluZyBtZXRob2RzXG4gICAgICBpZiAobWV0aG9kLm1ldGhvZF9pZCA9PT0gJ2ZsZXhpYmxlX3NoaXBwaW5nX3NpbmdsZScpIHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBtZXRob2Quc2V0dGluZ3MgfHwge307XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZnJlZSBzaGlwcGluZyB0aHJlc2hvbGRcbiAgICAgICAgaWYgKChzZXR0aW5ncyBhcyBhbnkpLm1ldGhvZF9mcmVlX3NoaXBwaW5nICYmIChzZXR0aW5ncyBhcyBhbnkpLm1ldGhvZF9mcmVlX3NoaXBwaW5nLnZhbHVlKSB7XG4gICAgICAgICAgZnJlZVNoaXBwaW5nVGhyZXNob2xkID0gcGFyc2VGbG9hdCgoc2V0dGluZ3MgYXMgYW55KS5tZXRob2RfZnJlZV9zaGlwcGluZy52YWx1ZSk7IC8vIEtlZXAgYXMgUExOLCBub3QgY2VudHNcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGNvc3QgZnJvbSBydWxlc1xuICAgICAgICBpZiAoKHNldHRpbmdzIGFzIGFueSkubWV0aG9kX3J1bGVzICYmIChzZXR0aW5ncyBhcyBhbnkpLm1ldGhvZF9ydWxlcy52YWx1ZSAmJiAoc2V0dGluZ3MgYXMgYW55KS5tZXRob2RfcnVsZXMudmFsdWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgIGNvbnN0IHJ1bGVzID0gKHNldHRpbmdzIGFzIGFueSkubWV0aG9kX3J1bGVzLnZhbHVlO1xuICAgICAgICAgIC8vIEZpbmQgdGhlIHJ1bGUgdGhhdCBhcHBsaWVzICh1c3VhbGx5IHRoZSBmaXJzdCBvbmUpXG4gICAgICAgICAgaWYgKHJ1bGVzWzBdICYmIHJ1bGVzWzBdLmNvc3RfcGVyX29yZGVyKSB7XG4gICAgICAgICAgICBjb3N0ID0gcGFyc2VGbG9hdChydWxlc1swXS5jb3N0X3Blcl9vcmRlcik7IC8vIEtlZXAgYXMgUExOLCBub3QgY2VudHNcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIC8vIEhhbmRsZSBGbGF0IFJhdGUgbWV0aG9kc1xuICAgICAgZWxzZSBpZiAobWV0aG9kLm1ldGhvZF9pZCA9PT0gJ2ZsYXRfcmF0ZScpIHtcbiAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBtZXRob2Quc2V0dGluZ3MgfHwge307XG4gICAgICAgIGlmICgoc2V0dGluZ3MgYXMgYW55KS5jb3N0ICYmIChzZXR0aW5ncyBhcyBhbnkpLmNvc3QudmFsdWUpIHtcbiAgICAgICAgICBjb3N0ID0gcGFyc2VGbG9hdCgoc2V0dGluZ3MgYXMgYW55KS5jb3N0LnZhbHVlKTsgLy8gS2VlcCBhcyBQTE4sIG5vdCBjZW50c1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENsZWFuIEhUTUwgZnJvbSBkZXNjcmlwdGlvblxuICAgICAgY29uc3QgY2xlYW5EZXNjcmlwdGlvbiA9IChkZXNjOiBzdHJpbmcpID0+IHtcbiAgICAgICAgaWYgKCFkZXNjKSByZXR1cm4gJyc7XG4gICAgICAgIC8vIFJlbW92ZSBIVE1MIHRhZ3MgYW5kIGRlY29kZSBlbnRpdGllc1xuICAgICAgICByZXR1cm4gZGVzY1xuICAgICAgICAgIC5yZXBsYWNlKC88W14+XSo+L2csICcnKSAvLyBSZW1vdmUgSFRNTCB0YWdzXG4gICAgICAgICAgLnJlcGxhY2UoLyZyYXJyOy9nLCAn4oaSJykgLy8gRGVjb2RlIGFycm93XG4gICAgICAgICAgLnJlcGxhY2UoLyZuYnNwOy9nLCAnICcpIC8vIERlY29kZSBub24tYnJlYWtpbmcgc3BhY2VcbiAgICAgICAgICAucmVwbGFjZSgvJmFtcDsvZywgJyYnKSAvLyBEZWNvZGUgYW1wZXJzYW5kXG4gICAgICAgICAgLnJlcGxhY2UoLyZsdDsvZywgJzwnKSAvLyBEZWNvZGUgbGVzcyB0aGFuXG4gICAgICAgICAgLnJlcGxhY2UoLyZndDsvZywgJz4nKSAvLyBEZWNvZGUgZ3JlYXRlciB0aGFuXG4gICAgICAgICAgLnJlcGxhY2UoLyZxdW90Oy9nLCAnXCInKSAvLyBEZWNvZGUgcXVvdGVcbiAgICAgICAgICAudHJpbSgpO1xuICAgICAgfTtcblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IG1ldGhvZC5pZCxcbiAgICAgICAgbWV0aG9kX2lkOiBtZXRob2QubWV0aG9kX2lkLFxuICAgICAgICBtZXRob2RfdGl0bGU6IChtZXRob2Quc2V0dGluZ3MgYXMgYW55KT8ubWV0aG9kX3RpdGxlPy52YWx1ZSB8fCBtZXRob2QubWV0aG9kX3RpdGxlLFxuICAgICAgICBtZXRob2RfZGVzY3JpcHRpb246IGNsZWFuRGVzY3JpcHRpb24oKG1ldGhvZC5zZXR0aW5ncyBhcyBhbnkpPy5tZXRob2RfZGVzY3JpcHRpb24/LnZhbHVlIHx8IG1ldGhvZC5tZXRob2RfZGVzY3JpcHRpb24pLFxuICAgICAgICBjb3N0OiBjb3N0LFxuICAgICAgICBmcmVlX3NoaXBwaW5nX3RocmVzaG9sZDogZnJlZVNoaXBwaW5nVGhyZXNob2xkLFxuICAgICAgICB6b25lX2lkOiBtZXRob2Quem9uZV9pZCxcbiAgICAgICAgem9uZV9uYW1lOiBtZXRob2Quem9uZV9uYW1lLFxuICAgICAgICBzZXR0aW5nczogbWV0aG9kLnNldHRpbmdzXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgLy8gRmFsbGJhY2s6IGlmIG5vIG1ldGhvZHMgZm91bmQsIHByb3ZpZGUgc2Vuc2libGUgZGVmYXVsdHMgc28gY2hlY2tvdXQgcmVtYWlucyB1c2FibGVcbiAgICBjb25zdCBtZXRob2RzT3V0ID0gQXJyYXkuaXNBcnJheShwcm9jZXNzZWRNZXRob2RzKSAmJiBwcm9jZXNzZWRNZXRob2RzLmxlbmd0aCA+IDBcbiAgICAgID8gcHJvY2Vzc2VkTWV0aG9kc1xuICAgICAgOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICdmcmVlX3NoaXBwaW5nX2RlZmF1bHQnLFxuICAgICAgICAgICAgbWV0aG9kX2lkOiAnZnJlZV9zaGlwcGluZycsXG4gICAgICAgICAgICBtZXRob2RfdGl0bGU6ICdEYXJtb3dhIGRvc3Rhd2EnLFxuICAgICAgICAgICAgbWV0aG9kX2Rlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgICAgIGNvc3Q6IDAsXG4gICAgICAgICAgICBmcmVlX3NoaXBwaW5nX3RocmVzaG9sZDogMCxcbiAgICAgICAgICAgIHpvbmVfaWQ6IDAsXG4gICAgICAgICAgICB6b25lX25hbWU6ICdEb215xZtsbmEnLFxuICAgICAgICAgICAgc2V0dGluZ3M6IHt9XG4gICAgICAgICAgfSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICBpZDogJ2ZsYXRfcmF0ZV9kZWZhdWx0JyxcbiAgICAgICAgICAgIG1ldGhvZF9pZDogJ2ZsYXRfcmF0ZScsXG4gICAgICAgICAgICBtZXRob2RfdGl0bGU6ICdEb3N0YXdhIHN0YW5kYXJkb3dhJyxcbiAgICAgICAgICAgIG1ldGhvZF9kZXNjcmlwdGlvbjogJycsXG4gICAgICAgICAgICBjb3N0OiAxNSxcbiAgICAgICAgICAgIGZyZWVfc2hpcHBpbmdfdGhyZXNob2xkOiAwLFxuICAgICAgICAgICAgem9uZV9pZDogMCxcbiAgICAgICAgICAgIHpvbmVfbmFtZTogJ0RvbXnFm2xuYScsXG4gICAgICAgICAgICBzZXR0aW5nczoge31cbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGlkOiAnbG9jYWxfcGlja3VwX2RlZmF1bHQnLFxuICAgICAgICAgICAgbWV0aG9kX2lkOiAnbG9jYWxfcGlja3VwJyxcbiAgICAgICAgICAgIG1ldGhvZF90aXRsZTogJ09kYmnDs3Igb3NvYmlzdHknLFxuICAgICAgICAgICAgbWV0aG9kX2Rlc2NyaXB0aW9uOiAnJyxcbiAgICAgICAgICAgIGNvc3Q6IDAsXG4gICAgICAgICAgICBmcmVlX3NoaXBwaW5nX3RocmVzaG9sZDogMCxcbiAgICAgICAgICAgIHpvbmVfaWQ6IDAsXG4gICAgICAgICAgICB6b25lX25hbWU6ICdEb215xZtsbmEnLFxuICAgICAgICAgICAgc2V0dGluZ3M6IHt9XG4gICAgICAgICAgfVxuICAgICAgICBdO1xuXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBzaGlwcGluZ19tZXRob2RzOiBtZXRob2RzT3V0LFxuICAgICAgY291bnRyeSxcbiAgICAgIHN0YXRlLFxuICAgICAgY2l0eSxcbiAgICAgIHBvc3Rjb2RlXG4gICAgfSk7XG4gICAgXG4gIH0gY2F0Y2ggKGVycm9yOiB1bmtub3duKSB7XG4gICAgY29uc29sZS5lcnJvcignU2hpcHBpbmcgbWV0aG9kcyBBUEkgZXJyb3I6JywgZXJyb3IpO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdOaWUgdWRhxYJvIHNpxJkgcG9icmHEhyBtZXRvZCB3eXN5xYJraScsIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogU3RyaW5nKGVycm9yKSB9LFxuICAgICAgeyBzdGF0dXM6IDUwMCB9XG4gICAgKTtcbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVDb3Vwb25zKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXEudXJsKTtcbiAgICBjb25zdCBjb2RlID0gc2VhcmNoUGFyYW1zLmdldCgnY29kZScpO1xuICAgIFxuICAgIGlmICghV0NfVVJMIHx8ICFDSyB8fCAhQ1MpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnQnJhayBrb25maWd1cmFjamkgV29vQ29tbWVyY2UnIH0sIHsgc3RhdHVzOiA1MDAgfSk7XG4gICAgfVxuXG4gICAgLy8gSWYgc3BlY2lmaWMgY29kZSByZXF1ZXN0ZWQsIHZhbGlkYXRlIGl0XG4gICAgaWYgKGNvZGUpIHtcbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7V0NfVVJMfS9jb3Vwb25zP2NvZGU9JHtlbmNvZGVVUklDb21wb25lbnQoY29kZSl9JnN0YXR1cz1hY3RpdmVgLCB7XG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnQXV0aG9yaXphdGlvbic6IGBCYXNpYyAke0J1ZmZlci5mcm9tKGAke0NLfToke0NTfWApLnRvU3RyaW5nKCdiYXNlNjQnKX1gLFxuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgICBcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdOaWVwcmF3aWTFgm93eSBrb2QgcmFiYXRvd3knIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIGNvbnN0IGNvdXBvbnMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICBcbiAgICAgIGlmIChjb3Vwb25zLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ05pZXByYXdpZMWCb3d5IGtvZCByYWJhdG93eScgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgY291cG9uID0gY291cG9uc1swXTtcbiAgICAgIFxuICAgICAgLy8gQ2hlY2sgaWYgY291cG9uIGlzIHN0aWxsIHZhbGlkXG4gICAgICBpZiAoY291cG9uLnVzYWdlX2xpbWl0ICYmIGNvdXBvbi51c2FnZV9jb3VudCA+PSBjb3Vwb24udXNhZ2VfbGltaXQpIHtcbiAgICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHsgZXJyb3I6ICdLb2QgcmFiYXRvd3kgem9zdGHFgiBqdcW8IHd5a29yenlzdGFueScgfSwgeyBzdGF0dXM6IDQwMCB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgaWYgKGNvdXBvbi5kYXRlX2V4cGlyZXMgJiYgbmV3IERhdGUoY291cG9uLmRhdGVfZXhwaXJlcykgPCBuZXcgRGF0ZSgpKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnS29kIHJhYmF0b3d5IHd5Z2FzxYInIH0sIHsgc3RhdHVzOiA0MDAgfSk7XG4gICAgICB9XG4gICAgICBcbiAgICAgIC8vIENoZWNrIHBlci11c2VyIHVzYWdlIGxpbWl0XG4gICAgICBpZiAoY291cG9uLnVzYWdlX2xpbWl0X3Blcl91c2VyICYmIGNvdXBvbi51c2FnZV9saW1pdF9wZXJfdXNlciA+IDApIHtcbiAgICAgICAgLy8gRm9yIG5vdywgd2UnbGwgcmVseSBvbiBXb29Db21tZXJjZSB0byBlbmZvcmNlIHRoaXMgd2hlbiBjcmVhdGluZyB0aGUgb3JkZXJcbiAgICAgICAgLy8gVGhlIHVzZWRfYnkgYXJyYXkgd2lsbCBiZSBjaGVja2VkIGJ5IFdvb0NvbW1lcmNlIEFQSVxuICAgICAgICBjb25zb2xlLmxvZygn4oS577iPIENvdXBvbiBoYXMgcGVyLXVzZXIgbGltaXQ6JywgY291cG9uLnVzYWdlX2xpbWl0X3Blcl91c2VyKTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgY291cG9uOiB7XG4gICAgICAgICAgaWQ6IGNvdXBvbi5pZCxcbiAgICAgICAgICBjb2RlOiBjb3Vwb24uY29kZSxcbiAgICAgICAgICBkaXNjb3VudF90eXBlOiBjb3Vwb24uZGlzY291bnRfdHlwZSxcbiAgICAgICAgICBhbW91bnQ6IHBhcnNlRmxvYXQoY291cG9uLmFtb3VudCksXG4gICAgICAgICAgbWluaW11bV9hbW91bnQ6IGNvdXBvbi5taW5pbXVtX2Ftb3VudCA/IHBhcnNlRmxvYXQoY291cG9uLm1pbmltdW1fYW1vdW50KSA6IG51bGwsXG4gICAgICAgICAgbWF4aW11bV9hbW91bnQ6IGNvdXBvbi5tYXhpbXVtX2Ftb3VudCA/IHBhcnNlRmxvYXQoY291cG9uLm1heGltdW1fYW1vdW50KSA6IG51bGwsXG4gICAgICAgICAgdXNhZ2VfbGltaXQ6IGNvdXBvbi51c2FnZV9saW1pdCxcbiAgICAgICAgICB1c2FnZV9jb3VudDogY291cG9uLnVzYWdlX2NvdW50LFxuICAgICAgICAgIGRhdGVfZXhwaXJlczogY291cG9uLmRhdGVfZXhwaXJlc1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgLy8gUmV0dXJuIGFsbCBhY3RpdmUgY291cG9ucyAoZm9yIGFkbWluIHB1cnBvc2VzKVxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goYCR7V0NfVVJMfS9jb3Vwb25zP3N0YXR1cz1hY3RpdmUmX2ZpZWxkcz1pZCxjb2RlLGRpc2NvdW50X3R5cGUsYW1vdW50LG1pbmltdW1fYW1vdW50LG1heGltdW1fYW1vdW50LHVzYWdlX2xpbWl0LHVzYWdlX2NvdW50LGRhdGVfZXhwaXJlc2AsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmFzaWMgJHtCdWZmZXIuZnJvbShgJHtDS306JHtDU31gKS50b1N0cmluZygnYmFzZTY0Jyl9YCxcbiAgICAgIH0sXG4gICAgfSk7XG4gICAgXG4gICAgY29uc3QgY291cG9ucyA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICBcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGNvdXBvbnM6IGNvdXBvbnMubWFwKChjb3Vwb246IGFueSkgPT4gKHtcbiAgICAgICAgaWQ6IGNvdXBvbi5pZCxcbiAgICAgICAgY29kZTogY291cG9uLmNvZGUsXG4gICAgICAgIGRpc2NvdW50X3R5cGU6IGNvdXBvbi5kaXNjb3VudF90eXBlLFxuICAgICAgICBhbW91bnQ6IHBhcnNlRmxvYXQoY291cG9uLmFtb3VudCksXG4gICAgICAgIG1pbmltdW1fYW1vdW50OiBjb3Vwb24ubWluaW11bV9hbW91bnQgPyBwYXJzZUZsb2F0KGNvdXBvbi5taW5pbXVtX2Ftb3VudCkgOiBudWxsLFxuICAgICAgICBtYXhpbXVtX2Ftb3VudDogY291cG9uLm1heGltdW1fYW1vdW50ID8gcGFyc2VGbG9hdChjb3Vwb24ubWF4aW11bV9hbW91bnQpIDogbnVsbCxcbiAgICAgICAgdXNhZ2VfbGltaXQ6IGNvdXBvbi51c2FnZV9saW1pdCxcbiAgICAgICAgdXNhZ2VfY291bnQ6IGNvdXBvbi51c2FnZV9jb3VudCxcbiAgICAgICAgZGF0ZV9leHBpcmVzOiBjb3Vwb24uZGF0ZV9leHBpcmVzXG4gICAgICB9KSlcbiAgICB9KTtcbiAgICBcbiAgfSBjYXRjaCAoZXJyb3I6IHVua25vd24pIHtcbiAgICBjb25zb2xlLmVycm9yKCdDb3Vwb25zIEFQSSBlcnJvcjonLCBlcnJvcik7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogJ05pZSB1ZGHFgm8gc2nEmSBwb2JyYcSHIGt1cG9uw7N3JywgZGV0YWlsczogZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpIH0sXG4gICAgICB7IHN0YXR1czogNTAwIH1cbiAgICApO1xuICB9XG59XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBHRVQocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXEudXJsKTtcbiAgY29uc3QgZW5kcG9pbnQgPSBzZWFyY2hQYXJhbXMuZ2V0KFwiZW5kcG9pbnRcIikgfHwgXCJwcm9kdWN0c1wiO1xuICBjb25zdCBieXBhc3NDYWNoZSA9IHNlYXJjaFBhcmFtcy5nZXQoXCJjYWNoZVwiKSA9PT0gXCJvZmZcIjtcbiAgXG4gIC8vIE9wdGltaXplZCBwcm9kdWN0IGVuZHBvaW50XG4gIGlmIChlbmRwb2ludC5zdGFydHNXaXRoKCdraW5nLW9wdGltaXplZC9wcm9kdWN0LycpKSB7XG4gICAgY29uc3Qgc2x1ZyA9IGVuZHBvaW50LnJlcGxhY2UoJ2tpbmctb3B0aW1pemVkL3Byb2R1Y3QvJywgJycpO1xuICAgIGNvbnN0IHVybCA9IGAke3Byb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1dPUkRQUkVTU19VUkx9L3dwLWpzb24va2luZy1vcHRpbWl6ZWQvdjEvcHJvZHVjdC8ke3NsdWd9YDtcbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICAgICAgaGVhZGVyczogeyAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24nIH0sXG4gICAgICAgIGNhY2hlOiBieXBhc3NDYWNoZSA/ICduby1zdG9yZScgOiAnZGVmYXVsdCdcbiAgICAgIH0pO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1Byb2R1Y3Qgbm90IGZvdW5kJyB9LCB7IHN0YXR1czogcmVzcG9uc2Uuc3RhdHVzIH0pO1xuICAgICAgfVxuICAgICAgXG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKGRhdGEpO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gQ3VzdG9tZXIgcHJvZmlsZSBlbmRwb2ludFxuICBpZiAoZW5kcG9pbnQuc3RhcnRzV2l0aCgnY3VzdG9tZXJzLycpKSB7XG4gICAgY29uc3QgY3VzdG9tZXJJZCA9IGVuZHBvaW50LnJlcGxhY2UoJ2N1c3RvbWVycy8nLCAnJyk7XG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmdldCgnYXV0aG9yaXphdGlvbicpO1xuICAgIFxuICAgIGlmICghYXV0aEhlYWRlciB8fCAhYXV0aEhlYWRlci5zdGFydHNXaXRoKCdCZWFyZXIgJykpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkJyB9LCB7IHN0YXR1czogNDAxIH0pO1xuICAgIH1cbiAgICBcbiAgICB0cnkge1xuICAgICAgY29uc29sZS5sb2coJ/CflIQgRmV0Y2hpbmcgY3VzdG9tZXIgZGF0YSBmb3IgSUQ6JywgY3VzdG9tZXJJZCk7XG4gICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGAke1dDX1VSTH0vY3VzdG9tZXJzLyR7Y3VzdG9tZXJJZH0/Y29uc3VtZXJfa2V5PSR7Q0t9JmNvbnN1bWVyX3NlY3JldD0ke0NTfWAsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJ1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIFxuICAgICAgY29uc29sZS5sb2coJ/CflI0gQ3VzdG9tZXIgQVBJIHJlc3BvbnNlIHN0YXR1czonLCByZXNwb25zZS5zdGF0dXMpO1xuICAgICAgXG4gICAgICBpZiAoIXJlc3BvbnNlLm9rKSB7XG4gICAgICAgIGNvbnN0IGVycm9yVGV4dCA9IGF3YWl0IHJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgY29uc29sZS5lcnJvcign4p2MIEN1c3RvbWVyIEFQSSBlcnJvcjonLCBlcnJvclRleHQpO1xuICAgICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogJ0N1c3RvbWVyIG5vdCBmb3VuZCcgfSwgeyBzdGF0dXM6IHJlc3BvbnNlLnN0YXR1cyB9KTtcbiAgICAgIH1cbiAgICAgIFxuICAgICAgY29uc3QgY3VzdG9tZXJEYXRhID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgY29uc29sZS5sb2coJ+KchSBDdXN0b21lciBkYXRhIGZldGNoZWQ6JywgY3VzdG9tZXJEYXRhKTtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihjdXN0b21lckRhdGEpO1xuICAgIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ+KdjCBDdXN0b21lciBmZXRjaCBlcnJvcjonLCBlcnJvcik7XG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oeyBlcnJvcjogZXJyb3IubWVzc2FnZSB9LCB7IHN0YXR1czogNTAwIH0pO1xuICAgIH1cbiAgfVxuICBcbiAgLy8gUGF5bWVudCBnYXRld2F5c1xuICBpZiAoZW5kcG9pbnQgPT09ICdwYXltZW50X2dhdGV3YXlzJykge1xuICAgIGlmICghV0NfVVJMIHx8ICFDSyB8fCAhQ1MpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0JyYWsga29uZmlndXJhY2ppIFdvb0NvbW1lcmNlIEFQSScgfSwgeyBzdGF0dXM6IDUwMCB9KTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVybCA9IGAke1dDX1VSTH0vcGF5bWVudF9nYXRld2F5cz9jb25zdW1lcl9rZXk9JHtDS30mY29uc3VtZXJfc2VjcmV0PSR7Q1N9YDtcbiAgICAgIGNvbnN0IHIgPSBhd2FpdCBmZXRjaCh1cmwsIHsgaGVhZGVyczogeyBBY2NlcHQ6ICdhcHBsaWNhdGlvbi9qc29uJywgJ1VzZXItQWdlbnQnOiAnRmlsbGVyLVN0b3JlLzEuMCcgfSwgY2FjaGU6ICduby1zdG9yZScgfSk7XG4gICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgci50ZXh0KCk7XG4gICAgICBsZXQgZGF0YTogYW55ID0gbnVsbDsgdHJ5IHsgZGF0YSA9IHRleHQgPyBKU09OLnBhcnNlKHRleHQpIDogbnVsbDsgfSBjYXRjaCAoXykge31cbiAgICAgIGlmICghci5vaykge1xuICAgICAgICBjb25zdCBtc2cgPSAoZGF0YSAmJiAoZGF0YS5tZXNzYWdlIHx8IGRhdGEuZXJyb3IpKSB8fCB0ZXh0IHx8ICdCxYLEhWQgcG9iaWVyYW5pYSBtZXRvZCBwxYJhdG5vxZtjaSc7XG4gICAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogU3RyaW5nKG1zZykuc2xpY2UoMCwgMTAwMCkgfSwgeyBzdGF0dXM6IHIuc3RhdHVzIHx8IDUwMiB9KTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IHRydWUsIGdhdGV3YXlzOiBBcnJheS5pc0FycmF5KGRhdGEpID8gZGF0YSA6IFtdIH0pO1xuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogZSBpbnN0YW5jZW9mIEVycm9yID8gZS5tZXNzYWdlIDogU3RyaW5nKGUpIH0sIHsgc3RhdHVzOiA1MDIgfSk7XG4gICAgfVxuICB9XG5cbiAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igc2hpcHBpbmcgbWV0aG9kc1xuICBpZiAoZW5kcG9pbnQgPT09IFwic2hpcHBpbmdfbWV0aG9kc1wiKSB7XG4gICAgcmV0dXJuIGhhbmRsZVNoaXBwaW5nTWV0aG9kcyhyZXEpO1xuICB9XG4gIFxuICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBjb3Vwb25zXG4gIGlmIChlbmRwb2ludCA9PT0gXCJjb3Vwb25zXCIpIHtcbiAgICByZXR1cm4gaGFuZGxlQ291cG9ucyhyZXEpO1xuICB9XG4gIFxuICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBhdHRyaWJ1dGVzIGVuZHBvaW50IC0gUFJPIEFyY2hpdGVjdHVyZVxuICBpZiAoZW5kcG9pbnQgPT09IFwiYXR0cmlidXRlc1wiKSB7XG4gICAgcmV0dXJuIGhhbmRsZUF0dHJpYnV0ZXNFbmRwb2ludChyZXEpO1xuICB9XG4gIFxuICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBzaG9wIGVuZHBvaW50IC0gdXNlIG5ldyBLaW5nIFNob3AgQVBJXG4gIGlmIChlbmRwb2ludCA9PT0gXCJzaG9wXCIpIHtcbiAgICByZXR1cm4gaGFuZGxlU2hvcEVuZHBvaW50KHJlcSk7XG4gIH1cbiAgXG4gIGlmICghV0NfVVJMIHx8ICFDSyB8fCAhQ1MpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiAnQsWCxIVkIGtvbmZpZ3VyYWNqaSBzZXJ3ZXJhJywgZGV0YWlsczogJ0JyYWt1amUgem1pZW5ueWNoIMWbcm9kb3dpc2tvd3ljaCBXb29Db21tZXJjZScgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxuICAgICk7XG4gIH1cblxuICAvLyBSYXRlIGxpbWl0aW5nXG4gIGNvbnN0IGlwID0gcmVxLmhlYWRlcnMuZ2V0KCd4LWZvcndhcmRlZC1mb3InKSB8fCByZXEuaGVhZGVycy5nZXQoJ3gtcmVhbC1pcCcpIHx8ICd1bmtub3duJztcbiAgY29uc3QgcmF0ZUxpbWl0ID0gY2FjaGUuY2hlY2tSYXRlTGltaXQoaXApO1xuICBcbiAgaWYgKCFyYXRlTGltaXQuYWxsb3dlZCkge1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcbiAgICAgIHsgZXJyb3I6ICdQcnpla3JvY3pvbm8gbGltaXQgemFweXRhxYQnLCByZXRyeUFmdGVyOiBNYXRoLmNlaWwoKHJhdGVMaW1pdC5yZXNldEF0IC0gRGF0ZS5ub3coKSkgLyAxMDAwKSB9LFxuICAgICAgeyBcbiAgICAgICAgc3RhdHVzOiA0MjksXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAnUmV0cnktQWZ0ZXInOiBNYXRoLmNlaWwoKHJhdGVMaW1pdC5yZXNldEF0IC0gRGF0ZS5ub3coKSkgLyAxMDAwKS50b1N0cmluZygpLFxuICAgICAgICAgICdYLVJhdGVMaW1pdC1MaW1pdCc6ICcxMDAnLFxuICAgICAgICAgICdYLVJhdGVMaW1pdC1SZW1haW5pbmcnOiAnMCcsXG4gICAgICAgICAgJ1gtUmF0ZUxpbWl0LVJlc2V0JzogcmF0ZUxpbWl0LnJlc2V0QXQudG9TdHJpbmcoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7V0NfVVJMLnJlcGxhY2UoL1xcLyQvLCBcIlwiKX0vJHtlbmRwb2ludH1gKTtcbiAgc2VhcmNoUGFyYW1zLmZvckVhY2goKHYsIGspID0+IHtcbiAgICBpZiAoayAhPT0gXCJlbmRwb2ludFwiICYmIGsgIT09IFwiY2FjaGVcIikgdXJsLnNlYXJjaFBhcmFtcy5zZXQoaywgdik7XG4gIH0pO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcImNvbnN1bWVyX2tleVwiLCBDSyB8fCAnJyk7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY29uc3VtZXJfc2VjcmV0XCIsIENTIHx8ICcnKTtcblxuICBjb25zb2xlLmxvZygn8J+UjSBBUEkgUm91dGUgRGVidWc6Jyk7XG4gIGNvbnNvbGUubG9nKCdXQ19VUkw6JywgV0NfVVJMKTtcbiAgY29uc29sZS5sb2coJ0NLOicsIENLID8gJ1NFVCcgOiAnTk9UIFNFVCcpO1xuICBjb25zb2xlLmxvZygnQ1M6JywgQ1MgPyAnU0VUJyA6ICdOT1QgU0VUJyk7XG4gIGNvbnNvbGUubG9nKCdGaW5hbCBVUkw6JywgdXJsLnRvU3RyaW5nKCkpO1xuICBjb25zb2xlLmxvZygnQnlwYXNzIGNhY2hlOicsIGJ5cGFzc0NhY2hlKTtcbiAgY29uc29sZS5sb2coJ1NlYXJjaCBwYXJhbXM6JywgT2JqZWN0LmZyb21FbnRyaWVzKHNlYXJjaFBhcmFtcy5lbnRyaWVzKCkpKTtcblxuICB0cnkge1xuICAgIC8vIENhY2hlIGxvb2t1cCAoc2tpcCBpZiBieXBhc3MpXG4gICAgY29uc3QgY2FjaGVLZXkgPSBjYWNoZS5nZW5lcmF0ZUtleSh1cmwudG9TdHJpbmcoKSk7XG4gICAgbGV0IGNhY2hlZCA9IG51bGw7XG4gICAgXG4gICAgaWYgKCFieXBhc3NDYWNoZSkge1xuICAgICAgY2FjaGVkID0gYXdhaXQgY2FjaGUuZ2V0KGNhY2hlS2V5KTtcbiAgICB9XG4gICAgXG4gICAgaWYgKGNhY2hlZCkge1xuICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoY2FjaGVkLmJvZHksIHtcbiAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICBcIkNhY2hlLUNvbnRyb2xcIjogYHB1YmxpYywgbWF4LWFnZT0zMCwgcy1tYXhhZ2U9NjBgLFxuICAgICAgICAgIFwiRVRhZ1wiOiBjYWNoZWQuZXRhZyxcbiAgICAgICAgICBcIlgtQ2FjaGVcIjogXCJISVRcIixcbiAgICAgICAgICBcIlgtUmF0ZUxpbWl0LUxpbWl0XCI6IFwiMTAwXCIsXG4gICAgICAgICAgXCJYLVJhdGVMaW1pdC1SZW1haW5pbmdcIjogcmF0ZUxpbWl0LnJlbWFpbmluZy50b1N0cmluZygpLFxuICAgICAgICAgIFwiWC1SYXRlTGltaXQtUmVzZXRcIjogcmF0ZUxpbWl0LnJlc2V0QXQudG9TdHJpbmcoKSxcbiAgICAgICAgICAuLi5jYWNoZWQuaGVhZGVyc1xuICAgICAgICB9LFxuICAgICAgfSk7XG4gICAgfVxuXG4gICAgLy8gUmV0cnkgbG9naWMgZm9yIGJldHRlciByZWxpYWJpbGl0eVxuICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGw7XG4gICAgZm9yIChsZXQgYXR0ZW1wdCA9IDE7IGF0dGVtcHQgPD0gMzsgYXR0ZW1wdCsrKSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zb2xlLmxvZyhg8J+UhCBBdHRlbXB0ICR7YXR0ZW1wdH0gZm9yICR7dXJsLnRvU3RyaW5nKCl9YCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByID0gYXdhaXQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHtcbiAgICAgICAgICBoZWFkZXJzOiB7IFxuICAgICAgICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICdVc2VyLUFnZW50JzogJ0ZpbGxlci1TdG9yZS8xLjAnXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjYWNoZTogXCJuby1zdG9yZVwiLFxuICAgICAgICB9KTtcblxuICAgICAgICBjb25zdCB0ZXh0ID0gYXdhaXQgci50ZXh0KCk7XG4gICAgICAgIGlmICghci5vaykge1xuICAgICAgICAgIGNvbnNvbGUubG9nKGDinYwgSFRUUCAke3Iuc3RhdHVzfTogJHt0ZXh0fWApO1xuICAgICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKHRleHQgfHwgci5zdGF0dXNUZXh0LCB7XG4gICAgICAgICAgICBzdGF0dXM6IHIuc3RhdHVzLFxuICAgICAgICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiByLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpIHx8IFwidGV4dC9wbGFpblwiIH0sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBpZiByZXNwb25zZSBpcyBIVE1MIGluc3RlYWQgb2YgSlNPTiAoV29yZFByZXNzIGVycm9yIHBhZ2UpXG4gICAgICAgIGlmICh0ZXh0LnRyaW0oKS5zdGFydHNXaXRoKCc8IURPQ1RZUEUgaHRtbD4nKSB8fCB0ZXh0LnRyaW0oKS5zdGFydHNXaXRoKCc8aHRtbCcpKSB7XG4gICAgICAgICAgY29uc29sZS5sb2coYOKdjCBXb3JkUHJlc3MgcmV0dXJuZWQgSFRNTCBpbnN0ZWFkIG9mIEpTT046ICR7dGV4dC5zdWJzdHJpbmcoMCwgMTAwKX0uLi5gKTtcbiAgICAgICAgICBcbiAgICAgICAgICAvLyBUcnkgdG8gZ2V0IGNhY2hlZCBkYXRhIGZpcnN0XG4gICAgICAgICAgaWYgKCFieXBhc3NDYWNoZSAmJiByZWRpcyAmJiB0eXBlb2YgKHJlZGlzIGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+KS5nZXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGNhY2hlZERhdGEgPSBhd2FpdCAocmVkaXMgYXMgYW55KS5nZXQoY2FjaGVLZXkpIGFzIHN0cmluZztcbiAgICAgICAgICAgICAgaWYgKGNhY2hlZERhdGEpIHtcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygn4pyFIFVzaW5nIGNhY2hlZCBkYXRhIGFzIGZhbGxiYWNrJyk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UoY2FjaGVkRGF0YSwge1xuICAgICAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICAgICAgICBoZWFkZXJzOiB7ICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgICAgICAgY29uc29sZS5sb2coJ+KaoO+4jyBSZWRpcyBub3QgYXZhaWxhYmxlLCBza2lwcGluZyBjYWNoZSBmYWxsYmFjaycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBcbiAgICAgICAgICAvLyBSZXRyeSB0aGUgcmVxdWVzdCBvbmNlIG1vcmVcbiAgICAgICAgICBjb25zb2xlLmxvZygn8J+UhCBSZXRyeWluZyByZXF1ZXN0Li4uJyk7XG4gICAgICAgICAgY29uc3QgcmV0cnlSZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgICAgICAgICAgbWV0aG9kOiAnR0VUJyxcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgJ0NvbnRlbnQtVHlwZSc6ICdhcHBsaWNhdGlvbi9qc29uJyxcbiAgICAgICAgICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICAgJ1VzZXItQWdlbnQnOiAnRmlsbGVyLVN0b3JlLzEuMCdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBjYWNoZTogXCJuby1zdG9yZVwiLFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIFxuICAgICAgICAgIGlmIChyZXRyeVJlc3BvbnNlLm9rKSB7XG4gICAgICAgICAgICBjb25zdCByZXRyeVRleHQgPSBhd2FpdCByZXRyeVJlc3BvbnNlLnRleHQoKTtcbiAgICAgICAgICAgIGlmICghcmV0cnlUZXh0LnRyaW0oKS5zdGFydHNXaXRoKCc8IURPQ1RZUEUgaHRtbD4nKSAmJiAhcmV0cnlUZXh0LnRyaW0oKS5zdGFydHNXaXRoKCc8aHRtbCcpKSB7XG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKCfinIUgUmV0cnkgc3VjY2Vzc2Z1bCwgcmV0dXJuaW5nIGRhdGEnKTtcbiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBOZXh0UmVzcG9uc2UocmV0cnlUZXh0LCB7XG4gICAgICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICAgICAgaGVhZGVyczogeyAnY29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nIH1cbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgIC8vIFJldHVybiBlbXB0eSBkYXRhIGluc3RlYWQgb2YgZXJyb3IgdG8gcHJldmVudCBhcHAgY3Jhc2hlc1xuICAgICAgICAgIGNvbnNvbGUubG9nKCfimqDvuI8gUmV0dXJuaW5nIGVtcHR5IGRhdGEgYXMgZmFsbGJhY2snKTtcbiAgICAgICAgICBjb25zdCBlbXB0eVJlc3BvbnNlID0ge1xuICAgICAgICAgICAgZGF0YTogW10sXG4gICAgICAgICAgICB0b3RhbDogMCxcbiAgICAgICAgICAgIHRvdGFsUGFnZXM6IDAsXG4gICAgICAgICAgICBjdXJyZW50UGFnZTogMSxcbiAgICAgICAgICAgIHBlclBhZ2U6IDEwLFxuICAgICAgICAgICAgZXJyb3I6ICdBUEkgdHltY3phc293byBuaWVkb3N0xJlwbmUnXG4gICAgICAgICAgfTtcbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZShKU09OLnN0cmluZ2lmeShlbXB0eVJlc3BvbnNlKSwge1xuICAgICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgICBoZWFkZXJzOiB7ICdjb250ZW50LXR5cGUnOiAnYXBwbGljYXRpb24vanNvbicgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFN1Y2Nlc3Mgb24gYXR0ZW1wdCAke2F0dGVtcHR9YCk7XG4gICAgICAgIFxuICAgICAgICAvLyBQb3B1bGF0ZSBjYWNoZSAoc2tpcCBpZiBieXBhc3MpXG4gICAgICAgIGlmICghYnlwYXNzQ2FjaGUpIHtcbiAgICAgICAgICBhd2FpdCBjYWNoZS5zZXQoY2FjaGVLZXksIHRleHQsIDYwMDAwLCB7XG4gICAgICAgICAgICAnWC1SZXNwb25zZS1UaW1lJzogYCR7RGF0ZS5ub3coKSAtIERhdGUubm93KCl9bXNgLFxuICAgICAgICAgICAgJ1gtQXR0ZW1wdCc6IGF0dGVtcHQudG9TdHJpbmcoKVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zdCBldGFnID0gY2FjaGUuZ2VuZXJhdGVFVGFnKHRleHQpO1xuICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZSh0ZXh0LCB7XG4gICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgXCJjb250ZW50LXR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBcIkNhY2hlLUNvbnRyb2xcIjogYHB1YmxpYywgbWF4LWFnZT0zMCwgcy1tYXhhZ2U9NjBgLFxuICAgICAgICAgICAgXCJFVGFnXCI6IGV0YWcsXG4gICAgICAgICAgICBcIlgtQ2FjaGVcIjogYnlwYXNzQ2FjaGUgPyBcIkJZUEFTU1wiIDogXCJNSVNTXCIsXG4gICAgICAgICAgICBcIlgtUmF0ZUxpbWl0LUxpbWl0XCI6IFwiMTAwXCIsXG4gICAgICAgICAgICBcIlgtUmF0ZUxpbWl0LVJlbWFpbmluZ1wiOiByYXRlTGltaXQucmVtYWluaW5nLnRvU3RyaW5nKCksXG4gICAgICAgICAgICBcIlgtUmF0ZUxpbWl0LVJlc2V0XCI6IHJhdGVMaW1pdC5yZXNldEF0LnRvU3RyaW5nKCksXG4gICAgICAgICAgfSxcbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsYXN0RXJyb3IgPSBlcnJvciBhcyBFcnJvcjtcbiAgICAgICAgY29uc29sZS5sb2coYOKdjCBBdHRlbXB0ICR7YXR0ZW1wdH0gZmFpbGVkOmAsIGVycm9yKTtcbiAgICAgICAgXG4gICAgICAgIGlmIChhdHRlbXB0IDwgMykge1xuICAgICAgICAgIC8vIFdhaXQgYmVmb3JlIHJldHJ5IChleHBvbmVudGlhbCBiYWNrb2ZmKVxuICAgICAgICAgIGF3YWl0IG5ldyBQcm9taXNlKHJlc29sdmUgPT4gc2V0VGltZW91dChyZXNvbHZlLCBhdHRlbXB0ICogMTAwMCkpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEFsbCBhdHRlbXB0cyBmYWlsZWRcbiAgICB0aHJvdyBsYXN0RXJyb3I7XG4gIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICBjb25zb2xlLmVycm9yKCfwn5qoIEFsbCBhdHRlbXB0cyBmYWlsZWQ6JywgZSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKFxuICAgICAgeyBlcnJvcjogXCJCxYLEhWQgc2Vyd2VyYSBwcm94eVwiLCBtZXNzYWdlOiBlIGluc3RhbmNlb2YgRXJyb3IgPyBlLm1lc3NhZ2UgOiBTdHJpbmcoZSkgfSxcbiAgICAgIHsgc3RhdHVzOiA1MDIgfVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxOiBOZXh0UmVxdWVzdCkge1xuICBjb25zdCB7IHNlYXJjaFBhcmFtcyB9ID0gbmV3IFVSTChyZXEudXJsKTtcbiAgY29uc3QgZW5kcG9pbnQgPSBzZWFyY2hQYXJhbXMuZ2V0KFwiZW5kcG9pbnRcIikgfHwgXCJwcm9kdWN0c1wiO1xuXG4gIGNvbnNvbGUubG9nKCfwn5SEIFBPU1QgcmVxdWVzdCB0byBlbmRwb2ludDonLCBlbmRwb2ludCk7XG5cbiAgdHJ5IHtcbiAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVxLmpzb24oKTtcblxuICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIHBhc3N3b3JkIHJlc2V0XG4gICAgaWYgKGVuZHBvaW50ID09PSAnY3VzdG9tZXJzL3Bhc3N3b3JkLXJlc2V0Jykge1xuICAgICAgY29uc29sZS5sb2coJ/CflIQgSGFuZGxpbmcgcGFzc3dvcmQgcmVzZXQgcmVxdWVzdCcpO1xuICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZVBhc3N3b3JkUmVzZXQoYm9keSk7XG4gICAgfVxuXG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgcGFzc3dvcmQgcmVzZXQgY29uZmlybWF0aW9uXG4gICAgaWYgKGVuZHBvaW50ID09PSAnY3VzdG9tZXJzL3Jlc2V0LXBhc3N3b3JkJykge1xuICAgICAgY29uc29sZS5sb2coJ/CflIQgSGFuZGxpbmcgcGFzc3dvcmQgcmVzZXQgY29uZmlybSByZXF1ZXN0Jyk7XG4gICAgICByZXR1cm4gYXdhaXQgaGFuZGxlUGFzc3dvcmRSZXNldENvbmZpcm0oYm9keSk7XG4gICAgfVxuXG5cbiAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBjdXN0b21lciBpbnZvaWNlc1xuICAgIGlmIChlbmRwb2ludCA9PT0gJ2N1c3RvbWVycy9pbnZvaWNlcycpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIEhhbmRsaW5nIGN1c3RvbWVyIGludm9pY2VzIHJlcXVlc3QnKTtcbiAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVDdXN0b21lckludm9pY2VzKHJlcSk7XG4gICAgfVxuXG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3Igb3JkZXIgY3JlYXRpb25cbiAgICBpZiAoZW5kcG9pbnQgPT09ICdvcmRlcnMnKSB7XG4gICAgICBjb25zb2xlLmxvZygn8J+UhCBIYW5kbGluZyBvcmRlciBjcmVhdGlvbiByZXF1ZXN0Jyk7XG4gICAgICByZXR1cm4gYXdhaXQgaGFuZGxlT3JkZXJDcmVhdGlvbihib2R5KTtcbiAgICB9XG5cbiAgICAvLyBTcGVjaWFsIGhhbmRsaW5nIGZvciBvcmRlciB0cmFja2luZ1xuICAgIGlmIChlbmRwb2ludCA9PT0gJ29yZGVycy90cmFja2luZycpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIEhhbmRsaW5nIG9yZGVyIHRyYWNraW5nIHJlcXVlc3QnKTtcbiAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVPcmRlclRyYWNraW5nKHJlcSk7XG4gICAgfVxuXG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgY3VzdG9tZXIgcHJvZmlsZSB1cGRhdGVcbiAgICBpZiAoZW5kcG9pbnQgPT09ICdjdXN0b21lci91cGRhdGUtcHJvZmlsZScpIHtcbiAgICAgIGNvbnNvbGUubG9nKCfwn5SEIEhhbmRsaW5nIGN1c3RvbWVyIHByb2ZpbGUgdXBkYXRlIHJlcXVlc3QnKTtcbiAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVDdXN0b21lclByb2ZpbGVVcGRhdGUoYm9keSk7XG4gICAgfVxuXG4gICAgLy8gU3BlY2lhbCBoYW5kbGluZyBmb3IgY3VzdG9tZXIgcGFzc3dvcmQgY2hhbmdlXG4gICAgaWYgKGVuZHBvaW50ID09PSAnY3VzdG9tZXIvY2hhbmdlLXBhc3N3b3JkJykge1xuICAgICAgY29uc29sZS5sb2coJ/CflIQgSGFuZGxpbmcgY3VzdG9tZXIgcGFzc3dvcmQgY2hhbmdlIHJlcXVlc3QnKTtcbiAgICAgIHJldHVybiBhd2FpdCBoYW5kbGVDdXN0b21lclBhc3N3b3JkQ2hhbmdlKGJvZHkpO1xuICAgIH1cblxuICAgIC8vIFNwZWNpYWwgaGFuZGxpbmcgZm9yIGN1c3RvbWVyIGludm9pY2VzXG4gICAgaWYgKGVuZHBvaW50ID09PSAnY3VzdG9tZXJzL2ludm9pY2VzJykge1xuICAgICAgY29uc29sZS5sb2coJ/CflIQgSGFuZGxpbmcgY3VzdG9tZXIgaW52b2ljZXMgcmVxdWVzdCcpO1xuICAgICAgcmV0dXJuIGF3YWl0IGhhbmRsZUN1c3RvbWVySW52b2ljZXMocmVxKTtcbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZygn8J+UhCBVc2luZyBzdGFuZGFyZCBXb29Db21tZXJjZSBlbmRwb2ludDonLCBlbmRwb2ludCk7XG5cblxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoYCR7V0NfVVJMPy5yZXBsYWNlKC9cXC8kLywgXCJcIikgfHwgJ2h0dHBzOi8vcXZ3bHRqaGRqdy5jZm9sa3MucGwvd3AtanNvbi93Yy92Myd9LyR7ZW5kcG9pbnR9YCk7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJjb25zdW1lcl9rZXlcIiwgQ0sgfHwgJycpO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY29uc3VtZXJfc2VjcmV0XCIsIENTIHx8ICcnKTtcbiAgICBcbiAgICAvLyBSZXRyeSBsb2dpYyBmb3IgUE9TVCByZXF1ZXN0cyB0b29cbiAgICBsZXQgbGFzdEVycm9yOiBFcnJvciB8IG51bGwgPSBudWxsO1xuICAgIGZvciAobGV0IGF0dGVtcHQgPSAxOyBhdHRlbXB0IDw9IDM7IGF0dGVtcHQrKykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc29sZS5sb2coYPCflIQgUE9TVCBBdHRlbXB0ICR7YXR0ZW1wdH0gZm9yICR7dXJsLnRvU3RyaW5nKCl9YCk7XG4gICAgICAgIFxuICAgICAgICBjb25zdCByID0gYXdhaXQgZmV0Y2godXJsLnRvU3RyaW5nKCksIHtcbiAgICAgICAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICAgICAgICBoZWFkZXJzOiB7IFxuICAgICAgICAgICAgQWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAgICAgICAnVXNlci1BZ2VudCc6ICdGaWxsZXItU3RvcmUvMS4wJ1xuICAgICAgICAgIH0sXG4gICAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoYm9keSksXG4gICAgICAgICAgY2FjaGU6IFwibm8tc3RvcmVcIixcbiAgICAgICAgfSk7XG5cbiAgICAgICAgY29uc3QgdGV4dCA9IGF3YWl0IHIudGV4dCgpO1xuICAgICAgICBpZiAoIXIub2spIHtcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4p2MIFBPU1QgSFRUUCAke3Iuc3RhdHVzfTogJHt0ZXh0fWApO1xuICAgICAgICAgIHJldHVybiBuZXcgTmV4dFJlc3BvbnNlKHRleHQgfHwgci5zdGF0dXNUZXh0LCB7XG4gICAgICAgICAgICBzdGF0dXM6IHIuc3RhdHVzLFxuICAgICAgICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiByLmhlYWRlcnMuZ2V0KFwiY29udGVudC10eXBlXCIpIHx8IFwidGV4dC9wbGFpblwiIH0sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGNvbnNvbGUubG9nKGDinIUgUE9TVCBTdWNjZXNzIG9uIGF0dGVtcHQgJHthdHRlbXB0fWApO1xuICAgICAgICByZXR1cm4gbmV3IE5leHRSZXNwb25zZSh0ZXh0LCB7XG4gICAgICAgICAgc3RhdHVzOiAyMDAsXG4gICAgICAgICAgaGVhZGVyczogeyBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIiB9LFxuICAgICAgICB9KTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxhc3RFcnJvciA9IGVycm9yIGFzIEVycm9yO1xuICAgICAgICBjb25zb2xlLmxvZyhg4p2MIFBPU1QgQXR0ZW1wdCAke2F0dGVtcHR9IGZhaWxlZDpgLCBlcnJvcik7XG4gICAgICAgIFxuICAgICAgICBpZiAoYXR0ZW1wdCA8IDMpIHtcbiAgICAgICAgICBhd2FpdCBuZXcgUHJvbWlzZShyZXNvbHZlID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgYXR0ZW1wdCAqIDEwMDApKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB0aHJvdyBsYXN0RXJyb3I7XG4gIH0gY2F0Y2ggKGU6IHVua25vd24pIHtcbiAgICBjb25zb2xlLmVycm9yKCfwn5qoIFBPU1QgQWxsIGF0dGVtcHRzIGZhaWxlZDonLCBlKTtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXG4gICAgICB7IGVycm9yOiBcIkLFgsSFZCBzZXJ3ZXJhIHByb3h5XCIsIG1lc3NhZ2U6IGUgaW5zdGFuY2VvZiBFcnJvciA/IGUubWVzc2FnZSA6IFN0cmluZyhlKSB9LFxuICAgICAgeyBzdGF0dXM6IDUwMiB9XG4gICAgKTtcbiAgfVxufVxuXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwiY2FjaGUiLCJyZWRpcyIsInVuZGVmaW5lZCIsIldDX1VSTCIsInByb2Nlc3MiLCJlbnYiLCJXT09DT01NRVJDRV9BUElfVVJMIiwiU0lURV9CQVNFIiwicmVwbGFjZSIsIkNLIiwiV09PQ09NTUVSQ0VfQ09OU1VNRVJfS0VZIiwiQ1MiLCJXT09DT01NRVJDRV9DT05TVU1FUl9TRUNSRVQiLCJoYW5kbGVQYXNzd29yZFJlc2V0IiwiYm9keSIsImVtYWlsIiwianNvbiIsInN1Y2Nlc3MiLCJlcnJvciIsInN0YXR1cyIsImNvbnNvbGUiLCJsb2ciLCJjdXN0b21VcmwiLCJyZXNwb25zZSIsImZldGNoIiwibWV0aG9kIiwiaGVhZGVycyIsIkpTT04iLCJzdHJpbmdpZnkiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJvayIsImRhdGEiLCJtZXNzYWdlIiwiZGVidWdfaW5mbyIsImVycm9yVGV4dCIsInRleHQiLCJ3Y1VybCIsImF1dGgiLCJCdWZmZXIiLCJmcm9tIiwidG9TdHJpbmciLCJ3Y1Jlc3BvbnNlIiwiZW5jb2RlVVJJQ29tcG9uZW50IiwiY3VzdG9tZXJEYXRhIiwibGVuZ3RoIiwiaGFuZGxlUGFzc3dvcmRSZXNldENvbmZpcm0iLCJrZXkiLCJsb2dpbiIsInBhc3N3b3JkIiwic3Vic3RyaW5nIiwicGFzc3dvcmRMZW5ndGgiLCJoYW5kbGVDdXN0b21lckludm9pY2VzIiwicmVxIiwic2VhcmNoUGFyYW1zIiwiVVJMIiwidXJsIiwiY3VzdG9tZXJJZCIsImdldCIsImludm9pY2VzVXJsIiwicmF3IiwicGFyc2UiLCJlIiwibXNnIiwiU3RyaW5nIiwic2xpY2UiLCJpbnZvaWNlcyIsInJhd0ludm9pY2VzIiwiQXJyYXkiLCJpc0FycmF5IiwiZW5yaWNoZWQiLCJtYXAiLCJpbnYiLCJpZCIsIm9yZGVyX2lkIiwiaGFzRG93bmxvYWQiLCJkb3dubG9hZF91cmwiLCJwbHVnaW5VcmwiLCJoYW5kbGVPcmRlclRyYWNraW5nIiwib3JkZXJJZCIsInRyYWNraW5nVXJsIiwidHJhY2tpbmciLCJoYW5kbGVDdXN0b21lclByb2ZpbGVVcGRhdGUiLCJjdXN0b21lcl9pZCIsInByb2ZpbGVfZGF0YSIsImN1c3RvbWVyRnJvbUN1c3RvbSIsInVwZGF0ZVVybCIsImN1c3RvbWVyIiwid29vUGF5bG9hZCIsImZpcnN0X25hbWUiLCJmaXJzdE5hbWUiLCJsYXN0X25hbWUiLCJsYXN0TmFtZSIsImJpbGxpbmciLCJjb21wYW55IiwicGhvbmUiLCJhZGRyZXNzXzEiLCJhZGRyZXNzIiwiY2l0eSIsInBvc3Rjb2RlIiwiY291bnRyeSIsInNoaXBwaW5nIiwibWV0YV9kYXRhIiwibmlwIiwiaW52b2ljZVJlcSIsImludm9pY2VSZXF1ZXN0IiwicHVzaCIsInZhbHVlIiwid29vVXJsIiwid29vUmVzcCIsIndvb1JhdyIsIndvb0RhdGEiLCJfIiwibWVyZ2VkQ3VzdG9tZXIiLCJoYW5kbGVDdXN0b21lclBhc3N3b3JkQ2hhbmdlIiwiY3VycmVudF9wYXNzd29yZCIsIm5ld19wYXNzd29yZCIsImNoYW5nZVBhc3N3b3JkVXJsIiwiaGFuZGxlT3JkZXJDcmVhdGlvbiIsImxpbmVfaXRlbXMiLCJwYXltZW50X21ldGhvZCIsInBheW1lbnRfbWV0aG9kX3RpdGxlIiwic2hpcHBpbmdfbGluZXMiLCJjb3Vwb25fbGluZXMiLCJvcmRlckRhdGEiLCJzZXRfcGFpZCIsInN0YXRlIiwiaXRlbSIsInByb2R1Y3RfaWQiLCJ2YXJpYXRpb25faWQiLCJxdWFudGl0eSIsIm9yZGVyVXJsIiwiZW1haWxBcGlVcmwiLCJlbWFpbFJlc3BvbnNlIiwiZW1haWxSZXN1bHQiLCJlbWFpbEVycm9yIiwib3JkZXIiLCJudW1iZXIiLCJ0b3RhbCIsImN1cnJlbmN5IiwicGF5bWVudF91cmwiLCJjaGVja291dF9wYXltZW50X3VybCIsImRhdGVfY3JlYXRlZCIsImhhbmRsZUF0dHJpYnV0ZXNFbmRwb2ludCIsImRldGFpbHMiLCJhdHRyaWJ1dGVzVXJsIiwiRXJyb3IiLCJhdHRyaWJ1dGVzIiwia2V5cyIsInRvdGFsX3Byb2R1Y3RzIiwiaGFuZGxlU2hvcEVuZHBvaW50Iiwic2hvcFVybCIsInByb2R1Y3RzIiwiY2F0ZWdvcmllcyIsImhhbmRsZVNoaXBwaW5nTWV0aG9kcyIsInNoaXBwaW5nWm9uZXNVcmwiLCJ6b25lc1Jlc3BvbnNlIiwiQWNjZXB0Iiwiem9uZXNUZXh0Iiwiem9uZXNQYXJzZWQiLCJ6b25lcyIsInNoaXBwaW5nTWV0aG9kcyIsInpvbmUiLCJtZXRob2RzVXJsIiwibWV0aG9kc1Jlc3BvbnNlIiwicmVzcG9uc2VUZXh0IiwibWV0aG9kcyIsInNhbml0aXplZCIsIl9tIiwiZzEiLCJjbGVhbiIsInRyaW0iLCJlbmFibGVkIiwibWV0aG9kX2lkIiwidGl0bGUiLCJjb3N0Iiwiem9uZV9pZCIsInpvbmVfbmFtZSIsIm5hbWUiLCJtZXRob2RfdGl0bGUiLCJtZXRob2RfZGVzY3JpcHRpb24iLCJzZXR0aW5ncyIsInpvbmVfbG9jYXRpb25zIiwibG9jYXRpb25zIiwicHJvY2Vzc2VkTWV0aG9kcyIsImZyZWVTaGlwcGluZ1RocmVzaG9sZCIsIm1ldGhvZF9mcmVlX3NoaXBwaW5nIiwicGFyc2VGbG9hdCIsIm1ldGhvZF9ydWxlcyIsInJ1bGVzIiwiY29zdF9wZXJfb3JkZXIiLCJjbGVhbkRlc2NyaXB0aW9uIiwiZGVzYyIsImZyZWVfc2hpcHBpbmdfdGhyZXNob2xkIiwibWV0aG9kc091dCIsInNoaXBwaW5nX21ldGhvZHMiLCJoYW5kbGVDb3Vwb25zIiwiY29kZSIsImNvdXBvbnMiLCJjb3Vwb24iLCJ1c2FnZV9saW1pdCIsInVzYWdlX2NvdW50IiwiZGF0ZV9leHBpcmVzIiwiRGF0ZSIsInVzYWdlX2xpbWl0X3Blcl91c2VyIiwiZGlzY291bnRfdHlwZSIsImFtb3VudCIsIm1pbmltdW1fYW1vdW50IiwibWF4aW11bV9hbW91bnQiLCJHRVQiLCJlbmRwb2ludCIsImJ5cGFzc0NhY2hlIiwic3RhcnRzV2l0aCIsInNsdWciLCJORVhUX1BVQkxJQ19XT1JEUFJFU1NfVVJMIiwiYXV0aEhlYWRlciIsInIiLCJnYXRld2F5cyIsImlwIiwicmF0ZUxpbWl0IiwiY2hlY2tSYXRlTGltaXQiLCJhbGxvd2VkIiwicmV0cnlBZnRlciIsIk1hdGgiLCJjZWlsIiwicmVzZXRBdCIsIm5vdyIsImZvckVhY2giLCJ2IiwiayIsInNldCIsImNhY2hlS2V5IiwiZ2VuZXJhdGVLZXkiLCJjYWNoZWQiLCJldGFnIiwicmVtYWluaW5nIiwibGFzdEVycm9yIiwiYXR0ZW1wdCIsInN0YXR1c1RleHQiLCJjYWNoZWREYXRhIiwicmV0cnlSZXNwb25zZSIsInJldHJ5VGV4dCIsImVtcHR5UmVzcG9uc2UiLCJ0b3RhbFBhZ2VzIiwiY3VycmVudFBhZ2UiLCJwZXJQYWdlIiwiZ2VuZXJhdGVFVGFnIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiUE9TVCJdLCJpZ25vcmVMaXN0IjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/woocommerce/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/cache.ts":
/*!**************************!*\
  !*** ./src/lib/cache.ts ***!
  \**************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CacheManager: () => (/* binding */ CacheManager),\n/* harmony export */   cache: () => (/* binding */ cache)\n/* harmony export */ });\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_0__);\n// Production-grade cache layer with Redis fallback\n\nconst memoryCache = new Map();\nconst DEFAULT_TTL_MS = 60 * 1000; // 60s\nconst MAX_MEMORY_ENTRIES = 1000;\n// Rate limiting store\nconst rateLimitStore = new Map();\nconst RATE_LIMIT_WINDOW = 60 * 1000; // 1 minute\nconst RATE_LIMIT_MAX_REQUESTS = 100; // per IP per minute\nclass CacheManager {\n    static getInstance() {\n        if (!CacheManager.instance) {\n            CacheManager.instance = new CacheManager();\n        }\n        return CacheManager.instance;\n    }\n    // Generate cache key from URL\n    generateKey(url, method = 'GET') {\n        return `cache:${method}:${crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash('md5').update(url).digest('hex')}`;\n    }\n    // Generate ETag from content\n    generateETag(content) {\n        return `\"${crypto__WEBPACK_IMPORTED_MODULE_0___default().createHash('md5').update(content).digest('hex').slice(0, 16)}\"`;\n    }\n    // Get from cache\n    async get(key) {\n        const entry = memoryCache.get(key);\n        if (!entry) return null;\n        if (Date.now() > entry.expiresAt) {\n            memoryCache.delete(key);\n            return null;\n        }\n        return {\n            body: entry.body,\n            etag: entry.etag,\n            headers: entry.headers\n        };\n    }\n    // Set in cache\n    async set(key, body, ttlMs = DEFAULT_TTL_MS, headers = {}) {\n        const etag = this.generateETag(body);\n        // Cleanup old entries if cache is full\n        if (memoryCache.size >= MAX_MEMORY_ENTRIES) {\n            const oldestKey = memoryCache.keys().next().value;\n            if (oldestKey) memoryCache.delete(oldestKey);\n        }\n        memoryCache.set(key, {\n            body,\n            expiresAt: Date.now() + ttlMs,\n            etag,\n            headers\n        });\n    }\n    // Delete from cache\n    async delete(key) {\n        memoryCache.delete(key);\n    }\n    // Clear all cache\n    async clear() {\n        memoryCache.clear();\n    }\n    // Purge cache by pattern\n    async purge(pattern) {\n        let deleted = 0;\n        for (const key of memoryCache.keys()){\n            if (key.includes(pattern)) {\n                memoryCache.delete(key);\n                deleted++;\n            }\n        }\n        return deleted;\n    }\n    // Rate limiting\n    checkRateLimit(ip) {\n        const now = Date.now();\n        const key = `rate:${ip}`;\n        const entry = rateLimitStore.get(key);\n        if (!entry || now > entry.resetAt) {\n            // Reset or create new entry\n            rateLimitStore.set(key, {\n                count: 1,\n                resetAt: now + RATE_LIMIT_WINDOW\n            });\n            return {\n                allowed: true,\n                remaining: RATE_LIMIT_MAX_REQUESTS - 1,\n                resetAt: now + RATE_LIMIT_WINDOW\n            };\n        }\n        if (entry.count >= RATE_LIMIT_MAX_REQUESTS) {\n            return {\n                allowed: false,\n                remaining: 0,\n                resetAt: entry.resetAt\n            };\n        }\n        entry.count++;\n        return {\n            allowed: true,\n            remaining: RATE_LIMIT_MAX_REQUESTS - entry.count,\n            resetAt: entry.resetAt\n        };\n    }\n    // Get cache stats\n    getStats() {\n        return {\n            size: memoryCache.size,\n            entries: memoryCache.size,\n            rateLimitEntries: rateLimitStore.size\n        };\n    }\n}\nconst cache = CacheManager.getInstance();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUcsQ0FBQ0M7UUFFakMsSUFBSSxDQUFDQyxTQUFTRSxNQUFNRixNQUFNc0IsT0FBTyxFQUFFO1lBQ2pDLDRCQUE0QjtZQUM1QnZDLGVBQWV5QixHQUFHLENBQUNULEtBQUs7Z0JBQ3RCd0IsT0FBTztnQkFDUEQsU0FBU3BCLE1BQU1sQjtZQUNqQjtZQUNBLE9BQU87Z0JBQ0x3QyxTQUFTO2dCQUNUQyxXQUFXeEMsMEJBQTBCO2dCQUNyQ3FDLFNBQVNwQixNQUFNbEI7WUFDakI7UUFDRjtRQUVBLElBQUlnQixNQUFNdUIsS0FBSyxJQUFJdEMseUJBQXlCO1lBQzFDLE9BQU87Z0JBQ0x1QyxTQUFTO2dCQUNUQyxXQUFXO2dCQUNYSCxTQUFTdEIsTUFBTXNCLE9BQU87WUFDeEI7UUFDRjtRQUVBdEIsTUFBTXVCLEtBQUs7UUFDWCxPQUFPO1lBQ0xDLFNBQVM7WUFDVEMsV0FBV3hDLDBCQUEwQmUsTUFBTXVCLEtBQUs7WUFDaERELFNBQVN0QixNQUFNc0IsT0FBTztRQUN4QjtJQUNGO0lBRUEsa0JBQWtCO0lBQ2xCSSxXQUF3RTtRQUN0RSxPQUFPO1lBQ0xoQixNQUFNL0IsWUFBWStCLElBQUk7WUFDdEJpQixTQUFTaEQsWUFBWStCLElBQUk7WUFDekJrQixrQkFBa0I3QyxlQUFlMkIsSUFBSTtRQUN2QztJQUNGO0FBQ0Y7QUFFTyxNQUFNbUIsUUFBUTNDLGFBQWFDLFdBQVcsR0FBRyIsInNvdXJjZXMiOlsiL1VzZXJzL2tpbmdicmFuZC9EZXNrdG9wL2hlYWRsZXNzLXdvby9hcHBzL3dlYi9zcmMvbGliL2NhY2hlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFByb2R1Y3Rpb24tZ3JhZGUgY2FjaGUgbGF5ZXIgd2l0aCBSZWRpcyBmYWxsYmFja1xuaW1wb3J0IGNyeXB0byBmcm9tICdjcnlwdG8nO1xuXG4vLyBTaW1wbGUgaW4tbWVtb3J5IGNhY2hlIGFzIGZhbGxiYWNrXG50eXBlIENhY2hlRW50cnkgPSB7IFxuICBib2R5OiBzdHJpbmc7IFxuICBleHBpcmVzQXQ6IG51bWJlcjsgXG4gIGV0YWc6IHN0cmluZztcbiAgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbn07XG5cbmNvbnN0IG1lbW9yeUNhY2hlID0gbmV3IE1hcDxzdHJpbmcsIENhY2hlRW50cnk+KCk7XG5jb25zdCBERUZBVUxUX1RUTF9NUyA9IDYwICogMTAwMDsgLy8gNjBzXG5jb25zdCBNQVhfTUVNT1JZX0VOVFJJRVMgPSAxMDAwO1xuXG4vLyBSYXRlIGxpbWl0aW5nIHN0b3JlXG5jb25zdCByYXRlTGltaXRTdG9yZSA9IG5ldyBNYXA8c3RyaW5nLCB7IGNvdW50OiBudW1iZXI7IHJlc2V0QXQ6IG51bWJlciB9PigpO1xuY29uc3QgUkFURV9MSU1JVF9XSU5ET1cgPSA2MCAqIDEwMDA7IC8vIDEgbWludXRlXG5jb25zdCBSQVRFX0xJTUlUX01BWF9SRVFVRVNUUyA9IDEwMDsgLy8gcGVyIElQIHBlciBtaW51dGVcblxuZXhwb3J0IGNsYXNzIENhY2hlTWFuYWdlciB7XG4gIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBDYWNoZU1hbmFnZXI7XG4gIFxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogQ2FjaGVNYW5hZ2VyIHtcbiAgICBpZiAoIUNhY2hlTWFuYWdlci5pbnN0YW5jZSkge1xuICAgICAgQ2FjaGVNYW5hZ2VyLmluc3RhbmNlID0gbmV3IENhY2hlTWFuYWdlcigpO1xuICAgIH1cbiAgICByZXR1cm4gQ2FjaGVNYW5hZ2VyLmluc3RhbmNlO1xuICB9XG5cbiAgLy8gR2VuZXJhdGUgY2FjaGUga2V5IGZyb20gVVJMXG4gIGdlbmVyYXRlS2V5KHVybDogc3RyaW5nLCBtZXRob2Q6IHN0cmluZyA9ICdHRVQnKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYGNhY2hlOiR7bWV0aG9kfToke2NyeXB0by5jcmVhdGVIYXNoKCdtZDUnKS51cGRhdGUodXJsKS5kaWdlc3QoJ2hleCcpfWA7XG4gIH1cblxuICAvLyBHZW5lcmF0ZSBFVGFnIGZyb20gY29udGVudFxuICBnZW5lcmF0ZUVUYWcoY29udGVudDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFwiJHtjcnlwdG8uY3JlYXRlSGFzaCgnbWQ1JykudXBkYXRlKGNvbnRlbnQpLmRpZ2VzdCgnaGV4Jykuc2xpY2UoMCwgMTYpfVwiYDtcbiAgfVxuXG4gIC8vIEdldCBmcm9tIGNhY2hlXG4gIGFzeW5jIGdldChrZXk6IHN0cmluZyk6IFByb21pc2U8eyBib2R5OiBzdHJpbmc7IGV0YWc6IHN0cmluZzsgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9IHwgbnVsbD4ge1xuICAgIGNvbnN0IGVudHJ5ID0gbWVtb3J5Q2FjaGUuZ2V0KGtleSk7XG4gICAgXG4gICAgaWYgKCFlbnRyeSkgcmV0dXJuIG51bGw7XG4gICAgXG4gICAgaWYgKERhdGUubm93KCkgPiBlbnRyeS5leHBpcmVzQXQpIHtcbiAgICAgIG1lbW9yeUNhY2hlLmRlbGV0ZShrZXkpO1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICBib2R5OiBlbnRyeS5ib2R5LFxuICAgICAgZXRhZzogZW50cnkuZXRhZyxcbiAgICAgIGhlYWRlcnM6IGVudHJ5LmhlYWRlcnNcbiAgICB9O1xuICB9XG5cbiAgLy8gU2V0IGluIGNhY2hlXG4gIGFzeW5jIHNldChrZXk6IHN0cmluZywgYm9keTogc3RyaW5nLCB0dGxNczogbnVtYmVyID0gREVGQVVMVF9UVExfTVMsIGhlYWRlcnM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGV0YWcgPSB0aGlzLmdlbmVyYXRlRVRhZyhib2R5KTtcbiAgICBcbiAgICAvLyBDbGVhbnVwIG9sZCBlbnRyaWVzIGlmIGNhY2hlIGlzIGZ1bGxcbiAgICBpZiAobWVtb3J5Q2FjaGUuc2l6ZSA+PSBNQVhfTUVNT1JZX0VOVFJJRVMpIHtcbiAgICAgIGNvbnN0IG9sZGVzdEtleSA9IG1lbW9yeUNhY2hlLmtleXMoKS5uZXh0KCkudmFsdWU7XG4gICAgICBpZiAob2xkZXN0S2V5KSBtZW1vcnlDYWNoZS5kZWxldGUob2xkZXN0S2V5KTtcbiAgICB9XG4gICAgXG4gICAgbWVtb3J5Q2FjaGUuc2V0KGtleSwge1xuICAgICAgYm9keSxcbiAgICAgIGV4cGlyZXNBdDogRGF0ZS5ub3coKSArIHR0bE1zLFxuICAgICAgZXRhZyxcbiAgICAgIGhlYWRlcnNcbiAgICB9KTtcbiAgfVxuXG4gIC8vIERlbGV0ZSBmcm9tIGNhY2hlXG4gIGFzeW5jIGRlbGV0ZShrZXk6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIG1lbW9yeUNhY2hlLmRlbGV0ZShrZXkpO1xuICB9XG5cbiAgLy8gQ2xlYXIgYWxsIGNhY2hlXG4gIGFzeW5jIGNsZWFyKCk6IFByb21pc2U8dm9pZD4ge1xuICAgIG1lbW9yeUNhY2hlLmNsZWFyKCk7XG4gIH1cblxuICAvLyBQdXJnZSBjYWNoZSBieSBwYXR0ZXJuXG4gIGFzeW5jIHB1cmdlKHBhdHRlcm46IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gICAgbGV0IGRlbGV0ZWQgPSAwO1xuICAgIGZvciAoY29uc3Qga2V5IG9mIG1lbW9yeUNhY2hlLmtleXMoKSkge1xuICAgICAgaWYgKGtleS5pbmNsdWRlcyhwYXR0ZXJuKSkge1xuICAgICAgICBtZW1vcnlDYWNoZS5kZWxldGUoa2V5KTtcbiAgICAgICAgZGVsZXRlZCsrO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZGVsZXRlZDtcbiAgfVxuXG4gIC8vIFJhdGUgbGltaXRpbmdcbiAgY2hlY2tSYXRlTGltaXQoaXA6IHN0cmluZyk6IHsgYWxsb3dlZDogYm9vbGVhbjsgcmVtYWluaW5nOiBudW1iZXI7IHJlc2V0QXQ6IG51bWJlciB9IHtcbiAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgIGNvbnN0IGtleSA9IGByYXRlOiR7aXB9YDtcbiAgICBjb25zdCBlbnRyeSA9IHJhdGVMaW1pdFN0b3JlLmdldChrZXkpO1xuICAgIFxuICAgIGlmICghZW50cnkgfHwgbm93ID4gZW50cnkucmVzZXRBdCkge1xuICAgICAgLy8gUmVzZXQgb3IgY3JlYXRlIG5ldyBlbnRyeVxuICAgICAgcmF0ZUxpbWl0U3RvcmUuc2V0KGtleSwge1xuICAgICAgICBjb3VudDogMSxcbiAgICAgICAgcmVzZXRBdDogbm93ICsgUkFURV9MSU1JVF9XSU5ET1dcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgYWxsb3dlZDogdHJ1ZSxcbiAgICAgICAgcmVtYWluaW5nOiBSQVRFX0xJTUlUX01BWF9SRVFVRVNUUyAtIDEsXG4gICAgICAgIHJlc2V0QXQ6IG5vdyArIFJBVEVfTElNSVRfV0lORE9XXG4gICAgICB9O1xuICAgIH1cbiAgICBcbiAgICBpZiAoZW50cnkuY291bnQgPj0gUkFURV9MSU1JVF9NQVhfUkVRVUVTVFMpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFsbG93ZWQ6IGZhbHNlLFxuICAgICAgICByZW1haW5pbmc6IDAsXG4gICAgICAgIHJlc2V0QXQ6IGVudHJ5LnJlc2V0QXRcbiAgICAgIH07XG4gICAgfVxuICAgIFxuICAgIGVudHJ5LmNvdW50Kys7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFsbG93ZWQ6IHRydWUsXG4gICAgICByZW1haW5pbmc6IFJBVEVfTElNSVRfTUFYX1JFUVVFU1RTIC0gZW50cnkuY291bnQsXG4gICAgICByZXNldEF0OiBlbnRyeS5yZXNldEF0XG4gICAgfTtcbiAgfVxuXG4gIC8vIEdldCBjYWNoZSBzdGF0c1xuICBnZXRTdGF0cygpOiB7IHNpemU6IG51bWJlcjsgZW50cmllczogbnVtYmVyOyByYXRlTGltaXRFbnRyaWVzOiBudW1iZXIgfSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHNpemU6IG1lbW9yeUNhY2hlLnNpemUsXG4gICAgICBlbnRyaWVzOiBtZW1vcnlDYWNoZS5zaXplLFxuICAgICAgcmF0ZUxpbWl0RW50cmllczogcmF0ZUxpbWl0U3RvcmUuc2l6ZVxuICAgIH07XG4gIH1cbn1cblxuZXhwb3J0IGNvbnN0IGNhY2hlID0gQ2FjaGVNYW5hZ2VyLmdldEluc3RhbmNlKCk7XG5cbiJdLCJuYW1lcyI6WyJjcnlwdG8iLCJtZW1vcnlDYWNoZSIsIk1hcCIsIkRFRkFVTFRfVFRMX01TIiwiTUFYX01FTU9SWV9FTlRSSUVTIiwicmF0ZUxpbWl0U3RvcmUiLCJSQVRFX0xJTUlUX1dJTkRPVyIsIlJBVEVfTElNSVRfTUFYX1JFUVVFU1RTIiwiQ2FjaGVNYW5hZ2VyIiwiZ2V0SW5zdGFuY2UiLCJpbnN0YW5jZSIsImdlbmVyYXRlS2V5IiwidXJsIiwibWV0aG9kIiwiY3JlYXRlSGFzaCIsInVwZGF0ZSIsImRpZ2VzdCIsImdlbmVyYXRlRVRhZyIsImNvbnRlbnQiLCJzbGljZSIsImdldCIsImtleSIsImVudHJ5IiwiRGF0ZSIsIm5vdyIsImV4cGlyZXNBdCIsImRlbGV0ZSIsImJvZHkiLCJldGFnIiwiaGVhZGVycyIsInNldCIsInR0bE1zIiwic2l6ZSIsIm9sZGVzdEtleSIsImtleXMiLCJuZXh0IiwidmFsdWUiLCJjbGVhciIsInB1cmdlIiwicGF0dGVybiIsImRlbGV0ZWQiLCJpbmNsdWRlcyIsImNoZWNrUmF0ZUxpbWl0IiwiaXAiLCJyZXNldEF0IiwiY291bnQiLCJhbGxvd2VkIiwicmVtYWluaW5nIiwiZ2V0U3RhdHMiLCJlbnRyaWVzIiwicmF0ZUxpbWl0RW50cmllcyIsImNhY2hlIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/cache.ts\n");

/***/ }),

/***/ "(ssr)/../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true!":
/*!**********************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-flight-client-entry-loader.js?server=true! ***!
  \**********************************************************************************************************/
/***/ (() => {



/***/ }),

/***/ "../app-render/action-async-storage.external":
/*!*******************************************************************************!*\
  !*** external "next/dist/server/app-render/action-async-storage.external.js" ***!
  \*******************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/action-async-storage.external.js");

/***/ }),

/***/ "../app-render/after-task-async-storage.external":
/*!***********************************************************************************!*\
  !*** external "next/dist/server/app-render/after-task-async-storage.external.js" ***!
  \***********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/after-task-async-storage.external.js");

/***/ }),

/***/ "./work-async-storage.external":
/*!*****************************************************************************!*\
  !*** external "next/dist/server/app-render/work-async-storage.external.js" ***!
  \*****************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-async-storage.external.js");

/***/ }),

/***/ "./work-unit-async-storage.external":
/*!**********************************************************************************!*\
  !*** external "next/dist/server/app-render/work-unit-async-storage.external.js" ***!
  \**********************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/server/app-render/work-unit-async-storage.external.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

"use strict";
module.exports = require("crypto");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "next/dist/shared/lib/no-fallback-error.external":
/*!******************************************************************!*\
  !*** external "next/dist/shared/lib/no-fallback-error.external" ***!
  \******************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/no-fallback-error.external");

/***/ }),

/***/ "next/dist/shared/lib/router/utils/app-paths":
/*!**************************************************************!*\
  !*** external "next/dist/shared/lib/router/utils/app-paths" ***!
  \**************************************************************/
/***/ ((module) => {

"use strict";
module.exports = require("next/dist/shared/lib/router/utils/app-paths");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next","vendor-chunks/@opentelemetry"], () => (__webpack_exec__("(rsc)/../../node_modules/next/dist/build/webpack/loaders/next-app-loader/index.js?name=app%2Fapi%2Fwoocommerce%2Froute&page=%2Fapi%2Fwoocommerce%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Fwoocommerce%2Froute.ts&appDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb%2Fsrc%2Fapp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=%2FUsers%2Fkingbrand%2FDesktop%2Fheadless-woo%2Fapps%2Fweb&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D&isGlobalNotFoundEnabled=!")));
module.exports = __webpack_exports__;

})();